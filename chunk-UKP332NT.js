import{a as ce}from"./chunk-SNKEZIGN.js";import{f as pe}from"./chunk-5CJV2ORJ.js";import{$ as re,$a as ae,A as te,J as ie,Q as oe,Qb as le,Rb as se,aa as ne,n as Z,q as x,u as ee}from"./chunk-SZGAULHU.js";import{Ab as j,F,Fa as n,Fd as K,Ha as L,I as P,Ib as B,Jc as $,Jd as d,Kb as G,Kc as z,Kd as Q,Nb as v,Oa as c,Ob as A,P as V,Pb as W,Q as k,Qc as J,Sa as N,Td as X,Wb as T,Xb as R,Ya as m,ae as Y,cc as b,da as C,db as q,dc as I,ea as S,ef as M,jb as a,kb as l,lb as s,mb as u,nd as f,p as E,q as w,sd as h,tb as _,vc as U,wb as g,yb as y,zb as H}from"./chunk-3ZZIV3L4.js";import{i as D}from"./chunk-SEDBTTTN.js";var ue=["*"];function fe(r,e){if(r&1&&(l(0,"label",12),v(1),s()),r&2){let t=y();a("for",R("app-cms-site-selector-",t.id)),n(),A(t.optionLabel)}}function he(r,e){if(r&1&&(l(0,"mat-option",13)(1,"span"),v(2),s()()),r&2){let t=e.$implicit,o=y();a("value",t)("disabled",o.optionDisabled),n(2),A(o.displayOption(t))}}function Ce(r,e){r&1&&u(0,"i",14)}function Se(r,e){r&1&&u(0,"i",15)}function ge(r,e){if(r&1){let t=_();l(0,"i",16),g("click",function(){C(t);let i=y();return S(i.onActionSelectClear())}),s()}}function ye(r,e){r&1&&(l(0,"em"),v(1),b(2,"translate"),s()),r&2&&(n(),W("(",I(2,1,"TITLE.Necessary"),")"))}var p=class p{constructor(e,t,o,i,O){this.coreEnumService=e;this.cdr=t;this.publicHelper=o;this.translate=i;this.categoryService=O;this.id=++p.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new K;this.dataModelSelect=new M;this.formControl=new ee;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new L;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(V(""),F(1500),P(),k(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){return D(this,null,function*(){let t=new Q;if(t.rowPerPage=20,t.accessLoad=!0,e&&e.length>0){let i=new d;i=new d,i.propertyName="SubDomain",i.value=e,i.searchType=h.Contains,i.clauseType=f.Or,t.filters.push(i),i=new d,i.propertyName="Domain",i.value=e,i.searchType=h.Contains,i.clauseType=f.Or,t.filters.push(i),i=new d,i.propertyName="Title",i.value=e,i.searchType=h.Contains,i.clauseType=f.Or,t.filters.push(i),e&&typeof+e=="number"&&+e>0&&(i=new d,i.propertyName="Id",i.value=e,i.searchType=h.Equal,i.clauseType=f.Or,t.filters.push(i))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield E(this.categoryService.ServiceGetAll(t)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(w(t=>(t.find(o=>o.id===e.id)||t.push(e),t)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(t=>t.id===e)){let t=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=t,this.formControl.setValue(t);return}this.categoryService.ServiceGetOneById(e).subscribe({next:t=>{t.isSuccess&&(this.filteredOptions=this.push(t.item),this.dataModelSelect=t.item,this.formControl.setValue(t.item),this.optionChange.emit(t.item))}});return}if(typeof e==typeof M){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new M,this.loadOptions()}};p.nextId=0,p.\u0275fac=function(t){return new(t||p)(c(X),c(U),c(pe),c(le),c(Y))},p.\u0275cmp=N({type:p,selectors:[["app-cms-sitecategory-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:ue,decls:15,vars:24,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(t,o){if(t&1){let i=_();H(),l(0,"div",1),u(1,"app-progress-spinner",2),m(2,fe,2,3,"label",3),u(3,"input",4),l(4,"mat-autocomplete",5,0),g("optionSelected",function(me){return C(i),S(o.onActionSelect(me.option.value))}),m(6,he,3,3,"mat-option",6),b(7,"async"),s(),m(8,Ce,1,0,"i",7)(9,Se,1,0,"i",8)(10,ge,1,0,"i",9),l(11,"i",10),b(12,"translate"),g("click",function(){return C(i),S(o.onActionButtonReload())}),s(),m(13,ye,3,3,"em",11),j(14),s()}if(t&2){let i=B(5);n(),a("optionsInfoAreaId",o.constructorInfoAreaId),n(),a("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),n(),a("placeholder",T(o.optionPlaceholder))("id",R("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),q("disabled",o.optionDisabled?!0:null),n(),a("displayWith",o.displayFn),n(2),a("ngForOf",I(7,20,o.filteredOptions)),n(2),a("ngIf",!o.formControl.valid),n(),a("ngIf",o.optionRequired&&o.formControl.valid),n(),a("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),n(),G("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),a("title",T(I(12,22,"ACTION.RELOAD"))),n(2),a("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[$,z,Z,x,ie,te,re,oe,ne,ae,ce,J,se],encapsulation:2});var de=p;export{de as a};
