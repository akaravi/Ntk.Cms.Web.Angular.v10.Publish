import{a as me}from"./chunk-5CUEEOJ3.js";import{f as de}from"./chunk-NSI52VTG.js";import{Cb as ce,Da as se,Db as pe,m as re,x as ae,y as le}from"./chunk-WIVKQDM4.js";import{A as ne,c as ee,h as te,l as ie,r as oe}from"./chunk-QRBNL5ZA.js";import{D as h,ba as Z,ka as x,q as X,u,v as Y,wb as _,y as C}from"./chunk-2ZWWK4AL.js";import{Ab as m,Cb as H,Db as j,Dc as M,Eb as G,Ec as I,Fb as c,Gb as a,Hb as l,Ib as f,K as P,O as V,Pb as A,Sb as g,Ub as v,Va as r,Vb as W,Wb as U,Xa as q,Xc as K,Z as k,_ as L,cb as p,cc as $,ec as z,hc as b,ib as N,ic as T,jc as J,pa as S,qa as y,s as w,t as F,tc as R,td as Q,uc as O,xb as B,zb as d}from"./chunk-2AL2II5Z.js";import{i as E}from"./chunk-SEDBTTTN.js";var Ce=["*"];function he(n,e){if(n&1&&(a(0,"label",3),b(1),l()),n&2){let t=v();c("for",O("app-cms-site-selector-",t.id)),r(),T(t.optionLabel)}}function Se(n,e){if(n&1&&(a(0,"mat-option",6)(1,"span"),b(2),l()()),n&2){let t=e.$implicit,o=v();c("value",t)("disabled",o.optionDisabled),r(2),T(o.displayOption(t))}}function ye(n,e){n&1&&f(0,"i",7)}function ge(n,e){n&1&&f(0,"i",8)}function ve(n,e){if(n&1){let t=A();a(0,"i",11),g("click",function(){S(t);let i=v();return y(i.onActionSelectClear())}),l()}}function be(n,e){n&1&&(a(0,"em"),b(1),M(2,"translate"),l()),n&2&&(r(),J("(",I(2,1,"TITLE.Necessary"),")"))}var s=class s{constructor(e,t,o,i,D){this.coreEnumService=e;this.cdr=t;this.publicHelper=o;this.translate=i;this.categoryService=D;this.id=++s.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new X;this.dataModelSelect=new _;this.formControl=new ie;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new q;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(k(""),P(1500),V(),L(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){return E(this,null,function*(){let t=new Y;if(t.rowPerPage=20,t.accessLoad=!0,e&&e.length>0){let i=new u;i=new u,i.propertyName="SubDomain",i.value=e,i.searchType=h.Contains,i.clauseType=C.Or,t.filters.push(i),i=new u,i.propertyName="Domain",i.value=e,i.searchType=h.Contains,i.clauseType=C.Or,t.filters.push(i),i=new u,i.propertyName="title",i.value=e,i.searchType=h.Contains,i.clauseType=C.Or,t.filters.push(i),e&&typeof+e=="number"&&+e>0&&(i=new u,i.propertyName="id",i.value=e,i.searchType=h.Equal,i.clauseType=C.Or,t.filters.push(i))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield w(this.categoryService.ServiceGetAll(t)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(F(t=>(t.find(o=>o.id===e.id)||t.push(e),t)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(t=>t.id===e)){let t=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=t,this.formControl.setValue(t);return}this.categoryService.ServiceGetOneById(e).subscribe({next:t=>{t.isSuccess&&(this.filteredOptions=this.push(t.item),this.dataModelSelect=t.item,this.formControl.setValue(t.item),this.optionChange.emit(t.item))}});return}if(typeof e==typeof _){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new _,this.loadOptions()}};s.nextId=0,s.\u0275fac=function(t){return new(t||s)(p(Z),p(K),p(de),p(ce),p(x))},s.\u0275cmp=N({type:s,selectors:[["app-cms-sitecategory-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:Ce,decls:16,vars:23,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],[1,"color-highlight",3,"for"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled"],[1,"fa-solid","fa-info","invalid","color-red-dark"],[1,"fa-solid","fa-check","valid","color-green-dark"],[1,"fa-solid","fa-times","action","color-red-dark"],[1,"fa-solid","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[1,"fa-solid","fa-times","action","color-red-dark",3,"click"]],template:function(t,o){if(t&1){let i=A();W(),a(0,"div",1),f(1,"app-progress-spinner",2),d(2,he,2,3,"label",3),f(3,"input",4),a(4,"mat-autocomplete",5,0),g("optionSelected",function(fe){return S(i),y(o.onActionSelect(fe.option.value))}),j(6,Se,3,3,"mat-option",6,H),M(8,"async"),l(),d(9,ye,1,0,"i",7),d(10,ge,1,0,"i",8),d(11,ve,1,0,"i",9),a(12,"i",10),M(13,"translate"),g("click",function(){return S(i),y(o.onActionButtonReload())}),l(),d(14,be,3,3,"em"),U(15),l()}if(t&2){let i=$(5);r(),c("optionsInfoAreaId",o.constructorInfoAreaId),r(),m((o.optionLabel==null?null:o.optionLabel.length)>0?2:-1),r(),c("placeholder",R(o.optionPlaceholder))("id",O("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),B("disabled",o.optionDisabled?!0:null),r(),c("displayWith",o.displayFn),r(2),G(I(8,19,o.filteredOptions)),r(3),m(o.formControl.valid?-1:9),r(),m(o.optionRequired&&o.formControl.valid?10:-1),r(),m((o.dataModelSelect==null?null:o.dataModelSelect.id)>0?11:-1),r(),z("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),c("title",R(I(13,21,"ACTION.RELOAD"))),r(2),m(o.optionRequired&&!((o.dataModelSelect==null?null:o.dataModelSelect.id)>0)?14:-1)}},dependencies:[ee,te,ne,oe,ae,re,le,se,me,Q,pe],encapsulation:2});var ue=s;export{ue as a};
