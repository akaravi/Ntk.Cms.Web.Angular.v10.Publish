import{a as he,f as ge,g as Ce,h as Se,i as ve}from"./chunk-LTR4ZKGN.js";import{a as fe}from"./chunk-HZ5QLZR3.js";import{f as ue}from"./chunk-MDUQEXVG.js";import{I as re,Qb as de,Rb as me,U as le,bb as pe,da as se,ea as ce,m as ie,p as oe,t as ne,z as ae}from"./chunk-CIAQQA5T.js";import{Ab as q,Ca as _,Ed as Q,F as k,Fa as r,Fd as X,Ha as P,I as F,Ib as G,Jc as K,Jd as s,Kb as j,Kc as $,Kd as Y,Nb as M,Oa as g,Ob as R,P as H,Pb as z,Q as N,Qc as J,Sa as B,Td as Z,Tf as te,Wb as b,Xb as w,Ya as f,cc as S,da as I,db as x,dc as v,ea as y,ee as T,fe as ee,jb as a,kb as l,lb as c,mb as h,nd as p,p as U,q as V,sd as d,tb as D,vc as W,wb as A,yb as C,yq as m,zb as L}from"./chunk-C6BSHOKZ.js";import{i as E}from"./chunk-SEDBTTTN.js";var Me=class{constructor(t,e,o,i){this.baseService=t;this.item=e;this.publicHelper=o;this.translate=i;this.constructorInfoAreaId=this.constructor.name;this.tokenInfo=new te;this.fieldsInfo=new Map;this.dataModelResult=new Q;o.pageInfo.updateContentService(t),this.dataModel=e}onActionButtonMemo(t=this.dataModel){var e="";this.publicHelper.isMobile?e="dialog-fullscreen":e="dialog-min",this.publicHelper.dialog.open(Ce,{height:"70%",panelClass:e,enterAnimationDuration:m.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:m.cmsViewConfig.exitAnimationDuration,data:{service:this.baseService,id:this.dataModel?this.dataModel.id:"",title:this.dataModel?this.dataModel.title:""}}).afterClosed().subscribe(i=>{i&&i.dialogChangedDate})}onActionButtonPin(t=this.dataModel){var e="";this.publicHelper.isMobile?e="dialog-fullscreen":e="dialog-min",this.publicHelper.dialog.open(Se,{height:"70%",panelClass:e,enterAnimationDuration:m.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:m.cmsViewConfig.exitAnimationDuration,data:{service:this.baseService,id:this.dataModel?this.dataModel.id:"",title:this.dataModel?this.dataModel.title:""}}).afterClosed().subscribe(i=>{i&&i.dialogChangedDate})}onActionButtonTask(t=this.dataModel){var e="";this.publicHelper.isMobile?e="dialog-fullscreen":e="dialog-min",this.publicHelper.dialog.open(ve,{height:"70%",panelClass:e,enterAnimationDuration:m.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:m.cmsViewConfig.exitAnimationDuration,data:{service:this.baseService,id:this.dataModel?this.dataModel.id:"",title:this.dataModel?this.dataModel.title:""}}).afterClosed().subscribe(i=>{i&&i.dialogChangedDate})}onActionButtonComment(t=this.dataModel){var e="";this.publicHelper.isMobile?e="dialog-fullscreen":e="dialog-min",this.publicHelper.dialog.open(ge,{height:"70%",panelClass:e,enterAnimationDuration:m.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:m.cmsViewConfig.exitAnimationDuration,data:{service:this.baseService,id:this.dataModel?this.dataModel.id:"",title:this.dataModel?this.dataModel.title:""}}).afterClosed().subscribe(i=>{i&&i.dialogChangedDate})}DataGetAccess(){let t=this.constructor.name+"main";this.translate.get("MESSAGE.Receiving_information").subscribe(e=>{this.publicHelper.processService.processStart(t,e,this.constructorInfoAreaId)}),this.baseService.ServiceViewModel().subscribe({next:e=>{e.isSuccess?this.fieldsInfo=this.publicHelper.fieldInfoConvertor(e.access):this.publicHelper.cmsToastrService.typeErrorGetAccess(e.errorMessage),this.publicHelper.processService.processStop(t)},error:e=>{this.publicHelper.cmsToastrService.typeErrorGetAccess(e),this.publicHelper.processService.processStop(t,!1)}})}};var ye=["*"];function Ae(n,t){if(n&1&&(l(0,"label",13),M(1),c()),n&2){let e=C();a("for",w("app-cms-site-selector-",e.id)),r(),R(e.optionLabel)}}function Te(n,t){if(n&1&&(h(0,"img",14),S(1,"cmsthumbnail")),n&2){let e=C();a("src",b(v(1,2,e.dataModelSelect==null?null:e.dataModelSelect.linkMainImageIdSrc)),_)}}function _e(n,t){if(n&1&&(h(0,"img",14),S(1,"cmsthumbnail")),n&2){let e=C().$implicit;a("src",b(v(1,2,e.linkMainImageIdSrc)),_)}}function De(n,t){if(n&1&&(l(0,"mat-option",15),f(1,_e,2,4,"img",4),l(2,"span"),M(3),c()()),n&2){let e=t.$implicit,o=C();a("value",e)("disabled",o.optionDisabled),r(),a("ngIf",e.linkMainImageIdSrc),r(2),R(o.displayOption(e))}}function Re(n,t){n&1&&h(0,"i",16)}function we(n,t){n&1&&h(0,"i",17)}function Oe(n,t){if(n&1){let e=D();l(0,"i",18),A("click",function(){I(e);let i=C();return y(i.onActionSelectClear())}),c()}}function Ee(n,t){n&1&&(l(0,"em"),M(1),S(2,"translate"),c()),n&2&&(r(),z("(",v(2,1,"TITLE.Necessary"),")"))}var u=class u{constructor(t,e,o,i,O){this.coreEnumService=t;this.cdr=e;this.publicHelper=o;this.translate=i;this.categoryService=O;this.id=++u.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new X;this.dataModelSelect=new T;this.formControl=new ne;this.optionDisabled=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionRequired=!1;this.optionChange=new P;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(t){this.onActionSelectForce(t)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(H(""),k(1500),F(),N(t=>typeof t=="string"||typeof t=="number"?this.DataGetAll(t):this.DataGetAll("")))}displayFn(t){let e="";return t&&(t.username&&t.username.length>0&&(e=e+" "+t.username),t.name&&t.name.length>0&&(e=e+" "+t.name),t.lastName&&t.lastName.length>0&&(e=e+" "+t.lastName),e=e+"#:"+t.id),e}displayOption(t){let e="";return t&&(t.username&&t.username.length>0&&(e=e+" "+t.username),t.name&&t.name.length>0&&(e=e+" "+t.name),t.lastName&&t.lastName.length>0&&(e=e+" "+t.lastName),e=e+"#:"+t.id),e}DataGetAll(t){return E(this,null,function*(){let e=new Y;if(e.rowPerPage=20,e.accessLoad=!0,t&&t.length>0){let i=new s;i=new s,i.propertyName="username",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="name",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="email",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="lastname",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="Id",i.value=t,i.searchType=d.Equal,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="mobile",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="tell",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i),i=new s,i.propertyName="companyName",i.value=t,i.searchType=d.Contains,i.clauseType=p.Or,e.filters.push(i)}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield U(this.categoryService.ServiceGetAll(e)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(t){this.optionDisabled||(this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(t){return this.filteredOptions.pipe(V(e=>(e.find(o=>o.id===t.id)||e.push(t),e)))}onActionSelectForce(t){if(typeof t=="number"&&t>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(e=>e.id===t)){let e=this.dataModelResult.listItems.find(o=>o.id===t);this.dataModelSelect=e,this.formControl.setValue(e);return}this.categoryService.ServiceGetOneById(t).subscribe({next:e=>{e.isSuccess&&(this.filteredOptions=this.push(e.item),this.dataModelSelect=e.item,this.formControl.setValue(e.item),this.optionChange.emit(e.item))}});return}if(typeof t==typeof T){this.filteredOptions=this.push(t),this.dataModelSelect=t,this.formControl.setValue(t);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new T,this.loadOptions()}};u.nextId=0,u.\u0275fac=function(e){return new(e||u)(g(Z),g(W),g(ue),g(de),g(ee))},u.\u0275cmp=B({type:u,selectors:[["app-cms-user-selector"]],inputs:{optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionRequired:"optionRequired",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:ye,decls:18,vars:25,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["style","vertical-align: middle","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(e,o){if(e&1){let i=D();L(),l(0,"div",1),h(1,"app-progress-spinner",2),f(2,Ae,2,3,"label",3),l(3,"span"),f(4,Te,2,4,"img",4),M(5," \xA0"),c(),h(6,"input",5),l(7,"mat-autocomplete",6,0),A("optionSelected",function(Ie){return I(i),y(o.onActionSelect(Ie.option.value))}),f(9,De,4,4,"mat-option",7),S(10,"async"),c(),f(11,Re,1,0,"i",8)(12,we,1,0,"i",9)(13,Oe,1,0,"i",10),l(14,"i",11),S(15,"translate"),A("click",function(){return I(i),y(o.onActionButtonReload())}),c(),f(16,Ee,3,3,"em",12),q(17),c()}if(e&2){let i=G(8);r(),a("optionsInfoAreaId",o.constructor.name),r(),a("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),r(2),a("ngIf",o.dataModelSelect&&(o.dataModelSelect==null?null:o.dataModelSelect.linkMainImageIdSrc)),r(2),a("placeholder",b(o.optionPlaceholder))("id",w("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),x("disabled",o.optionDisabled?!0:null),r(),a("displayWith",o.displayFn),r(2),a("ngForOf",v(10,21,o.filteredOptions)),r(2),a("ngIf",!o.formControl.valid),r(),a("ngIf",o.optionRequired&&o.formControl.valid),r(),a("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),r(),j("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),a("title",b(v(15,23,"ACTION.RELOAD"))),r(2),a("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[K,$,ie,oe,re,ae,se,le,ce,pe,fe,J,me,he],encapsulation:2});var be=u;export{Me as a,be as b};
