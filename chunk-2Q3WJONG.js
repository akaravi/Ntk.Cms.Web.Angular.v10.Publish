import{a as ae}from"./chunk-BO6LOMMS.js";import{a as re,b as le}from"./chunk-TV5C4SZW.js";import{a as ne}from"./chunk-V4KO3F4A.js";import{f as oe}from"./chunk-KOTZODZQ.js";import{A as $,Ab as Y,Ba as z,Bb as Z,oa as W,pc as ee,rb as q,sb as J,sc as te,tb as K,ub as Q,uc as ie,vb as U,xb as X}from"./chunk-BLRVWL3E.js";import{$ as j,Jn as T,da as F,q as B,qb as y,v as G}from"./chunk-JMYGXPBM.js";import{Ab as g,Dc as M,Ec as S,Fb as m,Gb as l,Hb as d,Ib as E,Mb as x,Nb as D,Ob as H,Pb as f,Sb as C,Ub as s,Va as r,Xa as w,Xc as L,cb as a,cc as P,ec as A,hc as c,ib as k,ic as R,jc as _,ob as N,pa as p,qa as u,tc as O,xb as V,zb as h}from"./chunk-2AL2II5Z.js";import{i as I}from"./chunk-SEDBTTTN.js";function se(n,i){if(n&1){let e=f();l(0,"button",13),C("click",function(){p(e);let o=s();return u(o.onActionAdd())}),c(1),M(2,"translate"),d()}n&2&&(r(),_(" ",S(2,1,"ACTION.ADD")," "))}function ce(n,i){if(n&1){let e=f();l(0,"button",14),C("click",function(){p(e);let o=s();return u(o.onActionEdit())}),c(1),M(2,"translate"),d()}n&2&&(r(),_(" ",S(2,1,"ACTION.EDIT")," "))}function pe(n,i){if(n&1){let e=f();l(0,"button",15),C("click",function(){p(e);let o=s();return u(o.onActionDelete())}),c(1),M(2,"translate"),d()}n&2&&(r(),_(" ",S(2,1,"ACTION.DELETE")," "))}function ue(n,i){if(n&1){let e=f();l(0,"button",16),C("click",function(){p(e);let o=s();return u(o.onActionButtonReload())}),l(1,"mat-icon",17),M(2,"translate"),c(3,"refresh"),d()()}if(n&2){let e=s();r(),A("rotation360",e.publicHelper.processService.process.inRunArea[e.constructorInfoAreaId]),m("title",O(S(2,4,"ACTION.RELOAD")))}}function me(n,i){if(n&1){let e=f();l(0,"mat-tree-node",18),E(1,"button",19),l(2,"span",20),C("click",function(){let o=p(e).$implicit,v=s();return u(v.onActionSelect(o))}),c(3),d()()}if(n&2){let e=i.$implicit,t=s();A("ntk-tree-selected",(t.dataModelSelect==null?null:t.dataModelSelect.id)>0&&(t.dataModelSelect==null?null:t.dataModelSelect.id)===e.id),r(3),R(e.titleML)}}function fe(n,i){if(n&1){let e=f();l(0,"mat-tree-node",21)(1,"button",22)(2,"mat-icon",23),c(3),d()(),l(4,"span",20),C("click",function(){let o=p(e).$implicit,v=s();return u(v.onActionSelect(o))}),c(5),d()()}if(n&2){let e=i.$implicit,t=s(),o=P(10);A("ntk-tree-selected",(t.dataModelSelect==null?null:t.dataModelSelect.id)>0&&(t.dataModelSelect==null?null:t.dataModelSelect.id)===e.id),m("cdkTreeNodeTypeaheadLabel",e.titleML)("isExpanded",e.isExpanded??!1),r(),V("type","button")("aria-label","Toggle "+e.titleML),r(2),_(" ",o.isExpanded(e)?"expand_more":"chevron_right"," "),r(2),R(e.titleML)}}var b=class b{constructor(i,e,t,o,v,Ce,Me,Se,be){this.cmsToastrService=i;this.coreEnumService=e;this.categoryService=t;this.dialog=o;this.cdr=v;this.publicHelper=Ce;this.tokenHelper=Me;this.cmsStoreService=Se;this.translate=be;this.constructorInfoAreaId=this.constructor.name;this.dataModelSelect=new y;this.dataModelResult=new B;this.filterModel=new G;this.dataSource=new X;this.optionChange=new w;this.unsubscribe=[];this.optionReload=()=>this.onActionButtonReload();this.hasChild=(i,e)=>!1;this.childrenAccessor=i=>[];this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(i){this.onActionSelectForce(i)}ngOnInit(){this.unsubscribe.push(this.cmsStoreService.getState(i=>i.tokenInfoStore).subscribe(i=>I(this,null,function*(){this.DataGetAll()})))}ngOnDestroy(){this.unsubscribe&&this.unsubscribe.forEach(i=>i.unsubscribe())}DataGetAll(){this.filterModel.rowPerPage=200,this.filterModel.accessLoad=!0;let i=this.constructor.name+"main";this.translate.get("MESSAGE.Receiving_information").subscribe(e=>{this.publicHelper.processService.processStart(i,e,this.constructorInfoAreaId)}),this.categoryService.ServiceGetAll(this.filterModel).subscribe({next:e=>{e.isSuccess?(this.dataModelResult=e,this.dataSource.data=this.dataModelResult.listItems):this.cmsToastrService.typeErrorMessage(e.errorMessage),this.publicHelper.processService.processStop(i)},error:e=>{this.cmsToastrService.typeError(e),this.publicHelper.processService.processStop(i,!1)}})}onActionSelect(i){i&&this.dataModelSelect&&i.id==this.dataModelSelect.id?(this.dataModelSelect=null,this.optionChange.emit(null)):(this.dataModelSelect=i,this.optionChange.emit(this.dataModelSelect))}onActionButtonReload(){this.onActionSelect(null),this.dataModelSelect=new y,this.DataGetAll()}onActionSelectForce(i){}onActionAdd(){var i="";this.publicHelper.isMobile?i="dialog-fullscreen":i="dialog-min",this.dialog.open(re,{height:"90%",panelClass:i,enterAnimationDuration:T.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:T.cmsViewConfig.exitAnimationDuration,data:{}}).afterClosed().subscribe(t=>{t&&t.dialogChangedDate&&this.DataGetAll()})}onActionEdit(){let i=0;if(this.dataModelSelect&&this.dataModelSelect.id>0&&(i=this.dataModelSelect.id),i===0){this.translate.get("ERRORMESSAGE.MESSAGE.typeErrorCategoryNotSelected").subscribe(o=>{this.cmsToastrService.typeErrorSelected(o)});return}var e="";this.publicHelper.isMobile?e="dialog-fullscreen":e="dialog-min",this.dialog.open(le,{height:"90%",panelClass:e,enterAnimationDuration:T.cmsViewConfig.enterAnimationDuration,exitAnimationDuration:T.cmsViewConfig.exitAnimationDuration,data:{id:i}}).afterClosed().subscribe(o=>{o&&o.dialogChangedDate&&this.DataGetAll()})}onActionDelete(){let i=0;if(this.dataModelSelect&&this.dataModelSelect.id>0&&(i=this.dataModelSelect.id),i===0){this.translate.get("ERRORMESSAGE.MESSAGE.typeErrorCategoryNotSelected").subscribe(e=>{this.cmsToastrService.typeErrorSelected(e)});return}}};b.\u0275fac=function(e){return new(e||b)(a(ie),a(j),a(F),a(W),a(L),a(oe),a(te),a(ee),a(Y))},b.\u0275cmp=k({type:b,selectors:[["app-core-module-tree"]],inputs:{optionSelectForce:"optionSelectForce",optionReload:"optionReload"},outputs:{optionChange:"optionChange"},standalone:!1,decls:14,vars:14,consts:[["treeTagControl",""],[3,"optionListTitle","optionHeaderDisplay","optionActionMainDisplay","optionFooterDisplay"],["cms-tree-action",""],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-magenta"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-red"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight"],["cms-tree-body","",1,"loader-container"],[3,"optionsInfoAreaId"],[3,"dataSource","childrenAccessor"],["matTreeNodePadding","",3,"ntk-tree-selected",4,"matTreeNodeDef"],["matTreeNodePadding","","matTreeNodeToggle","","isExpandable","",3,"cdkTreeNodeTypeaheadLabel","isExpanded","ntk-tree-selected",4,"matTreeNodeDef","matTreeNodeDefWhen"],["cms-tree-footer",""],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-magenta",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-red",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight",3,"click"],[2,"font-size","20px","margin","-6px",3,"title"],["matTreeNodePadding",""],["matIconButton","","disabled",""],[3,"click"],["matTreeNodePadding","","matTreeNodeToggle","","isExpandable","",3,"cdkTreeNodeTypeaheadLabel","isExpanded"],["matIconButton","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"]],template:function(e,t){e&1&&(l(0,"app-cms-html-tree",1),M(1,"translate"),x(2,2),h(3,se,3,3,"button",3),h(4,ce,3,3,"button",4),h(5,pe,3,3,"button",5),h(6,ue,4,6,"button",6),D(),x(7,7),E(8,"app-progress-spinner",8),l(9,"mat-tree",9,0),N(11,me,4,3,"mat-tree-node",10)(12,fe,6,8,"mat-tree-node",11),d(),D(),H(13,12),d()),e&2&&(m("optionListTitle",S(1,12,"TABLE."+(t.dataModelResult==null||t.dataModelResult.access==null?null:t.dataModelResult.access.moduleEntityName)))("optionHeaderDisplay",!0)("optionActionMainDisplay",!0)("optionFooterDisplay",!1),r(3),g(!(t.dataModelResult==null||t.dataModelResult.access==null)&&t.dataModelResult.access.accessAddRow?3:-1),r(),g(!(t.dataModelResult==null||t.dataModelResult.access==null)&&t.dataModelResult.access.accessEditRow&&(t.dataModelSelect==null?null:t.dataModelSelect.id)>0?4:-1),r(),g(!(t.dataModelResult==null||t.dataModelResult.access==null)&&t.dataModelResult.access.accessDeleteRow&&(t.dataModelSelect==null?null:t.dataModelSelect.id)>0?5:-1),r(),g(!(t.dataModelResult==null||t.dataModelResult.access==null)&&t.dataModelResult.access.accessWatchRow?6:-1),r(2),m("optionsInfoAreaId",t.constructorInfoAreaId),r(),m("dataSource",t.dataSource)("childrenAccessor",t.childrenAccessor),r(3),m("matTreeNodeDefWhen",t.hasChild))},dependencies:[$,z,J,K,U,Q,q,ne,ae,Z],encapsulation:2});var de=b;export{de as a};
