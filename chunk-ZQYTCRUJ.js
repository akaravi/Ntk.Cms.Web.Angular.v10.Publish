import{a as fe}from"./chunk-A6ZARURL.js";import{f as me}from"./chunk-JNTEQNXZ.js";import{Cb as de,Da as ce,Db as pe,m as le,wc as ue,x as ae,y as se}from"./chunk-UI6VEI3C.js";import{A as re,c as te,h as ie,l as oe,r as ne}from"./chunk-QRBNL5ZA.js";import{D as _,ba as Z,ga as ee,q as X,tb as h,u as g,v as Y,y as I}from"./chunk-5ABB5WE5.js";import{Ab as m,Cb as H,Db as G,Dc as E,Eb as W,Ec as b,Fb as p,Gb as l,Hb as a,Ib as f,K as L,O as V,Pb as T,Sb as S,Ub as y,Va as n,Vb as x,Wb as U,Xa as q,Xc as K,Z as P,_ as k,cb as d,cc as $,ec as z,hc as v,ib as j,ic as A,jc as J,pa as C,qa as M,s as F,t as N,tc as R,td as Q,uc as O,xb as B,zb as u}from"./chunk-2AL2II5Z.js";import{i as D}from"./chunk-SEDBTTTN.js";var Ce=["*"];function Me(o,e){if(o&1&&(l(0,"label",3),v(1),a()),o&2){let i=y();p("for",O("app-cms-site-selector-",i.id)),n(),A(i.optionLabel)}}function Se(o,e){if(o&1&&(l(0,"mat-option",6)(1,"span"),v(2),a()()),o&2){let i=e.$implicit,t=y();p("value",i)("disabled",t.optionDisabled),n(2),A(t.displayOption(i))}}function ye(o,e){o&1&&f(0,"i",7)}function ve(o,e){o&1&&f(0,"i",8)}function Ee(o,e){if(o&1){let i=T();l(0,"i",11),S("click",function(){C(i);let r=y();return M(r.onActionSelectClear())}),a()}}function be(o,e){o&1&&(l(0,"em"),v(1),E(2,"translate"),a()),o&2&&(n(),J("(",b(2,1,"TITLE.Necessary"),")"))}var s=class s{constructor(e,i,t,r,c,w){this.coreEnumService=e;this.cmsToastrService=i;this.cdr=t;this.publicHelper=r;this.translate=c;this.categoryService=w;this.id=++s.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new X;this.dataModelSelect=new h;this.formControl=new oe;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionDisabled=!1;this.optionRequired=!1;this.optionLabel="";this.optionChange=new q;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(P(""),L(1500),V(),k(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e||""):[]))}displayFn(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}displayOption(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}DataGetAll(e){return D(this,null,function*(){let i=new Y;i.rowPerPage=50,i.accessLoad=!0;let t=new g;t.propertyName="moduleName",t.value=e,t.searchType=_.Contains,t.clauseType=I.Or,i.filters.push(t),t=new g,t.propertyName="moduleEntityName",t.value=e,t.searchType=_.Contains,t.clauseType=I.Or,i.filters.push(t),e&&typeof+e=="number"&&+e>0&&(t=new g,t.propertyName="id",t.value=e,t.searchType=_.Equal,t.clauseType=I.Or,i.filters.push(t));let r=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(c=>{this.publicHelper.processService.processStart(r,c,this.constructorInfoAreaId)}),yield F(this.categoryService.ServiceGetAll(i)).then(c=>(this.dataModelResult=c,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(r),c.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}onActionEmpty(){this.formControl.setValue(0),this.dataModelSelect=new h,this.optionChange.emit(this.dataModelSelect)}push(e){return this.filteredOptions.pipe(N(i=>(i.find(t=>t.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){let i=this.dataModelResult.listItems.find(t=>t.id===e);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(e).subscribe({next:i=>{i.isSuccess?(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item)):this.cmsToastrService.typeErrorMessage(i.errorMessage)}});return}if(typeof e==typeof h){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new h,this.loadOptions()}};s.nextId=0,s.\u0275fac=function(i){return new(i||s)(d(Z),d(ue),d(K),d(me),d(de),d(ee))},s.\u0275cmp=j({type:s,selectors:[["app-core-module-entity-selector"]],inputs:{optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:Ce,decls:16,vars:23,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],[1,"color-highlight",3,"for"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,t){if(i&1){let r=T();x(),l(0,"div",1),f(1,"app-progress-spinner",2),u(2,Me,2,3,"label",3),f(3,"input",4),l(4,"mat-autocomplete",5,0),S("optionSelected",function(w){return C(r),M(t.onActionSelect(w.option.value))}),G(6,Se,3,3,"mat-option",6,H),E(8,"async"),a(),u(9,ye,1,0,"i",7),u(10,ve,1,0,"i",8),u(11,Ee,1,0,"i",9),l(12,"i",10),E(13,"translate"),S("click",function(){return C(r),M(t.onActionButtonReload())}),a(),u(14,be,3,3,"em"),U(15),a()}if(i&2){let r=$(5);n(),p("optionsInfoAreaId",t.constructorInfoAreaId),n(),m((t.optionLabel==null?null:t.optionLabel.length)>0?2:-1),n(),p("placeholder",R(t.optionPlaceholder))("id",O("app-cms-site-selector-",t.id))("formControl",t.formControl)("matAutocomplete",r)("required",t.optionRequired),B("disabled",t.optionDisabled?!0:null),n(),p("displayWith",t.displayFn),n(2),W(b(8,19,t.filteredOptions)),n(3),m(t.formControl.valid?-1:9),n(),m(t.optionRequired&&t.formControl.valid?10:-1),n(),m((t.dataModelSelect==null?null:t.dataModelSelect.id)>0?11:-1),n(),z("rotation360",t.publicHelper.processService.process.inRunArea[t.constructorInfoAreaId]),p("title",R(b(13,21,"ACTION.RELOAD"))),n(2),m(t.optionRequired&&!((t.dataModelSelect==null?null:t.dataModelSelect.id)>0)?14:-1)}},dependencies:[te,ie,re,ne,ae,le,se,ce,fe,Q,pe],encapsulation:2});var he=s;export{he as a};
