import{a as ue}from"./chunk-XBBMWE56.js";import{f as de}from"./chunk-LID2Z6NB.js";import{Cb as pe,Da as se,Db as ce,m as ne,x as le,y as ae}from"./chunk-TSM5A4DZ.js";import{A as re,c as ee,h as te,l as ie,r as oe}from"./chunk-QRBNL5ZA.js";import{Ab as _,D as h,ba as Z,q as X,qa as x,u as c,v as Y,y as f}from"./chunk-VH4FEZX5.js";import{Ab as m,Cb as q,Db as B,Dc as g,Eb as H,Ec as I,Fb as p,Gb as l,Hb as a,Ib as C,K as D,O as F,Pb as G,Sb as b,Ub as M,Va as n,Vb as j,Wb as W,Xa as k,Xc as K,Z as P,_ as V,cb as d,cc as $,ec as z,hc as y,ib as L,ic as T,jc as J,pa as S,qa as v,s as w,t as E,tc as A,td as Q,uc as R,xb as N,zb as u}from"./chunk-2AL2II5Z.js";import{i as O}from"./chunk-SEDBTTTN.js";var he=["*"];function Ce(r,e){if(r&1&&(l(0,"label",3),y(1),a()),r&2){let i=M();p("for",R("app-cms-site-selector-",i.id)),n(),T(i.optionLabel)}}function Se(r,e){if(r&1&&(l(0,"mat-option",6)(1,"span"),y(2),a()()),r&2){let i=e.$implicit,o=M();p("value",i)("disabled",o.optionDisabled),n(2),T(o.displayOption(i))}}function ve(r,e){r&1&&C(0,"i",7)}function be(r,e){r&1&&C(0,"i",8)}function Me(r,e){if(r&1){let i=G();l(0,"i",11),b("click",function(){S(i);let t=M();return v(t.onActionSelectClear())}),a()}}function ye(r,e){r&1&&(l(0,"em"),y(1),g(2,"translate"),a()),r&2&&(n(),J("(",I(2,1,"TITLE.Necessary"),")"))}var s=class s{constructor(e,i,o,t,U){this.coreEnumService=e;this.cdr=i;this.publicHelper=o;this.translate=t;this.categoryService=U;this.id=++s.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new X;this.dataModelSelect=new _;this.formControl=new ie;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new k;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(P(""),D(1500),F(),V(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){return O(this,null,function*(){let i=new Y;if(i.rowPerPage=20,i.accessLoad=!0,e&&e.length>0){let t=new c;t=new c,t.propertyName="username",t.value=e,t.searchType=h.Contains,t.clauseType=f.Or,i.filters.push(t),t=new c,t.propertyName="name",t.value=e,t.searchType=h.Contains,t.clauseType=f.Or,i.filters.push(t),t=new c,t.propertyName="email",t.value=e,t.searchType=h.Contains,t.clauseType=f.Or,i.filters.push(t),t=new c,t.propertyName="lastname",t.value=e,t.searchType=h.Contains,t.clauseType=f.Or,i.filters.push(t),e&&typeof+e=="number"&&+e>0&&(t=new c,t.propertyName="id",t.value=e,t.searchType=h.Equal,t.clauseType=f.Or,i.filters.push(t))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(t=>{this.publicHelper.processService.processStart(o,t,this.constructorInfoAreaId)}),yield w(this.categoryService.ServiceGetAll(i)).then(t=>(this.dataModelResult=t,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),t.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(E(i=>(i.find(o=>o.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){let i=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(e).subscribe({next:i=>{i.isSuccess&&(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item))}});return}if(typeof e==typeof _){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new _,this.loadOptions()}};s.nextId=0,s.\u0275fac=function(i){return new(i||s)(d(Z),d(K),d(de),d(pe),d(x))},s.\u0275cmp=L({type:s,selectors:[["app-cms-usergroup-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:he,decls:16,vars:23,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],[1,"color-highlight",3,"for"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,o){if(i&1){let t=G();j(),l(0,"div",1),C(1,"app-progress-spinner",2),u(2,Ce,2,3,"label",3),C(3,"input",4),l(4,"mat-autocomplete",5,0),b("optionSelected",function(fe){return S(t),v(o.onActionSelect(fe.option.value))}),B(6,Se,3,3,"mat-option",6,q),g(8,"async"),a(),u(9,ve,1,0,"i",7),u(10,be,1,0,"i",8),u(11,Me,1,0,"i",9),l(12,"i",10),g(13,"translate"),b("click",function(){return S(t),v(o.onActionButtonReload())}),a(),u(14,ye,3,3,"em"),W(15),a()}if(i&2){let t=$(5);n(),p("optionsInfoAreaId",o.constructorInfoAreaId),n(),m((o.optionLabel==null?null:o.optionLabel.length)>0?2:-1),n(),p("placeholder",A(o.optionPlaceholder))("id",R("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",t)("required",o.optionRequired),N("disabled",o.optionDisabled?!0:null),n(),p("displayWith",o.displayFn),n(2),H(I(8,19,o.filteredOptions)),n(3),m(o.formControl.valid?-1:9),n(),m(o.optionRequired&&o.formControl.valid?10:-1),n(),m((o.dataModelSelect==null?null:o.dataModelSelect.id)>0?11:-1),n(),z("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),p("title",A(I(13,21,"ACTION.RELOAD"))),n(2),m(o.optionRequired&&!((o.dataModelSelect==null?null:o.dataModelSelect.id)>0)?14:-1)}},dependencies:[ee,te,re,oe,le,ne,ae,se,ue,Q,ce],encapsulation:2});var me=s;export{me as a};
