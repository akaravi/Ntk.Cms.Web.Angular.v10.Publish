import{a as ue}from"./chunk-BYTQVSML.js";import{f as de}from"./chunk-IZF5YNHZ.js";import{$ as re,$a as ae,A as ie,J as oe,Kc as pe,Q as ne,Qb as se,Rb as ce,aa as le,n as Z,q as ee,u as te}from"./chunk-EMWTQI7F.js";import{Ab as B,F as N,Fa as n,Gd as K,Ha as k,I as L,Ib as G,Jc as $,Kb as W,Kc as z,Kd as I,Ld as Q,Nb as S,Oa as d,Ob as T,P as V,Pb as x,Q as P,Qc as J,Sa as q,Ud as X,Wb as A,Xb as R,Ya as u,Zd as Y,cc as v,cf as f,da as h,db as j,dc as g,ea as M,jb as r,kb as a,lb as s,mb as m,nd as E,p as w,q as D,sd as b,tb as _,vc as U,wb as y,yb as C,zb as H}from"./chunk-UZ7KQV6L.js";import{i as F}from"./chunk-SEDBTTTN.js";var fe=["*"];function he(o,e){if(o&1&&(a(0,"label",12),S(1),s()),o&2){let i=C();r("for",R("app-cms-site-selector-",i.id)),n(),T(i.optionLabel)}}function Me(o,e){if(o&1&&(a(0,"mat-option",13)(1,"span"),S(2),s()()),o&2){let i=e.$implicit,t=C();r("value",i)("disabled",t.optionDisabled),n(2),T(t.displayOption(i))}}function ye(o,e){o&1&&m(0,"i",14)}function Ce(o,e){o&1&&m(0,"i",15)}function Se(o,e){if(o&1){let i=_();a(0,"i",16),y("click",function(){h(i);let l=C();return M(l.onActionSelectClear())}),s()}}function ve(o,e){o&1&&(a(0,"em"),S(1),v(2,"translate"),s()),o&2&&(n(),x("(",g(2,1,"TITLE.Necessary"),")"))}var c=class c{constructor(e,i,t,l,p,O){this.coreEnumService=e;this.cmsToastrService=i;this.cdr=t;this.publicHelper=l;this.translate=p;this.categoryService=O;this.id=++c.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new K;this.dataModelSelect=new f;this.formControl=new te;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionDisabled=!1;this.optionRequired=!1;this.optionLabel="";this.optionChange=new k;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(V(""),N(1500),L(),P(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e||""):[]))}displayFn(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}displayOption(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}DataGetAll(e){return F(this,null,function*(){let i=new Q;i.rowPerPage=50,i.accessLoad=!0;let t=new I;t.propertyName="moduleName",t.value=e,t.searchType=b.Contains,t.clauseType=E.Or,i.filters.push(t),t=new I,t.propertyName="moduleEntityName",t.value=e,t.searchType=b.Contains,t.clauseType=E.Or,i.filters.push(t),e&&typeof+e=="number"&&+e>0&&(t=new I,t.propertyName="id",t.value=e,t.searchType=b.Equal,t.clauseType=E.Or,i.filters.push(t));let l=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(p=>{this.publicHelper.processService.processStart(l,p,this.constructorInfoAreaId)}),yield w(this.categoryService.ServiceGetAll(i)).then(p=>(this.dataModelResult=p,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(l),p.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}onActionEmpty(){this.formControl.setValue(0),this.dataModelSelect=new f,this.optionChange.emit(this.dataModelSelect)}push(e){return this.filteredOptions.pipe(D(i=>(i.find(t=>t.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){let i=this.dataModelResult.listItems.find(t=>t.id===e);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(e).subscribe({next:i=>{i.isSuccess?(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item)):this.cmsToastrService.typeErrorMessage(i.errorMessage)}});return}if(typeof e==typeof f){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new f,this.loadOptions()}};c.nextId=0,c.\u0275fac=function(i){return new(i||c)(d(X),d(pe),d(U),d(de),d(se),d(Y))},c.\u0275cmp=q({type:c,selectors:[["app-core-module-entity-selector"]],inputs:{optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:fe,decls:15,vars:24,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,t){if(i&1){let l=_();H(),a(0,"div",1),m(1,"app-progress-spinner",2),u(2,he,2,3,"label",3),m(3,"input",4),a(4,"mat-autocomplete",5,0),y("optionSelected",function(O){return h(l),M(t.onActionSelect(O.option.value))}),u(6,Me,3,3,"mat-option",6),v(7,"async"),s(),u(8,ye,1,0,"i",7)(9,Ce,1,0,"i",8)(10,Se,1,0,"i",9),a(11,"i",10),v(12,"translate"),y("click",function(){return h(l),M(t.onActionButtonReload())}),s(),u(13,ve,3,3,"em",11),B(14),s()}if(i&2){let l=G(5);n(),r("optionsInfoAreaId",t.constructorInfoAreaId),n(),r("ngIf",(t.optionLabel==null?null:t.optionLabel.length)>0),n(),r("placeholder",A(t.optionPlaceholder))("id",R("app-cms-site-selector-",t.id))("formControl",t.formControl)("matAutocomplete",l)("required",t.optionRequired),j("disabled",t.optionDisabled?!0:null),n(),r("displayWith",t.displayFn),n(2),r("ngForOf",g(7,20,t.filteredOptions)),n(2),r("ngIf",!t.formControl.valid),n(),r("ngIf",t.optionRequired&&t.formControl.valid),n(),r("ngIf",(t.dataModelSelect==null?null:t.dataModelSelect.id)>0),n(),W("rotation360",t.publicHelper.processService.process.inRunArea[t.constructorInfoAreaId]),r("title",A(g(12,22,"ACTION.RELOAD"))),n(2),r("ngIf",t.optionRequired&&(!t.dataModelSelect||!t.dataModelSelect.id||t.dataModelSelect.id<=0))}},dependencies:[$,z,Z,ee,oe,ie,re,ne,le,ae,ue,J,ce],encapsulation:2});var me=c;export{me as a};
