import{a as he}from"./chunk-SCHGJ4O3.js";import{a as fe}from"./chunk-BYTQVSML.js";import{f as ue}from"./chunk-IZF5YNHZ.js";import{$ as ae,$a as ce,A as oe,J as re,Kc as me,Q as ne,Qb as pe,Rb as de,Y as le,aa as se,n as ee,q as te,u as ie}from"./chunk-EMWTQI7F.js";import{Ab as H,Ca as y,F as P,Fa as n,Gd as Q,Ha as N,I as V,Ib as G,Jc as $,Kb as z,Kc as J,Kd as O,Ld as X,Nb as M,Oa as d,Ob as T,P as L,Pb as U,Q as q,Qc as K,Sa as x,Ud as Y,Wb as C,Xb as A,Ya as m,Yd as Z,bf as g,cc as h,da as v,db as B,dc as S,ea as I,jb as r,kb as a,lb as s,mb as u,nd as R,p as k,q as D,sd as E,tb as _,vc as W,wb as b,yb as f,zb as j}from"./chunk-UZ7KQV6L.js";import{i as F}from"./chunk-SEDBTTTN.js";var Me=["*"];function Ce(o,t){if(o&1&&(a(0,"label",14),M(1),s()),o&2){let i=f();r("for",A("app-cms-site-selector-",i.id)),n(),T(i.optionLabel)}}function ge(o,t){if(o&1&&(u(0,"img",15),h(1,"cmsthumbnail")),o&2){let i=f();r("src",C(S(1,2,i.dataModelSelect==null?null:i.dataModelSelect.linkMainImageIdSrc)),y)}}function ve(o,t){if(o&1&&(u(0,"img",15),h(1,"cmsthumbnail")),o&2){let i=f().$implicit;r("src",C(S(1,2,i.linkMainImageIdSrc)),y)}}function Ie(o,t){if(o&1&&(a(0,"mat-option",16),m(1,ve,2,4,"img",5),a(2,"span"),M(3),s()()),o&2){let i=t.$implicit,e=f();r("value",i)("disabled",e.optionDisabled),n(),r("ngIf",i.linkMainImageIdSrc),n(2),T(e.displayOption(i))}}function be(o,t){o&1&&u(0,"i",17)}function ye(o,t){o&1&&u(0,"i",18)}function _e(o,t){if(o&1){let i=_();a(0,"i",19),b("click",function(){v(i);let l=f();return I(l.onActionSelectClear())}),s()}}function Te(o,t){o&1&&(a(0,"em"),M(1),h(2,"translate"),s()),o&2&&(n(),U("(",S(2,1,"TITLE.Necessary"),")"))}var c=class c{constructor(t,i,e,l,p,w){this.coreEnumService=t;this.cmsToastrService=i;this.cdr=e;this.publicHelper=l;this.translate=p;this.categoryService=w;this.id=++c.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new Q;this.dataModelSelect=new g;this.formControl=new ie;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new N;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(t){this.onActionSelectForce(t)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(L(""),P(1500),V(),q(t=>typeof t=="string"||typeof t=="number"?this.DataGetAll(t||""):[]))}displayFn(t){return t?t.title:void 0}displayOption(t){return t?t.title:void 0}DataGetAll(t){return F(this,null,function*(){let i=new X;i.rowPerPage=20,i.accessLoad=!0;let e=new O;e.propertyName="title",e.value=t,e.searchType=E.Contains,e.clauseType=R.Or,i.filters.push(e),t&&typeof+t=="number"&&+t>0&&(e=new O,e.propertyName="id",e.value=t,e.searchType=E.Equal,e.clauseType=R.Or,i.filters.push(e));let l=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(p=>{this.publicHelper.processService.processStart(l,p,this.constructorInfoAreaId)}),yield k(this.categoryService.ServiceGetAll(i)).then(p=>(this.dataModelResult=p,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(l),p.listItems))})}onActionSelect(t){this.optionDisabled||(this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}onActionEmpty(){this.formControl.setValue(0),this.dataModelSelect=new g,this.optionChange.emit(this.dataModelSelect)}push(t){return this.filteredOptions.pipe(D(i=>(i.find(e=>e.id===t.id)||i.push(t),i)))}onActionSelectForce(t){if(typeof t=="number"&&t>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===t)){let i=this.dataModelResult.listItems.find(e=>e.id===t);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(t).subscribe({next:i=>{i.isSuccess?(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item)):this.cmsToastrService.typeErrorMessage(i.errorMessage)}});return}if(typeof t==typeof g){this.filteredOptions=this.push(t),this.dataModelSelect=t,this.formControl.setValue(t);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new g,this.loadOptions()}};c.nextId=0,c.\u0275fac=function(i){return new(i||c)(d(Y),d(me),d(W),d(ue),d(pe),d(Z))},c.\u0275cmp=x({type:c,selectors:[["app-core-module-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:Me,decls:18,vars:25,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["matPrefix",""],["style","vertical-align: middle","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,e){if(i&1){let l=_();j(),a(0,"div",1),u(1,"app-progress-spinner",2),m(2,Ce,2,3,"label",3),a(3,"span",4),m(4,ge,2,4,"img",5),M(5," \xA0"),s(),u(6,"input",6),a(7,"mat-autocomplete",7,0),b("optionSelected",function(w){return v(l),I(e.onActionSelect(w.option.value))}),m(9,Ie,4,4,"mat-option",8),h(10,"async"),s(),m(11,be,1,0,"i",9)(12,ye,1,0,"i",10)(13,_e,1,0,"i",11),a(14,"i",12),h(15,"translate"),b("click",function(){return v(l),I(e.onActionButtonReload())}),s(),m(16,Te,3,3,"em",13),H(17),s()}if(i&2){let l=G(8);n(),r("optionsInfoAreaId",e.constructorInfoAreaId),n(),r("ngIf",(e.optionLabel==null?null:e.optionLabel.length)>0),n(2),r("ngIf",e.dataModelSelect&&(e.dataModelSelect==null?null:e.dataModelSelect.linkMainImageIdSrc)),n(2),r("placeholder",C(e.optionPlaceholder))("id",A("app-cms-site-selector-",e.id))("formControl",e.formControl)("matAutocomplete",l)("required",e.optionRequired),B("disabled",e.optionDisabled?!0:null),n(),r("displayWith",e.displayFn),n(2),r("ngForOf",S(10,21,e.filteredOptions)),n(2),r("ngIf",!e.formControl.valid),n(),r("ngIf",e.optionRequired&&e.formControl.valid),n(),r("ngIf",(e.dataModelSelect==null?null:e.dataModelSelect.id)>0),n(),z("rotation360",e.publicHelper.processService.process.inRunArea[e.constructorInfoAreaId]),r("title",C(S(15,23,"ACTION.RELOAD"))),n(2),r("ngIf",e.optionRequired&&(!e.dataModelSelect||!e.dataModelSelect.id||e.dataModelSelect.id<=0))}},dependencies:[$,J,ee,te,re,oe,ae,ne,se,le,ce,fe,K,de,he],encapsulation:2});var Se=c;export{Se as a};
