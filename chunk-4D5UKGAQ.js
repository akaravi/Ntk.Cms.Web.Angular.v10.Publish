import{a as ce}from"./chunk-2SR2KTJV.js";import{f as pe}from"./chunk-M6XJRRI2.js";import{$ as re,$a as le,A as te,J as ie,Q as oe,Qb as ae,Rb as se,aa as ne,n as Z,q as x,u as ee}from"./chunk-2YOAOFR6.js";import{Ab as q,F as E,Fa as n,Fd as K,Ha as V,I as F,Ib as H,Jc as $,Jd as c,Kb as j,Kc as z,Kd as Q,Nb as b,Oa as d,Ob as G,P as D,Pb as B,Q as P,Qc as J,Sa as k,Td as X,Wb as A,Xb as T,Ya as f,cc as y,da as C,db as N,dc as I,ea as S,ge as Y,if as M,jb as l,kb as a,lb as s,mb as h,nd as u,p as U,q as w,sd as m,tb as _,vc as W,wb as v,yb as g,zb as L}from"./chunk-NIHJZM2J.js";import{i as R}from"./chunk-SEDBTTTN.js";var me=["*"];function fe(r,e){if(r&1&&(a(0,"label",12),b(1),s()),r&2){let i=g();l("for",T("app-cms-site-selector-",i.id)),n(),G(i.optionLabel)}}function he(r,e){if(r&1&&(a(0,"mat-option",13)(1,"span"),b(2),s()()),r&2){let i=e.$implicit,o=g();l("value",i)("disabled",o.optionDisabled),n(2),G(o.displayOption(i))}}function Ce(r,e){r&1&&h(0,"i",14)}function Se(r,e){r&1&&h(0,"i",15)}function ve(r,e){if(r&1){let i=_();a(0,"i",16),v("click",function(){C(i);let t=g();return S(t.onActionSelectClear())}),s()}}function ge(r,e){r&1&&(a(0,"em"),b(1),y(2,"translate"),s()),r&2&&(n(),B("(",I(2,1,"TITLE.Necessary"),")"))}var p=class p{constructor(e,i,o,t,O){this.coreEnumService=e;this.cdr=i;this.publicHelper=o;this.translate=t;this.categoryService=O;this.id=++p.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new K;this.dataModelSelect=new M;this.formControl=new ee;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new V;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(D(""),E(1500),F(),P(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){return R(this,null,function*(){let i=new Q;if(i.rowPerPage=20,i.accessLoad=!0,e&&e.length>0){let t=new c;t=new c,t.propertyName="username",t.value=e,t.searchType=m.Contains,t.clauseType=u.Or,i.filters.push(t),t=new c,t.propertyName="name",t.value=e,t.searchType=m.Contains,t.clauseType=u.Or,i.filters.push(t),t=new c,t.propertyName="email",t.value=e,t.searchType=m.Contains,t.clauseType=u.Or,i.filters.push(t),t=new c,t.propertyName="lastname",t.value=e,t.searchType=m.Contains,t.clauseType=u.Or,i.filters.push(t),e&&typeof+e=="number"&&+e>0&&(t=new c,t.propertyName="Id",t.value=e,t.searchType=m.Equal,t.clauseType=u.Or,i.filters.push(t))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(t=>{this.publicHelper.processService.processStart(o,t,this.constructorInfoAreaId)}),yield U(this.categoryService.ServiceGetAll(i)).then(t=>(this.dataModelResult=t,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),t.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(w(i=>(i.find(o=>o.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){let i=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(e).subscribe({next:i=>{i.isSuccess&&(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item))}});return}if(typeof e==typeof M){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new M,this.loadOptions()}};p.nextId=0,p.\u0275fac=function(i){return new(i||p)(d(X),d(W),d(pe),d(ae),d(Y))},p.\u0275cmp=k({type:p,selectors:[["app-cms-usergroup-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:me,decls:15,vars:24,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,o){if(i&1){let t=_();L(),a(0,"div",1),h(1,"app-progress-spinner",2),f(2,fe,2,3,"label",3),h(3,"input",4),a(4,"mat-autocomplete",5,0),v("optionSelected",function(ue){return C(t),S(o.onActionSelect(ue.option.value))}),f(6,he,3,3,"mat-option",6),y(7,"async"),s(),f(8,Ce,1,0,"i",7)(9,Se,1,0,"i",8)(10,ve,1,0,"i",9),a(11,"i",10),y(12,"translate"),v("click",function(){return C(t),S(o.onActionButtonReload())}),s(),f(13,ge,3,3,"em",11),q(14),s()}if(i&2){let t=H(5);n(),l("optionsInfoAreaId",o.constructorInfoAreaId),n(),l("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),n(),l("placeholder",A(o.optionPlaceholder))("id",T("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",t)("required",o.optionRequired),N("disabled",o.optionDisabled?!0:null),n(),l("displayWith",o.displayFn),n(2),l("ngForOf",I(7,20,o.filteredOptions)),n(2),l("ngIf",!o.formControl.valid),n(),l("ngIf",o.optionRequired&&o.formControl.valid),n(),l("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),n(),j("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),l("title",A(I(12,22,"ACTION.RELOAD"))),n(2),l("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[$,z,Z,x,ie,te,re,oe,ne,le,ce,J,se],encapsulation:2});var de=p;export{de as a};
