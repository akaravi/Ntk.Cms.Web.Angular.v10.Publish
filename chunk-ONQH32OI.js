import{a as se}from"./chunk-CEJ6PTYC.js";import{f as le}from"./chunk-IAWCIXMH.js";import{B as K,K as Q,gb as ie,hb as oe,ib as re,ma as X,o as x,pc as ne,qc as ae,r as z,v as J}from"./chunk-4UC5MNAK.js";import{Cd as f,E as F,Ea as n,Gb as j,H as E,Hc as W,Ic as U,Ja as c,Lb as S,Mb as I,Nb as H,O as w,Oa as V,Oc as $,P,Pd as Y,Td as d,Ua as h,Ub as G,Ud as Z,Vb as _,Wa as k,ac as T,ae as ee,bb as L,bc as A,ca as y,da as v,hb as a,ib as s,jb as p,je as te,kb as m,nf as g,p as R,q as D,rb as b,tc as B,ub as M,wb as C,xb as N,xd as u,yb as q}from"./chunk-4PHK4ED5.js";import{i as O}from"./chunk-SEDBTTTN.js";var me=["*"];function ue(r,e){if(r&1&&(s(0,"label",11),S(1),p()),r&2){let t=C();a("for",_("app-cms-site-selector-",t.id)),n(),I(t.optionLabel)}}function fe(r,e){if(r&1&&(s(0,"mat-option",12)(1,"span"),S(2),p()()),r&2){let t=e.$implicit,o=C();a("value",t)("disabled",o.optionDisabled),n(2),I(o.displayOption(t))}}function he(r,e){r&1&&m(0,"i",13)}function Ce(r,e){r&1&&m(0,"i",14)}function Se(r,e){if(r&1){let t=b();s(0,"i",15),M("click",function(){y(t);let i=C();return v(i.onActionSelectClear())}),p()}}function ge(r,e){r&1&&(s(0,"em"),S(1),T(2,"translate"),p()),r&2&&(n(),H("(",A(2,1,"TITLE.Necessary"),")"))}var l=class l{constructor(e,t,o,i,ce){this.coreEnumService=e;this.cdr=t;this.publicHelper=o;this.translate=i;this.categoryService=ce;this.id=++l.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new Y;this.dataModelSelect=new g;this.formControl=new J;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new k;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(w(""),F(1500),E(),P(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){return O(this,null,function*(){let t=new Z;if(t.rowPerPage=20,t.accessLoad=!0,e&&e.length>0){let i=new d;i=new d,i.propertyName="SubDomain",i.value=e,i.searchType=f.Contains,i.clauseType=u.Or,t.filters.push(i),i=new d,i.propertyName="Domain",i.value=e,i.searchType=f.Contains,i.clauseType=u.Or,t.filters.push(i),i=new d,i.propertyName="Title",i.value=e,i.searchType=f.Contains,i.clauseType=u.Or,t.filters.push(i),e&&typeof+e=="number"&&+e>0&&(i=new d,i.propertyName="Id",i.value=e,i.searchType=f.Equal,i.clauseType=u.Or,t.filters.push(i))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield R(this.categoryService.ServiceGetAll(t)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(D(t=>(t.find(o=>o.id===e.id)||t.push(e),t)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(t=>t.id===e)){let t=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=t,this.formControl.setValue(t);return}this.categoryService.ServiceGetOneById(e).subscribe({next:t=>{t.isSuccess&&(this.filteredOptions=this.push(t.item),this.dataModelSelect=t.item,this.formControl.setValue(t.item),this.optionChange.emit(t.item))}});return}if(typeof e==typeof g){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new g,this.loadOptions()}};l.nextId=0,l.\u0275fac=function(t){return new(t||l)(c(ee),c(B),c(le),c(ne),c(te))},l.\u0275cmp=V({type:l,selectors:[["app-cms-sitecategory-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:me,decls:13,vars:18,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[4,"ngIf"],[1,"color-highlight",3,"for"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(t,o){if(t&1){let i=b();N(),s(0,"div",1),m(1,"app-progress-spinner",2),h(2,ue,2,3,"label",3),m(3,"input",4),s(4,"mat-autocomplete",5,0),M("optionSelected",function(de){return y(i),v(o.onActionSelect(de.option.value))}),h(6,fe,3,3,"mat-option",6),T(7,"async"),p(),h(8,he,1,0,"i",7)(9,Ce,1,0,"i",8)(10,Se,1,0,"i",9)(11,ge,3,3,"em",10),q(12),p()}if(t&2){let i=j(5);n(),a("optionsInfoAreaId",o.constructorInfoAreaId),n(),a("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),n(),a("placeholder",G(o.optionPlaceholder))("id",_("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),L("disabled",o.optionDisabled?!0:null),n(),a("displayWith",o.displayFn),n(2),a("ngForOf",A(7,16,o.filteredOptions)),n(2),a("ngIf",!o.formControl.valid),n(),a("ngIf",o.optionRequired&&o.formControl.valid),n(),a("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),n(),a("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[W,U,x,z,Q,K,oe,ie,re,X,se,$,ae],encapsulation:2});var pe=l;export{pe as a};
