import{a as Hi}from"./chunk-W6ZJBTW2.js";import{a as Bi}from"./chunk-7DUNEHBM.js";import{a as Vi,d as Fi}from"./chunk-NKVVWISU.js";import{f as ki}from"./chunk-JQRS7TAT.js";import{$ as _i,Ab as Di,Ba as gi,Bb as Pi,Da as Ji,La as Ci,Nb as Ai,Ua as xi,cb as wi,db as vi,eb as Mi,fb as yi,gb as Ti,hb as bi,ib as Ei,jb as Si,kb as Ii,lb as Li,m as fi,nb as We,r as Zi,uc as Ri,v as hi}from"./chunk-YBRH5NGE.js";import{A as ui,B as mi,C as pi,c as li,h as si,m as di,o as ci}from"./chunk-QRBNL5ZA.js";import{Mb as ri,Nb as Dt,Ob as ji,Pb as je,Qb as Ui}from"./chunk-R3Y64ZOJ.js";import{Ab as A,Cb as Xi,Db as $i,Dc as et,Eb as Ki,Ec as it,Fb as B,Gb as u,Hb as m,Ib as wt,Mb as ct,Nb as ut,Pb as Z,Ra as we,Sb as tt,Ub as f,Va as p,Xa as ti,Yb as ii,Zb as ni,_b as oi,cb as Ie,ec as Ge,hc as w,ib as ei,ic as ht,jc as mt,kc as ai,nc as gt,ob as st,oc as Ct,pa as V,pc as xt,qa as H,tc as Wt,zb as P}from"./chunk-2AL2II5Z.js";import{a as Ue}from"./chunk-SEDBTTTN.js";window.libpannellum=(function(i,n,t){"use strict";function l(dt,Qt){var K;dt&&(K=n.createElement("canvas"),K.style.width=K.style.height="100%",dt.appendChild(K));var g,a,Yt,Kt,G,D,St,pt,zt,Ye,re,v,rt,W,me,Ot,Pe,pe,te=["f","b","u","d","l","r"],fe=["f","r","b","l","u","d"];Qt&&(a=Qt),this.init=function(d,x,h,b,I,F,T){if(x===t&&(x="equirectangular"),x!="equirectangular"&&x!="cubemap"&&x!="multires")throw console.log("Error: invalid image type specified!"),{type:"config error"};if(rt=x,v=d,pe=T||{},g){if(Yt&&(a.detachShader(g,Yt),a.deleteShader(Yt)),Kt&&(a.detachShader(g,Kt),a.deleteShader(Kt)),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null),g.texture&&a.deleteTexture(g.texture),g.nodeCache)for(var U=0;U<g.nodeCache.length;U++)a.deleteTexture(g.nodeCache[U].texture);if(g.textureLoads)for(nt=[];g.textureLoads.length>0;)g.textureLoads.shift()(!1);a.deleteProgram(g),g=t}G&&(D&&(a.detachShader(G,D),a.deleteShader(D)),St&&(a.detachShader(G,St),a.deleteShader(St)),a.deleteProgram(G),G=t),re=t;var k,J=!1,Q;if(rt=="cubemap")for(k=0;k<6;k++)v[k].width>0?(Q===t&&(Q=v[k].width),Q!=v[k].width&&console.log("Cube faces have inconsistent widths: "+Q+" vs. "+v[k].width)):J=!0;function X(L){if(J){var Tt=L*L*4,Et=new Uint8ClampedArray(Tt),Y=T.backgroundColor?T.backgroundColor:[0,0,0];Y[0]*=255,Y[1]*=255,Y[2]*=255;for(var z=0;z<Tt;z++)Et[z++]=Y[0],Et[z++]=Y[1],Et[z++]=Y[2];var R=new ImageData(Et,L,L);for(k=0;k<6;k++)v[k].width==0&&(v[k]=R)}}if(rt=="cubemap"&&(Q&Q-1)!==0&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(a||(a=K.getContext("experimental-webgl",{alpha:!1,depth:!1})),a&&a.getError()==1286&&Xe()),!a&&(rt=="multires"&&v.hasOwnProperty("fallbackPath")||rt=="cubemap")&&("WebkitAppearance"in n.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||navigator.appVersion.indexOf("MSIE 10")!==-1)){zt&&dt.removeChild(zt),zt=n.createElement("div"),zt.className="pnlm-world";var vt;v.basePath?vt=v.basePath+v.fallbackPath:vt=v.fallbackPath;var Ce=0,xe=function(){var L=n.createElement("canvas");L.className="pnlm-face pnlm-"+fe[this.side]+"face",zt.appendChild(L);var Tt=L.getContext("2d");L.style.width=this.width+4+"px",L.style.height=this.height+4+"px",L.width=this.width+4,L.height=this.height+4,Tt.drawImage(this,2,2);var Et=Tt.getImageData(0,0,L.width,L.height),Y=Et.data,z,R;for(z=2;z<L.width-2;z++)for(R=0;R<4;R++)Y[(z+L.width)*4+R]=Y[(z+L.width*2)*4+R],Y[(z+L.width*(L.height-2))*4+R]=Y[(z+L.width*(L.height-3))*4+R];for(z=2;z<L.height-2;z++)for(R=0;R<4;R++)Y[(z*L.width+1)*4+R]=Y[(z*L.width+2)*4+R],Y[((z+1)*L.width-2)*4+R]=Y[((z+1)*L.width-3)*4+R];for(R=0;R<4;R++)Y[(L.width+1)*4+R]=Y[(L.width*2+2)*4+R],Y[(L.width*2-2)*4+R]=Y[(L.width*3-3)*4+R],Y[(L.width*(L.height-2)+1)*4+R]=Y[(L.width*(L.height-3)+2)*4+R],Y[(L.width*(L.height-1)-2)*4+R]=Y[(L.width*(L.height-2)-3)*4+R];for(z=1;z<L.width-1;z++)for(R=0;R<4;R++)Y[z*4+R]=Y[(z+L.width)*4+R],Y[(z+L.width*(L.height-1))*4+R]=Y[(z+L.width*(L.height-2))*4+R];for(z=1;z<L.height-1;z++)for(R=0;R<4;R++)Y[z*L.width*4+R]=Y[(z*L.width+1)*4+R],Y[((z+1)*L.width-1)*4+R]=Y[((z+1)*L.width-2)*4+R];for(R=0;R<4;R++)Y[R]=Y[(L.width+1)*4+R],Y[(L.width-1)*4+R]=Y[(L.width*2-2)*4+R],Y[L.width*(L.height-1)*4+R]=Y[(L.width*(L.height-2)+1)*4+R],Y[(L.width*L.height-1)*4+R]=Y[(L.width*(L.height-1)-2)*4+R];Tt.putImageData(Et,0,0),Mt.call(this)},Mt=function(){this.width>0?(pt===t&&(pt=this.width),pt!=this.width&&console.log("Fallback faces have inconsistent widths: "+pt+" vs. "+this.width)):J=!0,Ce++,Ce==6&&(pt=this.width,dt.appendChild(zt),F())};for(J=!1,k=0;k<6;k++){var ft=new Image;ft.crossOrigin=pe.crossOrigin?pe.crossOrigin:"anonymous",ft.side=k,ft.onload=xe,ft.onerror=Mt,rt=="multires"?ft.src=vt.replace("%s",fe[k])+(v.extension?"."+v.extension:""):ft.src=v[k].src}X(pt);return}else if(!a)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};rt=="cubemap"&&X(Q),v.basePath?v.fullpath=v.basePath+v.path:v.fullpath=v.path,v.invTileResolution=1/v.tileResolution;var It=Re();for(Ye=[],k=0;k<6;k++)Ye[k]=It.slice(k*12,k*12+12),It=Re();var Vt=0;if(rt=="equirectangular"){if(Vt=a.getParameter(a.MAX_TEXTURE_SIZE),Math.max(v.width/2,v.height)>Vt)throw console.log("Error: The image is too big; it's "+v.width+"px wide, but this device's maximum supported size is "+Vt*2+"px."),{type:"webgl size error",width:v.width,maxWidth:Vt*2}}else if(rt=="cubemap"&&Q>a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE))throw console.log("Error: The image is too big; it's "+Q+"px wide, but this device's maximum supported size is "+Vt+"px."),{type:"webgl size error",width:Q,maxWidth:Vt};if(T!==t){var Ht=isNaN(T.horizonPitch)?0:Number(T.horizonPitch),oe=isNaN(T.horizonRoll)?0:Number(T.horizonRoll);(Ht!=0||oe!=0)&&(re=[Ht,oe])}var ot=a.TEXTURE_2D;if(a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.getShaderPrecisionFormat){var C=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT);C&&C.precision<1&&(bt=bt.replace("highp","mediump"))}Yt=a.createShader(a.VERTEX_SHADER);var Ut=s;rt=="multires"&&(Ut=_),a.shaderSource(Yt,Ut),a.compileShader(Yt),Kt=a.createShader(a.FRAGMENT_SHADER);var ee=lt;if(rt=="cubemap"?(ot=a.TEXTURE_CUBE_MAP,ee=e):rt=="multires"&&(ee=ve),a.shaderSource(Kt,ee),a.compileShader(Kt),g=a.createProgram(),a.attachShader(g,Yt),a.attachShader(g,Kt),a.linkProgram(g),a.getShaderParameter(Yt,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(Yt)),a.getShaderParameter(Kt,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(Kt)),a.getProgramParameter(g,a.LINK_STATUS)||console.log(a.getProgramInfoLog(g)),a.useProgram(g),g.drawInProgress=!1,T.backgroundColor!==null){var At=T.backgroundColor?T.backgroundColor:[0,0,0];a.clearColor(At[0],At[1],At[2],1),a.clear(a.COLOR_BUFFER_BIT)}if(g.texCoordLocation=a.getAttribLocation(g,"a_texCoord"),a.enableVertexAttribArray(g.texCoordLocation),rt!="multires"){if(W||(W=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,W),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),a.STATIC_DRAW),a.vertexAttribPointer(g.texCoordLocation,2,a.FLOAT,!1,0,0),g.aspectRatio=a.getUniformLocation(g,"u_aspectRatio"),a.uniform1f(g.aspectRatio,a.drawingBufferWidth/a.drawingBufferHeight),g.psi=a.getUniformLocation(g,"u_psi"),g.theta=a.getUniformLocation(g,"u_theta"),g.f=a.getUniformLocation(g,"u_f"),g.h=a.getUniformLocation(g,"u_h"),g.v=a.getUniformLocation(g,"u_v"),g.vo=a.getUniformLocation(g,"u_vo"),g.rot=a.getUniformLocation(g,"u_rot"),a.uniform1f(g.h,h/(Math.PI*2)),a.uniform1f(g.v,b/Math.PI),a.uniform1f(g.vo,I/Math.PI*2),rt=="equirectangular"&&(g.backgroundColor=a.getUniformLocation(g,"u_backgroundColor"),a.uniform4fv(g.backgroundColor,At.concat([1]))),g.texture=a.createTexture(),a.bindTexture(ot,g.texture),rt=="cubemap")a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[1]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[3]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[4]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[5]),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[0]),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v[2]);else if(v.width<=Vt)a.uniform1i(a.getUniformLocation(g,"u_splitImage"),0),a.texImage2D(ot,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v);else{a.uniform1i(a.getUniformLocation(g,"u_splitImage"),1);var de=n.createElement("canvas");de.width=v.width/2,de.height=v.height;var ae=de.getContext("2d");ae.drawImage(v,0,0);var ce=ae.getImageData(0,0,v.width/2,v.height);a.texImage2D(ot,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,ce),g.texture2=a.createTexture(),a.activeTexture(a.TEXTURE1),a.bindTexture(ot,g.texture2),a.uniform1i(a.getUniformLocation(g,"u_image1"),1),ae.drawImage(v,-v.width/2,0),ce=ae.getImageData(0,0,v.width/2,v.height),a.texImage2D(ot,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,ce),a.texParameteri(ot,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(ot,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(ot,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(ot,a.TEXTURE_MAG_FILTER,a.LINEAR),a.activeTexture(a.TEXTURE0)}rt!="cubemap"&&v.width&&v.width<=Vt&&h==2*Math.PI&&(v.width&v.width-1)==0?a.texParameteri(ot,a.TEXTURE_WRAP_S,a.REPEAT):a.texParameteri(ot,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(ot,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(ot,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(ot,a.TEXTURE_MAG_FILTER,a.LINEAR)}else if(g.vertPosLocation=a.getAttribLocation(g,"a_vertCoord"),a.enableVertexAttribArray(g.vertPosLocation),me||(me=a.createBuffer()),Ot||(Ot=a.createBuffer()),Pe||(Pe=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,Ot),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),a.STATIC_DRAW),a.vertexAttribPointer(g.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,Pe),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,me),a.vertexAttribPointer(g.vertPosLocation,3,a.FLOAT,!1,0,0),g.perspUniform=a.getUniformLocation(g,"u_perspMatrix"),g.cubeUniform=a.getUniformLocation(g,"u_cubeMatrix"),g.currentNodes=[],g.nodeCache=[],g.nodeCacheTimestamp=0,g.textureLoads=[],v.shtHash||v.equirectangularThumbnail){D=a.createShader(a.VERTEX_SHADER),a.shaderSource(D,s),a.compileShader(D),St=a.createShader(a.FRAGMENT_SHADER),a.shaderSource(St,lt),a.compileShader(St),G=a.createProgram(),a.attachShader(G,D),a.attachShader(G,St),a.linkProgram(G),a.getShaderParameter(D,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(D)),a.getShaderParameter(St,a.COMPILE_STATUS)||console.log(a.getShaderInfoLog(St)),a.getProgramParameter(G,a.LINK_STATUS)||console.log(a.getProgramInfoLog(G)),a.useProgram(G),G.texCoordLocation=a.getAttribLocation(G,"a_texCoord"),a.enableVertexAttribArray(G.texCoordLocation),W||(W=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,W),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),a.STATIC_DRAW),a.vertexAttribPointer(G.texCoordLocation,2,a.FLOAT,!1,0,0),G.aspectRatio=a.getUniformLocation(G,"u_aspectRatio"),a.uniform1f(G.aspectRatio,a.drawingBufferWidth/a.drawingBufferHeight),G.psi=a.getUniformLocation(G,"u_psi"),G.theta=a.getUniformLocation(G,"u_theta"),G.f=a.getUniformLocation(G,"u_f"),G.h=a.getUniformLocation(G,"u_h"),G.v=a.getUniformLocation(G,"u_v"),G.vo=a.getUniformLocation(G,"u_vo"),G.rot=a.getUniformLocation(G,"u_rot"),a.uniform1f(G.h,1),G.texture=a.createTexture(),a.bindTexture(ot,G.texture);var _t,ue,Gt,yt=function(){a.useProgram(G),a.uniform1i(a.getUniformLocation(G,"u_splitImage"),0),a.texImage2D(ot,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,_t),a.texParameteri(ot,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(ot,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(ot,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(ot,a.TEXTURE_MAG_FILTER,a.LINEAR),a.uniform1f(G.v,ue),a.uniform1f(G.vo,Gt),a.useProgram(g)};if(v.shtHash&&(_t=ge(v.shtHash),ue=(2+1/31)/2,Gt=1-(2+1/31)/2,yt()),v.equirectangularThumbnail)if(typeof v.equirectangularThumbnail=="string")if(v.equirectangularThumbnail.slice(0,5)=="data:")_t=new Image,_t.onload=function(){ue=1,Gt=0,yt()},_t.src=v.equirectangularThumbnail;else throw console.log("Error: thumbnail string is not a data URI!"),{type:"config error"};else _t=v.equirectangularThumbnail,ue=1,Gt=0,yt();a.bindBuffer(a.ARRAY_BUFFER,me),a.vertexAttribPointer(g.vertPosLocation,3,a.FLOAT,!1,0,0),a.useProgram(g)}var $t=a.getError();if($t!==0)throw console.log("Error: Something went wrong with WebGL!",$t),{type:"webgl error"};F()},this.destroy=function(){if(dt!==t&&(K!==t&&dt.contains(K)&&dt.removeChild(K),zt!==t&&dt.contains(zt)&&dt.removeChild(zt)),a){var d=a.getExtension("WEBGL_lose_context");d&&d.loseContext()}},this.resize=function(){var d=i.devicePixelRatio||1;K.width=K.clientWidth*d,K.height=K.clientHeight*d,a&&(a.getError()==1286&&Xe(),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),rt!="multires"?a.uniform1f(g.aspectRatio,K.clientWidth/K.clientHeight):v.shtHash&&(a.useProgram(G),a.uniform1f(G.aspectRatio,K.clientWidth/K.clientHeight),a.useProgram(g)))},K&&this.resize(),this.setPose=function(d,x){d=isNaN(d)?0:Number(d),x=isNaN(x)?0:Number(x),d==0&&x==0?re=t:re=[d,x]},this.render=function(d,x,h,b){var I,F,T,U=0;if(b===t&&(b={}),b.roll&&(U=b.roll),b.dynamic)var k=b.dynamic;if(re!==t){var J=re[0],Q=re[1],X=d,vt=x,Ce=Math.cos(Q)*Math.sin(d)*Math.sin(J)+Math.cos(d)*(Math.cos(J)*Math.cos(x)+Math.sin(Q)*Math.sin(J)*Math.sin(x)),xe=-Math.sin(d)*Math.sin(Q)+Math.cos(d)*Math.cos(Q)*Math.sin(x),Mt=Math.cos(Q)*Math.cos(J)*Math.sin(d)+Math.cos(d)*(-Math.cos(x)*Math.sin(J)+Math.cos(J)*Math.sin(Q)*Math.sin(x));d=Math.asin(Math.max(Math.min(Mt,1),-1)),x=Math.atan2(xe,Ce);var ft=[Math.cos(X)*(Math.sin(Q)*Math.sin(J)*Math.cos(vt)-Math.cos(J)*Math.sin(vt)),Math.cos(X)*Math.cos(Q)*Math.cos(vt),Math.cos(X)*(Math.cos(J)*Math.sin(Q)*Math.cos(vt)+Math.sin(vt)*Math.sin(J))],It=[-Math.cos(d)*Math.sin(x),Math.cos(d)*Math.cos(x)],Vt=Math.acos(Math.max(Math.min((ft[0]*It[0]+ft[1]*It[1])/(Math.sqrt(ft[0]*ft[0]+ft[1]*ft[1]+ft[2]*ft[2])*Math.sqrt(It[0]*It[0]+It[1]*It[1])),1),-1));ft[2]<0&&(Vt=2*Math.PI-Vt),U+=Vt}if(b.hook&&b.hook({gl:a,program:g,previewProgram:G,imageType:rt,texCoordBuffer:W,cubeVertBuf:me,cubeVertTexCoordBuf:Ot,cubeVertIndBuf:Pe}),!a&&(rt=="multires"||rt=="cubemap")){T=pt/2;var Ht={f:"translate3d(-"+(T+2)+"px, -"+(T+2)+"px, -"+T+"px)",b:"translate3d("+(T+2)+"px, -"+(T+2)+"px, "+T+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(T+2)+"px, -"+T+"px, "+(T+2)+"px) rotateX(270deg)",d:"translate3d(-"+(T+2)+"px, "+T+"px, -"+(T+2)+"px) rotateX(90deg)",l:"translate3d(-"+T+"px, -"+(T+2)+"px, "+(T+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+T+"px, -"+(T+2)+"px, -"+(T+2)+"px) rotateY(270deg)"};I=1/Math.tan(h/2);var oe=I*K.clientWidth/2+"px",ot="perspective("+oe+") translateZ("+oe+") rotateX("+d+"rad) rotateY("+x+"rad) ",C=Object.keys(Ht);for(F=0;F<6;F++){var Ut=zt.querySelector(".pnlm-"+C[F]+"face");Ut&&(Ut.style.webkitTransform=ot+Ht[C[F]],Ut.style.transform=ot+Ht[C[F]])}return}if(rt!="multires"){var ee=2*Math.atan(Math.tan(h*.5)/(a.drawingBufferWidth/a.drawingBufferHeight));I=1/Math.tan(ee*.5),a.uniform1f(g.psi,x),a.uniform1f(g.theta,d),a.uniform1f(g.rot,U),a.uniform1f(g.f,I),k===!0&&rt=="equirectangular"&&(a.bindTexture(a.TEXTURE_2D,g.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,v)),a.drawArrays(a.TRIANGLES,0,6)}else{var At=typeof v.shtHash<"u"||typeof v.equirectangularThumbnail<"u",de=At;if(At&&g.currentNodes.length>=6){de=!1;for(var F=0;F<6;F++)if(!g.currentNodes[F].textureLoaded){de=!0;break}}if(de){a.useProgram(G),a.bindBuffer(a.ARRAY_BUFFER,W),a.vertexAttribPointer(G.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindTexture(a.TEXTURE_2D,G.texture);var ee=2*Math.atan(Math.tan(h*.5)/(a.drawingBufferWidth/a.drawingBufferHeight));I=1/Math.tan(ee*.5),a.uniform1f(G.psi,x),a.uniform1f(G.theta,d),a.uniform1f(G.rot,U),a.uniform1f(G.f,I),a.drawArrays(a.TRIANGLES,0,6),a.bindBuffer(a.ARRAY_BUFFER,me),a.vertexAttribPointer(g.vertPosLocation,3,a.FLOAT,!1,0,0),a.useProgram(g)}var ae=qe(h,a.drawingBufferWidth/a.drawingBufferHeight,.1,100),ce=qe(h,a.drawingBufferWidth/a.drawingBufferHeight,-100,100),_t=ye();_t=Te(_t,-U,"z"),_t=Te(_t,-d,"x"),_t=Te(_t,x,"y"),_t=ze(_t),a.uniformMatrix4fv(g.perspUniform,!1,Xt(ae)),a.uniformMatrix4fv(g.cubeUniform,!1,Xt(_t));var ue=He(ae,_t),Gt=He(ce,_t);if(g.nodeCache.sort(Ae),g.nodeCache.length>200&&g.nodeCache.length>g.currentNodes.length+50)for(var yt=g.nodeCache.splice(200,g.nodeCache.length-200),$t=0;$t<yt.length;$t++)a.deleteTexture(yt[$t].texture);for(g.currentNodes=[],T=0;T<6;T++){var L=new Pt(Ye[T],te[T],1,0,0,v.fullpath,null);le(ue,Gt,L,d,x,h)}for(g.currentNodes.sort(kt),F=nt.length-1;F>=0;F--)g.currentNodes.indexOf(nt[F].node)===-1&&(nt[F].node.textureLoad=!1,nt.splice(F,1));if(nt.length===0)for(F=0;F<g.currentNodes.length;F++){var Tt=g.currentNodes[F];if(!Tt.texture&&!Tt.textureLoad){Tt.textureLoad=!0,setTimeout(Zt,0,Tt);break}}g.textureLoads.length>0&&g.textureLoads.shift()(!0),qt(!At)}if(b.returnImage!==t)return i.createImageBitmap&&b.returnImage=="ImageBitmap"?createImageBitmap(K):b.returnImage.toString().indexOf("image/")==0?K.toDataURL(b.returnImage):K.toDataURL("image/png")},this.isLoading=function(){if(a&&rt=="multires"){for(var d=0;d<g.currentNodes.length;d++)if(!g.currentNodes[d].textureLoaded)return!0}return!1},this.isBaseLoaded=function(){if(g.currentNodes.length>=6){for(var d=0;d<6;d++)if(!g.currentNodes[d].textureLoaded)return!1;return!0}return!1},this.getCanvas=function(){return K};function Ae(d,x){return d.level==1&&x.level!=1?-1:x.level==1&&d.level!=1?1:x.timestamp-d.timestamp}function kt(d,x){return d.level!=x.level?d.level-x.level:d.diff-x.diff}function qt(d){if(!g.drawInProgress){g.drawInProgress=!0,d&&a.clear(a.COLOR_BUFFER_BIT);for(var x={},h=0;h<g.currentNodes.length;h++)x[g.currentNodes[h].parentPath]===t&&(x[g.currentNodes[h].parentPath]=0),x[g.currentNodes[h].parentPath]+=!(g.currentNodes[h].textureLoaded>1);for(var h=0;h<g.currentNodes.length;h++)g.currentNodes[h].textureLoaded>1&&x[g.currentNodes[h].path]!=4&&(a.bufferData(a.ARRAY_BUFFER,g.currentNodes[h].vertices,a.STATIC_DRAW),a.bindTexture(a.TEXTURE_2D,g.currentNodes[h].texture),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0));g.drawInProgress=!1}}function Pt(d,x,h,b,I,F,T){this.vertices=d,this.side=x,this.level=h,this.x=b,this.y=I;var U=typeof F=="object"?F.tileKey:F;U=U.replace("%s",x).replace("%l0",h-1).replace("%l",h).replace("%x",b).replace("%y",I),this.path=typeof F=="object"?F[U]:U,this.parentPath=T}function le(d,x,h,b,I,F){if(Ee(d,h.vertices)){for(var T=[],U=[],k=2,J=[],Q=0,X=0;X<4;X++){var vt=q(x,h.vertices.slice(X*3,(X+1)*3));T.push(vt[0]*vt[3]),U.push(vt[1]*vt[3]);var Ce=vt[2]*vt[3];k=Math.min(k,Ce),J.push(Math.abs(T[X])<=1&&Math.abs(U[X])<=1&&Ce>0),Q+=J[X]}var xe=v.cubeResolution*Math.pow(2,h.level-v.maxLevel),Mt=Math.ceil(xe*v.invTileResolution)-1,ft=xe%v.tileResolution*2,It=xe*2%v.tileResolution;if(It===0&&(It=v.tileResolution),ft===0&&(ft=v.tileResolution*2),h.level>1&&k>0&&Q>0){for(var Vt=0,X=0;X<4;X++){var Ht=(X+1)%4;if(J[X]||J[Ht]){var oe=(T[Ht]-T[X])*a.drawingBufferWidth/2,ot=(U[Ht]-U[X])*a.drawingBufferHeight/2;It<v.tileResolution&&(h.x==Mt?oe*=v.tileResolution/It:h.y==Mt&&(ot*=v.tileResolution/It)),ft<=v.tileResolution&&(h.x==Mt&&(oe*=2),h.y==Mt&&(ot*=2)),Vt=Math.max(Vt,Math.sqrt(oe*oe+ot*ot))}}if(Vt<=v.tileResolution/2)return}var C=h.vertices,Ut=C[0]+C[3]+C[6]+C[9],ee=C[1]+C[4]+C[7]+C[10],At=C[2]+C[5]+C[8]+C[11],de=Math.sqrt(Ut*Ut+ee*ee+At*At),ae=Math.asin(At/de),ce=Math.atan2(ee,Ut),_t=ce-I;_t+=_t>Math.PI?-2*Math.PI:_t<-Math.PI?2*Math.PI:0,_t=Math.abs(_t),h.diff=Math.acos(Math.sin(b)*Math.sin(ae)+Math.cos(b)*Math.cos(ae)*Math.cos(_t));for(var ue=!1,Gt=0;Gt<g.nodeCache.length;Gt++)if(g.nodeCache[Gt].path==h.path){ue=!0,g.nodeCache[Gt].timestamp=g.nodeCacheTimestamp++,g.nodeCache[Gt].diff=h.diff,g.currentNodes.push(g.nodeCache[Gt]);break}if(ue||(h.timestamp=g.nodeCacheTimestamp++,g.currentNodes.push(h),g.nodeCache.push(h)),h.level<v.maxLevel){var yt=.5;(h.x==Mt||h.y==Mt)&&(yt=1-v.tileResolution/(v.tileResolution+It));var X=1-yt,$t=[],L,Tt,Et=yt,Y=yt,z=yt,R=X,Lt=X,Ft=X;It<v.tileResolution&&(h.x==Mt&&h.y!=Mt?(Y=.5,Lt=.5,(h.side=="d"||h.side=="u")&&(z=.5,Ft=.5)):h.x!=Mt&&h.y==Mt&&(Et=.5,R=.5,(h.side=="l"||h.side=="r")&&(z=.5,Ft=.5))),ft<=v.tileResolution&&(h.x==Mt&&(Et=0,R=1,(h.side=="l"||h.side=="r")&&(z=0,Ft=1)),h.y==Mt&&(Y=0,Lt=1,(h.side=="d"||h.side=="u")&&(z=0,Ft=1))),L=new Float32Array([C[0],C[1],C[2],C[0]*Et+C[3]*R,C[1]*yt+C[4]*X,C[2]*z+C[5]*Ft,C[0]*Et+C[6]*R,C[1]*Y+C[7]*Lt,C[2]*z+C[8]*Ft,C[0]*yt+C[9]*X,C[1]*Y+C[10]*Lt,C[2]*z+C[11]*Ft]),Tt=new Pt(L,h.side,h.level+1,h.x*2,h.y*2,v.fullpath,h.path),$t.push(Tt),h.x==Mt&&ft<=v.tileResolution||(L=new Float32Array([C[0]*Et+C[3]*R,C[1]*yt+C[4]*X,C[2]*z+C[5]*Ft,C[3],C[4],C[5],C[3]*yt+C[6]*X,C[4]*Y+C[7]*Lt,C[5]*z+C[8]*Ft,C[0]*Et+C[6]*R,C[1]*Y+C[7]*Lt,C[2]*z+C[8]*Ft]),Tt=new Pt(L,h.side,h.level+1,h.x*2+1,h.y*2,v.fullpath,h.path),$t.push(Tt)),!(h.x==Mt&&ft<=v.tileResolution)&&!(h.y==Mt&&ft<=v.tileResolution)&&(L=new Float32Array([C[0]*Et+C[6]*R,C[1]*Y+C[7]*Lt,C[2]*z+C[8]*Ft,C[3]*yt+C[6]*X,C[4]*Y+C[7]*Lt,C[5]*z+C[8]*Ft,C[6],C[7],C[8],C[9]*Et+C[6]*R,C[10]*yt+C[7]*X,C[11]*z+C[8]*Ft]),Tt=new Pt(L,h.side,h.level+1,h.x*2+1,h.y*2+1,v.fullpath,h.path),$t.push(Tt)),h.y==Mt&&ft<=v.tileResolution||(L=new Float32Array([C[0]*yt+C[9]*X,C[1]*Y+C[10]*Lt,C[2]*z+C[11]*Ft,C[0]*Et+C[6]*R,C[1]*Y+C[7]*Lt,C[2]*z+C[8]*Ft,C[9]*Et+C[6]*R,C[10]*yt+C[7]*X,C[11]*z+C[8]*Ft,C[9],C[10],C[11]]),Tt=new Pt(L,h.side,h.level+1,h.x*2,h.y*2+1,v.fullpath,h.path),$t.push(Tt));for(var Ht=0;Ht<$t.length;Ht++)le(d,x,$t[Ht],b,I,F)}}}function Re(){return new Float32Array([-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1])}function ye(){return new Float32Array([1,0,0,0,1,0,0,0,1])}function Te(d,x,h){var b=Math.sin(x),I=Math.cos(x);if(h=="x")return new Float32Array([d[0],I*d[1]+b*d[2],I*d[2]-b*d[1],d[3],I*d[4]+b*d[5],I*d[5]-b*d[4],d[6],I*d[7]+b*d[8],I*d[8]-b*d[7]]);if(h=="y")return new Float32Array([I*d[0]-b*d[2],d[1],I*d[2]+b*d[0],I*d[3]-b*d[5],d[4],I*d[5]+b*d[3],I*d[6]-b*d[8],d[7],I*d[8]+b*d[6]]);if(h=="z")return new Float32Array([I*d[0]+b*d[1],I*d[1]-b*d[0],d[2],I*d[3]+b*d[4],I*d[4]-b*d[3],d[5],I*d[6]+b*d[7],I*d[7]-b*d[6],d[8]])}function ze(d){return new Float32Array([d[0],d[1],d[2],0,d[3],d[4],d[5],0,d[6],d[7],d[8],0,0,0,0,1])}function Xt(d){return new Float32Array([d[0],d[4],d[8],d[12],d[1],d[5],d[9],d[13],d[2],d[6],d[10],d[14],d[3],d[7],d[11],d[15]])}function qe(d,x,h,b){var I=2*Math.atan(Math.tan(d/2)*a.drawingBufferHeight/a.drawingBufferWidth),F=1/Math.tan(I/2);return new Float32Array([F/x,0,0,0,0,F,0,0,0,0,(b+h)/(h-b),2*b*h/(h-b),0,0,-1,0])}function ke(d,x){a.bindTexture(a.TEXTURE_2D,x),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null)}var nt=[],se=(function(){var d=4,x={},h;function b(){var U=this;this.texture=this.callback=null,this.image=new Image,this.image.crossOrigin=h||"anonymous";var k=function(){g.textureLoads.push(function(J){J&&(U.image.width>0&&U.image.height>0?(ke(U.image,U.texture),U.callback(U.texture,!0)):U.callback(U.texture,!1)),F(U)})};this.image.addEventListener("load",k),this.image.addEventListener("error",k)}b.prototype.loadTexture=function(U,k,J){this.texture=k,this.callback=J,this.image.src=U};function I(U,k,J,Q){this.node=U,this.src=k,this.texture=J,this.callback=Q}function F(U){if(nt.length){var k=nt.shift();U.loadTexture(k.src,k.texture,k.callback)}else x[d++]=U}for(var T=0;T<d;T++)x[T]=new b;return function(U,k,J,Q){h=Q;var X=a.createTexture();return d?x[--d].loadTexture(k,X,J):nt.push(new I(U,k,X,J)),X}})();function jt(d){se(d,d.path+(v.extension?"."+v.extension:""),function(x,h){d.texture=x,d.textureLoaded=h?2:1},pe.crossOrigin)}var Zt;if(i.Worker&&i.createImageBitmap){let d=function(){self.onmessage=function(x){var h=x.data[0],b=x.data[1];fetch(h,{mode:"cors",credentials:b=="use-credentials"?"include":"same-origin"}).then(function(I){return I.blob()}).then(function(I){return createImageBitmap(I)}).then(function(I){postMessage([h,!0,I],[I])}).catch(function(){postMessage([h,!1])})}};var Ve=new Blob(["("+d.toString()+")()"],{type:"application/javascript"}),Ze=new Worker(URL.createObjectURL(Ve)),S={};Ze.onmessage=function(x){var h=x.data[0],b=x.data[1],I=x.data[2];g.textureLoads.push(function(F){var T,U=!1;b&&F&&(T=a.createTexture(),ke(I,T),U=!0);var k=S[h];delete S[h],k!==t&&(k.texture=T,k.textureLoaded=U?2:1)})},Zt=function(x){var h=new URL(x.path+(v.extension?"."+v.extension:""),i.location).href;S[h]=x,Ze.postMessage([h,pe.crossOrigin])}}else Zt=jt;function He(d,x){return new Float32Array([d[0]*x[0],d[0]*x[1],d[0]*x[2],0,d[5]*x[4],d[5]*x[5],d[5]*x[6],0,d[10]*x[8],d[10]*x[9],d[10]*x[10],d[11],-x[8],-x[9],-x[10],0])}function q(d,x){return new Float32Array([d[0]*x[0]+d[1]*x[1]+d[2]*x[2],d[4]*x[0]+d[5]*x[1]+d[6]*x[2],d[11]+d[8]*x[0]+d[9]*x[1]+d[10]*x[2],1/(d[12]*x[0]+d[13]*x[1]+d[14]*x[2])])}function be(d,x){var h=q(d,x),b=h[0]*h[3],I=h[1]*h[3],F=h[2]*h[3],T=[0,0,0];return b<-1&&(T[0]=-1),b>1&&(T[0]=1),I<-1&&(T[1]=-1),I>1&&(T[1]=1),(F<-1||F>1)&&(T[2]=1),T}function Ee(d,x){var h=be(d,x.slice(0,3)),b=be(d,x.slice(3,6)),I=be(d,x.slice(6,9)),F=be(d,x.slice(9,12)),T=h[0]+b[0]+I[0]+F[0];if(T==-4||T==4)return!1;var U=h[1]+b[1]+I[1]+F[1];if(U==-4||U==4)return!1;var k=h[2]+b[2]+I[2]+F[2];return k!=4}function Xe(){console.log("Reducing canvas size due to error 1286!"),K.width=Math.round(K.width/2),K.height=Math.round(K.height/2)}var Fe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~",he="Bf[ff4fff|ffff0fffffBo@Ri5xag{Jmdf2+WiefCs@Ll7+Vi]Btag6[NmdgCv=Ho9;Qk;7zWiF_GsahDy:ErE?Mn$5+SkS_AyWiD#-CuJ[Iqp6;Nnx?7*SlE$*BxR@FtPA?Jq+%7:NnF*zAzn?CwIG@Ft-Y9?IrG+vA%w:AzGR?Cx*IF@EuI,nA+$*9%Gu:A#xCR?ByJ-VB-*wA+J**9*ZBv:9%L.QD.*aB.O.v9-MF+$8,O:MG:*OD;a:UB:IO:n9:Q:KJ;#IG=u-KE=Hs:MC?T:IO=wEL?#%FJ@K**FI@Y;HV=pDU?*sCS@S.uCR[m;Hp=VDq?*SCs@s.QCt[r:Iw=OEz?#IF$@#*HF%@u:K$;KI+=uEK-=*sCM:?w:M+:HO.;aCU;:%OCn?:z.Q..Ha;.ODv?-yFG$@,$-V;-Hw=+JH*?*lBP:?%%,n=+J*?%GQ:=#NCt?;y++v=%O:=zGt?:xHI,@-u,*z=zX?:wI+@,tEY??%r-$*;xt@,tP=?$qG%[:xn.#-:u$[%qp];xnN?[*sl.y:-r-?yn$^+sks_=yoi:v=*o?;uk;[zoi,_+skh:s@zl[+pi];tkg][xmhg;o@ti^xkg{$mhf|+oigf;f[ff_fff|ffff~fffff",Oi=3.317,Nt=[];function Be(d,x){return Math.pow((Math.abs(d)-x)/x,2)*(d-x>0?1:-1)}function Oe(d,x){var h=Math.floor(d/361),b=Math.floor(d/19)%19,I=d%19,F=Be(h,9)*x,T=Be(b,9)*x,U=Be(I,9)*x;return[F,T,U]}function _e(d,x){for(var h=Math.floor(d.length/x),b=[],I=0;I<h;I++){for(var F=0,T=0;T<x;T++)F=F*83+Fe.indexOf(d[I*x+T]);b.push(F)}return b}function Me(d,x,h){var b=Math.floor(Math.sqrt(d.length))-1,I=Array(b+1),F=Array(b+1);F[0]=0,I[0]=1,F[1]=Math.sin(h),I[1]=Math.cos(h);for(var T=2;T<=b;T++)F[T]=2*F[T-1]*I[1]-F[T-2],I[T]=2*I[T-1]*I[1]-I[T-2];for(var U=0,k=0,J=1;J<=b+1;J++)k+=J;for(var Q=b;Q>=0;Q--){var X=Math.floor((Q+1)*Q/2);U+=X!=0?d[X]*x[X-1]:d[X];for(var T=1;T<=Q;T++)U+=(d[++X]*I[T]+d[X+k-Q-1]*F[T])*x[X-1]}return Math.round(U)}function ge(d){if(Nt.length<1)for(var x=he.length/32,h=0;h<32;h++){Nt.push([]);for(var b=0;b<x;b++)Nt[h].push(Be(_e(he[h*x+b],1),41)*Oi)}for(var I=_e(d[0],1)[0],F=(Be(_e(d[1],1),41)+1)*255/2,T=_e(d.slice(2),2),U=[],k=[],J=[],h=0;h<T.length;h++){var Q=Oe(T[h],F);U.push(Q[0]),k.push(Q[1]),J.push(Q[2])}for(var X=.03125*Math.PI,vt=[],h=31;h>=0;h--)for(var b=0;b<64;b++)vt.push(Me(U,Nt[h],(b+.5)*X)),vt.push(Me(k,Nt[h],(b+.5)*X)),vt.push(Me(J,Nt[h],(b+.5)*X)),vt.push(255);return new ImageData(new Uint8ClampedArray(vt),64,32)}}var s=["attribute vec2 a_texCoord;","varying vec2 v_texCoord;","void main() {","gl_Position = vec4(a_texCoord, 0.0, 1.0);","v_texCoord = a_texCoord;","}"].join(""),_=["attribute vec3 a_vertCoord;","attribute vec2 a_texCoord;","uniform mat4 u_cubeMatrix;","uniform mat4 u_perspMatrix;","varying mediump vec2 v_texCoord;","void main(void) {","gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);","v_texCoord = a_texCoord;","}"].join(""),bt=["precision highp float;","uniform float u_aspectRatio;","uniform float u_psi;","uniform float u_theta;","uniform float u_f;","uniform float u_h;","uniform float u_v;","uniform float u_vo;","uniform float u_rot;","const float PI = 3.14159265358979323846264;","uniform sampler2D u_image0;","uniform sampler2D u_image1;","uniform bool u_splitImage;","uniform samplerCube u_imageCube;","varying vec2 v_texCoord;","uniform vec4 u_backgroundColor;","void main() {","float x = v_texCoord.x * u_aspectRatio;","float y = v_texCoord.y;","float sinrot = sin(u_rot);","float cosrot = cos(u_rot);","float rot_x = x * cosrot - y * sinrot;","float rot_y = x * sinrot + y * cosrot;","float sintheta = sin(u_theta);","float costheta = cos(u_theta);","float a = u_f * costheta - rot_y * sintheta;","float root = sqrt(rot_x * rot_x + a * a);","float lambda = atan(rot_x / root, a / root) + u_psi;","float phi = atan((rot_y * costheta + u_f * sintheta) / root);"].join(`
`),e=bt+["float cosphi = cos(phi);","gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));","}"].join(`
`),lt=bt+["lambda = mod(lambda + PI, PI * 2.0) - PI;","vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));","if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)","gl_FragColor = u_backgroundColor;","else {","if(u_splitImage) {","if(coord.x < 0.0)","gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / u_h, (-coord.y + u_v + u_vo) / (u_v * 2.0)));","else","gl_FragColor = texture2D(u_image1, vec2((coord.x + u_h) / u_h - 1.0, (-coord.y + u_v + u_vo) / (u_v * 2.0)));","} else {","gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));","}","}","}"].join(`
`),ve=["varying mediump vec2 v_texCoord;","uniform sampler2D u_sampler;","void main(void) {","gl_FragColor = texture2D(u_sampler, v_texCoord);","}"].join("");return{renderer:function(dt,Qt,K){return new l(dt,Qt,K)}}})(window,document);window.pannellum=(function(i,n,t){"use strict";function l(s,_){var bt=this,e,lt,ve,dt,Qt=!1,K=Date.now(),g=0,a=0,Yt=-1,Kt=0,G=0,D=new Array(10),St=!1,pt,zt=!1,Ye=!1,re=!1,v,rt,W={yaw:0,pitch:0,hfov:0},me=!1,Ot=!1,Pe=0,pe,te=0,fe,Ae,kt={},qt={},Pt=[],le=!1,Re=!1,ye=1e-6,Te,ze=!1,Xt,qe=!1,ke={hfov:100,minHfov:50,multiResMinHfov:!1,maxHfov:120,pitch:0,minPitch:t,maxPitch:t,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:t,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,dynamicUpdate:!1,doubleClickZoom:!0,keyboardZoom:!0,mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0],avoidShowingBackground:!1,animationTimingFunction:oe,draggable:!0,dragConfirm:!1,disableKeyboardCtrl:!1,crossOrigin:"anonymous",targetBlank:!1,touchPanSpeedCoeffFactor:1,capturedKeyNumbers:[16,17,27,37,38,39,40,61,65,68,83,87,107,109,173,187,189],friction:.15};ke.strings={loadButtonLabel:"Click to<br>Load<br>Panorama",loadingLabel:"Loading...",bylineLabel:"by %s",noPanoramaError:"No panorama image was specified.",fileAccessError:"The file %s could not be accessed.",malformedURLError:"There is something wrong with the panorama URL.",iOS8WebGLError:"Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).",genericWebGLError:"Your browser does not have the necessary WebGL support to display this panorama.",textureSizeError:"This panorama is too big for your device! It's %spx wide, but your device only supports images up to %spx wide. Try another device. (If you're the author, try scaling down the image.)",unknownError:"Unknown error. Check developer console.",twoTouchActivate:"Use two fingers together to pan the panorama.",twoTouchXActivate:"Use two fingers together to pan the panorama horizontally.",twoTouchYActivate:"Use two fingers together to pan the panorama vertically.",ctrlZoomActivate:"Use %s + scroll to zoom the panorama."},s=typeof s=="string"?n.getElementById(s):s,s.classList.add("pnlm-container"),s.tabIndex=0;var nt=n.createElement("div");nt.className="pnlm-ui",s.appendChild(nt);var se=n.createElement("div");se.className="pnlm-render-container",s.appendChild(se);var jt=n.createElement("div");jt.className="pnlm-dragfix",nt.appendChild(jt);var Zt=n.createElement("span");Zt.className="pnlm-about-msg";var Ve=n.createElement("a");Ve.href="https://pannellum.org/",Ve.textContent="Pannellum",Zt.appendChild(Ve);var Ze=n.createElement("span");Zt.appendChild(Ze),nt.appendChild(Zt),jt.addEventListener("contextmenu",Me);var S={},He=n.createElement("div");He.className="pnlm-sprite pnlm-hot-spot-debug-indicator",nt.appendChild(He),S.container=n.createElement("div"),S.container.className="pnlm-panorama-info",S.title=n.createElement("div"),S.title.className="pnlm-title-box",S.container.appendChild(S.title),S.author=n.createElement("div"),S.author.className="pnlm-author-box",S.container.appendChild(S.author),nt.appendChild(S.container),S.load={},S.load.box=n.createElement("div"),S.load.box.className="pnlm-load-box",S.load.boxp=n.createElement("p"),S.load.box.appendChild(S.load.boxp),S.load.lbox=n.createElement("div"),S.load.lbox.className="pnlm-lbox",S.load.lbox.innerHTML='<div class="pnlm-loading"></div>',S.load.box.appendChild(S.load.lbox),S.load.lbar=n.createElement("div"),S.load.lbar.className="pnlm-lbar",S.load.lbarFill=n.createElement("div"),S.load.lbarFill.className="pnlm-lbar-fill",S.load.lbar.appendChild(S.load.lbarFill),S.load.box.appendChild(S.load.lbar),S.load.msg=n.createElement("p"),S.load.msg.className="pnlm-lmsg",S.load.box.appendChild(S.load.msg),nt.appendChild(S.load.box),S.errorMsg=n.createElement("div"),S.errorMsg.className="pnlm-error-msg pnlm-info-box",nt.appendChild(S.errorMsg),S.interactionMsg=n.createElement("div"),S.interactionMsg.className="pnlm-interaction-msg pnlm-info-box",nt.appendChild(S.interactionMsg);var q={};q.container=n.createElement("div"),q.container.className="pnlm-controls-container",nt.appendChild(q.container),q.load=n.createElement("button"),q.load.className="pnlm-load-button",q.load.addEventListener("click",function(){z(),zi()}),nt.appendChild(q.load),q.zoom=n.createElement("div"),q.zoom.className="pnlm-zoom-controls pnlm-controls",q.zoomIn=n.createElement("div"),q.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control",q.zoomIn.addEventListener("click",Ft),q.zoom.appendChild(q.zoomIn),q.zoomOut=n.createElement("div"),q.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control",q.zoomOut.addEventListener("click",en),q.zoom.appendChild(q.zoomOut),q.container.appendChild(q.zoom),q.fullscreen=n.createElement("div"),q.fullscreen.addEventListener("click",R),q.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control",(n.fullscreenEnabled||n.mozFullScreenEnabled||n.webkitFullscreenEnabled||n.msFullscreenEnabled)&&q.container.appendChild(q.fullscreen),q.orientation=n.createElement("div"),q.orientation.addEventListener("click",function(o){Ot?Ke():Ni()}),q.orientation.addEventListener("mousedown",function(o){o.stopPropagation()}),q.orientation.addEventListener("touchstart",function(o){o.stopPropagation()}),q.orientation.addEventListener("pointerdown",function(o){o.stopPropagation()}),q.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control";var be=!1;i.DeviceOrientationEvent&&location.protocol=="https:"&&(navigator.userAgent.toLowerCase().indexOf("mobi")>=0||navigator.userAgent.indexOf("Mac")>=0&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0)&&(q.container.appendChild(q.orientation),be=!0);var Ee=n.createElement("div");Ee.className="pnlm-compass pnlm-controls pnlm-control",nt.appendChild(Ee),_.firstScene?Y(_.firstScene):_.default&&_.default.firstScene?Y(_.default.firstScene):Y(null),z(!0);function Xe(){var o=n.createElement("div");if(o.innerHTML="<!--[if lte IE 9]><i></i><![endif]-->",o.getElementsByTagName("i").length==1){Nt();return}fe=e.hfov,Ae=e.pitch;var r,c;if(e.type=="cubemap"){for(v=[],r=0;r<6;r++)v.push(new Image),v[r].crossOrigin=e.crossOrigin;S.load.lbox.style.display="block",S.load.lbar.style.display="none"}else if(e.type=="multires"){var M=JSON.parse(JSON.stringify(e.multiRes));e.basePath&&e.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(e.multiRes.basePath)?M.basePath=e.basePath+e.multiRes.basePath:e.multiRes.basePath?M.basePath=e.multiRes.basePath:e.basePath&&(M.basePath=e.basePath),v=M}else if(e.dynamic===!0)v=e.panorama;else{if(e.panorama===t){Nt(e.strings.noPanoramaError);return}v=new Image}if(e.type=="cubemap"){var y=6,E=function(){y--,y===0&&he()},j=function(O){var N=n.createElement("a");N.href=O.target.src,N.textContent=N.href,Nt(e.strings.fileAccessError.replace("%s",N.outerHTML))};for(r=0;r<v.length;r++)c=e.cubeMap[r],c=="null"?(console.log("Will use background instead of missing cubemap face "+r),E()):(e.basePath&&!Fe(c)&&(c=e.basePath+c),v[r].onload=E,v[r].onerror=j,v[r].src=Ne(c))}else if(e.type=="multires")he();else if(c="",e.basePath&&(c=e.basePath),e.dynamic!==!0){if(e.panorama instanceof Image||e.panorama instanceof ImageData||i.ImageBitmap&&e.panorama instanceof ImageBitmap){v=e.panorama,he();return}c=Fe(e.panorama)?e.panorama:c+e.panorama,v.onload=function(){i.URL.revokeObjectURL(this.src),he()},Xt=new XMLHttpRequest,Xt.onloadend=function(){if(Xt.status!=200){var O=n.createElement("a");O.href=c,O.textContent=O.href,Nt(e.strings.fileAccessError.replace("%s",O.outerHTML));return}var N=this.response;Oi(N,c),S.load.msg.innerHTML=""},Xt.onprogress=function(O){if(O.lengthComputable){var N=O.loaded/O.total*100;S.load.lbarFill.style.width=N+"%";var $,at,Bt;O.total>1e6?($="MB",at=(O.loaded/1e6).toFixed(2),Bt=(O.total/1e6).toFixed(2)):O.total>1e3?($="kB",at=(O.loaded/1e3).toFixed(1),Bt=(O.total/1e3).toFixed(1)):($="B",at=O.loaded,Bt=O.total),S.load.msg.innerHTML=at+" / "+Bt+" "+$}else S.load.lbox.style.display="block",S.load.lbar.style.display="none"};try{Xt.open("GET",c,!0)}catch{Nt(e.strings.malformedURLError)}Xt.responseType="blob",Xt.setRequestHeader("Accept","image/*,*/*;q=0.9"),Xt.setRequestHeader("cache-control","no-cache"),Xt.withCredentials=e.crossOrigin==="use-credentials",Xt.send()}e.draggable&&nt.classList.add("pnlm-grab"),nt.classList.remove("pnlm-grabbing"),le=e.dynamicUpdate===!0,e.dynamic&&le&&(v=e.panorama,he())}function Fe(o){return new RegExp("^(?:[a-z]+:)?//","i").test(o)||o[0]=="/"||o.slice(0,5)=="blob:"}function he(){lt||(lt=new libpannellum.renderer(se)),re||(re=!0,jt.addEventListener("mousedown",d,!1),n.addEventListener("mousemove",b,!1),n.addEventListener("mouseup",I,!1),e.mouseZoom&&(nt.addEventListener("mousewheel",Ce,!1),nt.addEventListener("DOMMouseScroll",Ce,!1)),e.doubleClickZoom&&jt.addEventListener("dblclick",x,!1),s.addEventListener("mozfullscreenchange",Lt,!1),s.addEventListener("webkitfullscreenchange",Lt,!1),s.addEventListener("msfullscreenchange",Lt,!1),s.addEventListener("fullscreenchange",Lt,!1),typeof ResizeObserver=="function"?(Te=new ResizeObserver(ot),Te.observe(s)):(i.addEventListener("resize",ot,!1),i.addEventListener("orientationchange",ot,!1)),e.disableKeyboardCtrl||(s.addEventListener("keydown",xe,!1),s.addEventListener("keyup",ft,!1),s.addEventListener("blur",Mt,!1)),n.addEventListener("mouseleave",I,!1),n.documentElement.style.pointerAction===""&&n.documentElement.style.touchAction===""?(jt.addEventListener("pointerdown",Q,!1),jt.addEventListener("pointermove",X,!1),jt.addEventListener("pointerup",vt,!1),jt.addEventListener("pointerleave",vt,!1)):(jt.addEventListener("touchstart",F,!1),jt.addEventListener("touchmove",T,!1),jt.addEventListener("touchend",U,!1)),i.navigator.pointerEnabled&&(s.style.touchAction="none")),_t(),ie(e.hfov),setTimeout(function(){Ye=!0},500)}function Oi(o,r){var c=new FileReader;c.addEventListener("loadend",function(){var M=c.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var y=M.indexOf("\xFF\xC2");(y<0||y>65536)&&Nt(e.strings.iOS8WebGLError)}var E=M.indexOf("<x:xmpmeta");if(E>-1&&e.ignoreGPanoXMP!==!0){var j=M.substring(E,M.indexOf("</x:xmpmeta>")+12),O=function($){var at;return j.indexOf($+'="')>=0?(at=j.substring(j.indexOf($+'="')+$.length+2),at=at.substring(0,at.indexOf('"'))):j.indexOf($+">")>=0&&(at=j.substring(j.indexOf($+">")+$.length+1),at=at.substring(0,at.indexOf("<"))),at!==t?Number(at):null},N={fullWidth:O("GPano:FullPanoWidthPixels"),croppedWidth:O("GPano:CroppedAreaImageWidthPixels"),fullHeight:O("GPano:FullPanoHeightPixels"),croppedHeight:O("GPano:CroppedAreaImageHeightPixels"),topPixels:O("GPano:CroppedAreaTopPixels"),heading:O("GPano:PoseHeadingDegrees"),horizonPitch:O("GPano:PosePitchDegrees"),horizonRoll:O("GPano:PoseRollDegrees"),pitch:O("GPano:InitialViewPitchDegrees"),yaw:O("GPano:InitialViewHeadingDegrees"),hfov:O("GPano:InitialHorizontalFOVDegrees")};N.fullWidth!==null&&N.croppedWidth!==null&&N.fullHeight!==null&&N.croppedHeight!==null&&N.topPixels!==null&&(Pt.indexOf("haov")<0&&(e.haov=N.croppedWidth/N.fullWidth*360),Pt.indexOf("vaov")<0&&(e.vaov=N.croppedHeight/N.fullHeight*180),Pt.indexOf("vOffset")<0&&(e.vOffset=((N.topPixels+N.croppedHeight/2)/N.fullHeight-.5)*-180),N.heading!==null&&Pt.indexOf("northOffset")<0&&(e.northOffset=N.heading,e.compass!==!1&&(e.compass=!0)),N.horizonPitch!==null&&N.horizonRoll!==null&&(Pt.indexOf("horizonPitch")<0&&(e.horizonPitch=N.horizonPitch),Pt.indexOf("horizonRoll")<0&&(e.horizonRoll=N.horizonRoll)),N.pitch!=null&&Pt.indexOf("pitch")<0&&(e.pitch=N.pitch),N.yaw!=null&&Pt.indexOf("yaw")<0&&(e.yaw=N.yaw),N.hfov!=null&&Pt.indexOf("hfov")<0&&(e.hfov=N.hfov))}v.src=i.URL.createObjectURL(o),v.onerror=function(){function $(){return i.fetch?i.fetch(n.location.href).then(function(at){return at.headers.get("Content-Security-Policy")}):null}$().then(function(at){if(at){var Bt=at.split(";").find(function(Rt){var ne=Rt.match(/img-src(.*)/);if(ne)return!ne[1].includes("blob")});Bt&&(console.log("CSP blocks blobs; reverting to URL."),v.crossOrigin=e.crossOrigin,v.src=r)}})}}),c.readAsBinaryString!==t?c.readAsBinaryString(o):c.readAsText(o)}function Nt(o){o===t&&(o=e.strings.genericWebGLError),S.errorMsg.innerHTML="<p>"+o+"</p>",q.load.style.display="none",S.load.box.style.display="none",S.errorMsg.style.display="table",zt=!0,pt=t,se.style.display="none",Jt("error",o)}function Be(){zt&&(S.load.box.style.display="none",S.errorMsg.style.display="none",zt=!1,se.style.display="block",Jt("errorcleared"))}function Oe(o){S.interactionMsg.style.opacity=1,S.interactionMsg.innerHTML="<p>"+o+"</p>",S.interactionMsg.style.display="table",Jt("messageshown"),clearTimeout(S.interactionMsg.timeout),S.interactionMsg.removeEventListener("transitionend",_e),S.interactionMsg.timeout=setTimeout(function(){S.interactionMsg.style.opacity=0,S.interactionMsg.addEventListener("transitionend",_e)},2e3)}function _e(){S.interactionMsg.style.opacity=0,S.interactionMsg.style.display="none",Jt("messagecleared")}function Me(o){var r=ge(o);Zt.style.left=r.x+"px",Zt.style.top=r.y+"px",clearTimeout(Me.t1),clearTimeout(Me.t2),Zt.style.display="block",Zt.style.opacity=1,Me.t1=setTimeout(function(){Zt.style.opacity=0},2e3),Me.t2=setTimeout(function(){Zt.style.display="none"},2500),o.preventDefault()}function ge(o){var r=s.getBoundingClientRect(),c={};return c.x=(o.clientX||o.pageX)-r.left,c.y=(o.clientY||o.pageY)-r.top,c}function d(o){if(o.preventDefault(),s.focus(),!(!pt||!e.draggable||e.draggingHotSpot)){var r=ge(o);if(e.hotSpotDebug){var c=h(o);console.log("Pitch: "+c[0]+", Yaw: "+c[1]+", Center Pitch: "+e.pitch+", Center Yaw: "+e.yaw+", HFOV: "+e.hfov)}$e(),Ke(),e.roll=0,W.hfov=0,Qt=!0,K=Date.now(),g=r.x,a=r.y,Kt=e.yaw,G=e.pitch,nt.classList.add("pnlm-grabbing"),nt.classList.remove("pnlm-grab"),Jt("mousedown",o),C()}}function x(o){if(e.minHfov===e.hfov)bt.setHfov(fe,1e3);else{var r=h(o);bt.lookAt(r[0],r[1],e.minHfov,1e3)}}function h(o){var r=ge(o),c=lt.getCanvas(),M=c.clientWidth,y=c.clientHeight,E=r.x/M*2-1,j=(1-r.y/y*2)*y/M,O=1/Math.tan(e.hfov*Math.PI/360),N=Math.sin(e.pitch*Math.PI/180),$=Math.cos(e.pitch*Math.PI/180),at=O*$-j*N,Bt=Math.sqrt(E*E+at*at),Rt=Math.atan((j*$+O*N)/Bt)*180/Math.PI,ne=Math.atan2(E/Bt,at/Bt)*180/Math.PI+e.yaw;return ne<-180&&(ne+=360),ne>180&&(ne-=360),[Rt,ne]}function b(o){if(dt)yt(dt,o);else if(Qt&&pt){K=Date.now();var r=lt.getCanvas(),c=r.clientWidth,M=r.clientHeight,y=ge(o),E=(Math.atan(g/c*2-1)-Math.atan(y.x/c*2-1))*180/Math.PI*e.hfov/90+Kt;W.yaw=(E-e.yaw)%360*.2,e.yaw=E;var j=2*Math.atan(Math.tan(e.hfov/360*Math.PI)*M/c)*180/Math.PI,O=(Math.atan(y.y/M*2-1)-Math.atan(a/M*2-1))*180/Math.PI*j/90+G;W.pitch=(O-e.pitch)*.2,e.pitch=O}}function I(o){dt&&dt.dragHandlerFunc&&dt.dragHandlerFunc(o,dt.dragHandlerArgs),dt=null,Qt&&(Qt=!1,Date.now()-K>15&&(W.pitch=W.yaw=0),nt.classList.add("pnlm-grab"),nt.classList.remove("pnlm-grabbing"),K=Date.now(),Jt("mouseup",o))}function F(o){if(!(!pt||!e.draggable||dt)){$e(),Ke(),e.roll=0,W.hfov=0;var r=ge(o.targetTouches[0]);if(g=r.x,a=r.y,o.targetTouches.length==2){var c=ge(o.targetTouches[1]);g+=(c.x-r.x)*.5,a+=(c.y-r.y)*.5,Yt=Math.sqrt((r.x-c.x)*(r.x-c.x)+(r.y-c.y)*(r.y-c.y))}Qt=!0,K=Date.now(),Kt=e.yaw,G=e.pitch,Jt("touchstart",o),C()}}function T(o){if(e.draggable&&(e.dragConfirm||o.preventDefault(),pt&&(K=Date.now()),Qt&&pt)){var r=ge(o.targetTouches[0]),c=r.x,M=r.y;if(o.targetTouches.length==2&&Yt!=-1){var y=ge(o.targetTouches[1]);c+=(y.x-r.x)*.5,M+=(y.y-r.y)*.5;var E=Math.sqrt((r.x-y.x)*(r.x-y.x)+(r.y-y.y)*(r.y-y.y));ie(e.hfov+(Yt-E)*.1),Yt=E}var j=e.hfov/360*e.touchPanSpeedCoeffFactor;if(!St&&(e.dragConfirm=="both"||e.dragConfirm=="yaw")&&o.targetTouches.length!=2)g!=c&&(e.dragConfirm=="yaw"?Oe(e.strings.twoTouchXActivate):Oe(e.strings.twoTouchActivate));else{var O=(g-c)*j+Kt;W.yaw=(O-e.yaw)%360*.2,e.yaw=O}if(!St&&(e.dragConfirm=="both"||e.dragConfirm=="pitch")&&o.targetTouches.length!=2)a!=M&&(e.dragConfirm=="pitch"?Oe(e.strings.twoTouchYActivate):Oe(e.strings.twoTouchActivate));else{var N=(M-a)*j+G;W.pitch=(N-e.pitch)*.2,e.pitch=N}(e.dragConfirm=="yaw"||e.dragConfirm=="pitch"||e.dragConfirm=="both")&&o.targetTouches.length==2&&(_e(),o.preventDefault())}}function U(){dt=null,Qt=!1,Date.now()-K>150&&(W.pitch=W.yaw=0),Yt=-1,K=Date.now(),Jt("touchend",event)}var k=[],J=[];function Q(o){if(o.pointerType=="touch"){if(!pt||!e.draggable)return;k.push(o.pointerId),J.push({clientX:o.clientX,clientY:o.clientY}),o.targetTouches=J,F(o),o.preventDefault()}}function X(o){if(o.pointerType=="touch"){if(dt){yt(dt,o);return}if(!e.draggable)return;for(var r=0;r<k.length;r++)if(o.pointerId==k[r]){J[r].clientX=o.clientX,J[r].clientY=o.clientY,o.targetTouches=J,T(o),o.preventDefault();return}}}function vt(o){if(dt&&dt.dragHandlerFunc&&dt.dragHandlerFunc(o,dt.dragHandlerArgs),dt=null,o.pointerType=="touch"){for(var r=!1,c=0;c<k.length;c++)o.pointerId==k[c]&&(k[c]=t),k[c]&&(r=!0);r||(k=[],J=[],U()),o.preventDefault()}}function Ce(o){if(!(!pt||e.mouseZoom=="fullscreenonly"&&!St)){if(!St&&e.mouseZoom=="ctrl"&&!o.ctrlKey){var r=navigator.platform.indexOf("Mac")!=-1?"control":"ctrl";Oe(e.strings.ctrlZoomActivate.replace("%s",'<kbd class="pnlm-outline">'+r+"</kbd>"));return}_e(),o.preventDefault(),$e(),K=Date.now(),o.wheelDeltaY?(ie(e.hfov-o.wheelDeltaY*.05),W.hfov=o.wheelDelta<0?1:-1):o.wheelDelta?(ie(e.hfov-o.wheelDelta*.05),W.hfov=o.wheelDelta<0?1:-1):o.detail&&(ie(e.hfov+o.detail*1.5),W.hfov=o.detail>0?1:-1),C()}}function xe(o){$e(),K=Date.now(),Ke(),e.roll=0;var r=o.which||o.keycode;e.capturedKeyNumbers.indexOf(r)<0||!St&&(r==16||r==17)&&e.mouseZoom=="ctrl"||(o.preventDefault(),r==27?St&&R():It(r,!0))}function Mt(){for(var o=0;o<10;o++)D[o]=!1}function ft(o){var r=o.which||o.keycode;e.capturedKeyNumbers.indexOf(r)<0||(o.preventDefault(),It(r,!1))}function It(o,r){var c=!1;switch(o){case 109:case 189:case 17:case 173:D[0]!=r&&(c=!0),D[0]=r;break;case 107:case 187:case 16:case 61:D[1]!=r&&(c=!0),D[1]=r;break;case 38:D[2]!=r&&(c=!0),D[2]=r;break;case 87:D[6]!=r&&(c=!0),D[6]=r;break;case 40:D[3]!=r&&(c=!0),D[3]=r;break;case 83:D[7]!=r&&(c=!0),D[7]=r;break;case 37:D[4]!=r&&(c=!0),D[4]=r;break;case 65:D[8]!=r&&(c=!0),D[8]=r;break;case 39:D[5]!=r&&(c=!0),D[5]=r;break;case 68:D[9]!=r&&(c=!0),D[9]=r}c&&r&&(typeof performance<"u"&&performance.now()?rt=performance.now():rt=Date.now(),C())}function Vt(){if(pt){var o=!1,r=e.pitch,c=e.yaw,M=e.hfov,y;typeof performance<"u"&&performance.now()?y=performance.now():y=Date.now(),rt===t&&(rt=y);var E=(y-rt)*e.hfov/1200;if(E=Math.min(E,10),D[0]&&e.keyboardZoom===!0&&(ie(e.hfov+(W.hfov*.8+.4)*E),o=!0),D[1]&&e.keyboardZoom===!0&&(ie(e.hfov+(W.hfov*.8-.2)*E),o=!0),(D[2]||D[6])&&(e.pitch+=(W.pitch*.8+.2)*E,o=!0),(D[3]||D[7])&&(e.pitch+=(W.pitch*.8-.2)*E,o=!0),(D[4]||D[8])&&(e.yaw+=(W.yaw*.8-.2)*E,o=!0),(D[5]||D[9])&&(e.yaw+=(W.yaw*.8+.2)*E,o=!0),o&&(K=Date.now()),e.autoRotate){if(y-rt>.001){var j=(y-rt)/1e3,O=(W.yaw/j*E-e.autoRotate*.2)*j;O=(-e.autoRotate>0?1:-1)*Math.min(Math.abs(e.autoRotate*j),Math.abs(O)),e.yaw+=O}e.autoRotateStopDelay&&(e.autoRotateStopDelay-=y-rt,e.autoRotateStopDelay<=0&&(e.autoRotateStopDelay=!1,te=e.autoRotate,e.autoRotate=0))}if(kt.pitch&&(Ht("pitch"),r=e.pitch),kt.yaw&&(Ht("yaw"),c=e.yaw),kt.hfov&&(Ht("hfov"),M=e.hfov),E>0&&!e.autoRotate){var N=1-e.friction;!D[4]&&!D[5]&&!D[8]&&!D[9]&&!kt.yaw&&(e.yaw+=W.yaw*E*N),!D[2]&&!D[3]&&!D[6]&&!D[7]&&!kt.pitch&&(e.pitch+=W.pitch*E*N),!D[0]&&!D[1]&&!kt.hfov&&(e.hfov>90&&(N*=1-(e.hfov-90)/90),ie(e.hfov+W.hfov*E*N))}if(rt=y,E>0){W.yaw=W.yaw*.8+(e.yaw-c)/E*.2,W.pitch=W.pitch*.8+(e.pitch-r)/E*.2,W.hfov=W.hfov*.8+(e.hfov-M)/E*.2;var $=e.autoRotate?Math.abs(e.autoRotate):5;W.yaw=Math.min($,Math.max(W.yaw,-$)),W.pitch=Math.min($,Math.max(W.pitch,-$)),W.hfov=Math.min($,Math.max(W.hfov,-$))}D[0]&&D[1]&&(W.hfov=0),(D[2]||D[6])&&(D[3]||D[7])&&(W.pitch=0),(D[4]||D[8])&&(D[5]||D[9])&&(W.yaw=0)}}function Ht(o){var r=kt[o],c=Math.min(1,Math.max((Date.now()-r.startTime)/1e3/(r.duration/1e3),0)),M=r.startPosition+e.animationTimingFunction(c)*(r.endPosition-r.startPosition);(r.endPosition>r.startPosition&&M>=r.endPosition||r.endPosition<r.startPosition&&M<=r.endPosition||r.endPosition===r.startPosition)&&(M=r.endPosition,W[o]=0,delete kt[o]),e[o]=M}function oe(o){return o<.5?2*o*o:-1+(4-2*o)*o}function ot(){Lt("resize")}function C(){me||(me=!0,Ut())}function Ut(){if(!qe)if(ee(),pe&&clearTimeout(pe),Qt||Ot===!0)requestAnimationFrame(Ut);else if(D[0]||D[1]||D[2]||D[3]||D[4]||D[5]||D[6]||D[7]||D[8]||D[9]||e.autoRotate||kt.pitch||kt.yaw||kt.hfov||Math.abs(W.yaw)>.01||Math.abs(W.pitch)>.01||Math.abs(W.hfov)>.01)Vt(),e.autoRotateInactivityDelay>=0&&te&&Date.now()-K>e.autoRotateInactivityDelay&&!e.autoRotate&&(e.autoRotate=te,bt.lookAt(Ae,t,fe,3e3)),requestAnimationFrame(Ut);else if(lt&&(lt.isLoading()||e.dynamic===!0&&le))requestAnimationFrame(Ut);else{bt.getPitch&&bt.getYaw&&bt.getHfov&&Jt("animatefinished",{pitch:bt.getPitch(),yaw:bt.getYaw(),hfov:bt.getHfov()}),me=!1,rt=t;var o=e.autoRotateInactivityDelay-(Date.now()-K);o>0?pe=setTimeout(function(){e.autoRotate=te,bt.lookAt(Ae,t,fe,3e3),C()},o):e.autoRotateInactivityDelay>=0&&te&&(e.autoRotate=te,bt.lookAt(Ae,t,fe,3e3),C())}}function ee(){var o;if(pt){var r=lt.getCanvas();e.autoRotate!==!1&&(e.yaw>360?e.yaw-=360:e.yaw<-360&&(e.yaw+=360)),o=e.yaw;var c=0,M=0;if(e.avoidShowingBackground){var y=e.hfov/2,E=Math.atan2(Math.tan(y/180*Math.PI),r.width/r.height)*180/Math.PI,j=e.vaov>e.haov;j?M=E*(1-Math.min(Math.cos((e.pitch-y)/180*Math.PI),Math.cos((e.pitch+y)/180*Math.PI))):c=y*(1-Math.min(Math.cos((e.pitch-E)/180*Math.PI),Math.cos((e.pitch+E)/180*Math.PI)))}var O=e.maxYaw-e.minYaw,N=-180,$=180;O<360&&(N=e.minYaw+e.hfov/2+c,$=e.maxYaw-e.hfov/2-c,O<e.hfov&&(N=$=(N+$)/2),e.yaw=Math.max(N,Math.min($,e.yaw))),e.autoRotate===!1&&(e.yaw>360?e.yaw-=360:e.yaw<-360&&(e.yaw+=360)),e.autoRotate!==!1&&o!=e.yaw&&rt!==t&&(e.autoRotate*=-1);var at=2*Math.atan(Math.tan(e.hfov/180*Math.PI*.5)/(r.width/r.height))/Math.PI*180,Bt=e.minPitch+at/2,Rt=e.maxPitch-at/2,ne=e.maxPitch-e.minPitch;ne<at&&(Bt=Rt=(Bt+Rt)/2),isNaN(Bt)&&(Bt=-90),isNaN(Rt)&&(Rt=90),e.pitch=Math.max(Bt,Math.min(Rt,e.pitch)),lt.render(e.pitch*Math.PI/180,e.yaw*Math.PI/180,e.hfov*Math.PI/180,{roll:e.roll*Math.PI/180,dynamic:le}),Re&&(Re=le=!1),Et(),e.compass&&(Ee.style.transform="rotate("+(-e.yaw-e.northOffset)+"deg)",Ee.style.webkitTransform="rotate("+(-e.yaw-e.northOffset)+"deg)")}}function At(o,r,c,M){this.w=o,this.x=r,this.y=c,this.z=M}At.prototype.multiply=function(o){return new At(this.w*o.w-this.x*o.x-this.y*o.y-this.z*o.z,this.x*o.w+this.w*o.x+this.y*o.z-this.z*o.y,this.y*o.w+this.w*o.y+this.z*o.x-this.x*o.z,this.z*o.w+this.w*o.z+this.x*o.y-this.y*o.x)},At.prototype.toEulerAngles=function(){var o=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),r=Math.asin(2*(this.w*this.y-this.z*this.x)),c=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return[o,r,c]};function de(o,r,c){var M=[r?r*Math.PI/180/2:0,c?c*Math.PI/180/2:0,o?o*Math.PI/180/2:0],y=[Math.cos(M[0]),Math.cos(M[1]),Math.cos(M[2])],E=[Math.sin(M[0]),Math.sin(M[1]),Math.sin(M[2])];return new At(y[0]*y[1]*y[2]-E[0]*E[1]*E[2],E[0]*y[1]*y[2]-y[0]*E[1]*E[2],y[0]*E[1]*y[2]+E[0]*y[1]*E[2],y[0]*y[1]*E[2]+E[0]*E[1]*y[2])}function ae(o,r,c){var M=de(o,r,c);M=M.multiply(new At(Math.sqrt(.5),-Math.sqrt(.5),0,0));var y=i.orientation?-i.orientation*Math.PI/180/2:0;return M.multiply(new At(Math.cos(y),0,-Math.sin(y),0))}function ce(o){var r=ae(o.alpha,o.beta,o.gamma).toEulerAngles();typeof Ot=="number"&&Ot<10?Ot+=1:Ot===10?(Pe=r[2]/Math.PI*180+e.yaw,Ot=!0,requestAnimationFrame(Ut)):(e.pitch=r[0]/Math.PI*180,e.roll=-r[1]/Math.PI*180,e.yaw=-r[2]/Math.PI*180+Pe)}function _t(){try{var o={};e.horizonPitch!==t&&(o.horizonPitch=e.horizonPitch*Math.PI/180),e.horizonRoll!==t&&(o.horizonRoll=e.horizonRoll*Math.PI/180),e.backgroundColor!==t&&(o.backgroundColor=e.backgroundColor),lt.init(v,e.type,e.haov*Math.PI/180,e.vaov*Math.PI/180,e.vOffset*Math.PI/180,ue,o)}catch(r){if(e.dynamic!==!0&&(v=t),r.type=="webgl error"||r.type=="no webgl")Nt();else if(r.type=="webgl size error")Nt(e.strings.textureSizeError.replace("%s",r.width).replace("%s",r.maxWidth));else throw Nt(e.strings.unknownError),r}}function ue(){if(e.sceneFadeDuration&&lt.fadeImg!==t){lt.fadeImg.style.opacity=0;var o=lt.fadeImg;delete lt.fadeImg,setTimeout(function(){se.removeChild(o),Jt("scenechangefadedone")},e.sceneFadeDuration)}e.compass?Ee.style.display="inline":Ee.style.display="none",$t(),S.load.box.style.display="none",ve!==t&&(se.removeChild(ve),ve=t),pt=!0,e.dynamic!==!0&&(v=t),C(),Jt("load")}function Gt(o){o.pitch=Number(o.pitch)||0,o.yaw=Number(o.yaw)||0;var r=n.createElement("div");r.tabIndex=-1,r.className="pnlm-hotspot-base",o.cssClass?r.className+=" "+o.cssClass:r.className+=" pnlm-hotspot pnlm-sprite pnlm-"+Se(o.type);var c=n.createElement("span");o.text&&(c.innerHTML=Se(o.text));var M;if(o.video){var y=n.createElement("video"),E=o.video;e.basePath&&!Fe(E)&&(E=e.basePath+E),y.src=Ne(E),y.controls=!0,y.style.width=o.width+"px",nt.appendChild(r),c.appendChild(y)}else if(o.image){var j=o.image;e.basePath&&!Fe(j)&&(j=e.basePath+j),M=n.createElement("a"),M.href=Ne(o.URL?o.URL:j,!0),e.targetBlank&&(M.target="_blank",M.rel="noopener"),c.appendChild(M);var O=n.createElement("img");O.src=Ne(j),O.style.width=o.width+"px",O.style.paddingTop="5px",nt.appendChild(r),M.appendChild(O),c.style.maxWidth="initial"}else if(o.URL){if(M=n.createElement("a"),M.href=Ne(o.URL,!0),o.attributes)for(var N in o.attributes)M.setAttribute(N,o.attributes[N]);else e.targetBlank&&(M.target="_blank",M.rel="noopener");nt.appendChild(M),r.className+=" pnlm-pointer",c.className+=" pnlm-pointer",M.appendChild(r)}else o.sceneId&&(r.onclick=r.ontouchend=function(){return r.clicked||(r.clicked=!0,Je(o.sceneId,o.targetPitch,o.targetYaw,o.targetHfov)),!1},r.className+=" pnlm-pointer",c.className+=" pnlm-pointer"),nt.appendChild(r);o.createTooltipFunc?o.createTooltipFunc(r,o.createTooltipArgs):(o.text||o.video||o.image)&&(r.classList.add("pnlm-tooltip"),r.appendChild(c),c.style.width=c.scrollWidth-20+"px",c.style.marginLeft=-(c.scrollWidth-r.offsetWidth)/2+"px",c.style.marginTop=-c.scrollHeight-12+"px"),o.clickHandlerFunc&&(r.addEventListener("click",function($){o.clickHandlerFunc($,o.clickHandlerArgs)},"false"),n.documentElement.style.pointerAction===""&&n.documentElement.style.touchAction===""?r.addEventListener("pointerup",function($){o.clickHandlerFunc($,o.clickHandlerArgs)},!1):r.addEventListener("touchend",function($){o.clickHandlerFunc($,o.clickHandlerArgs)},!1),r.className+=" pnlm-pointer",c.className+=" pnlm-pointer"),o.draggable&&(r.addEventListener("mousedown",function($){o.dragHandlerFunc&&o.dragHandlerFunc($,o.dragHandlerArgs),dt=o}),n.documentElement.style.pointerAction===""&&n.documentElement.style.touchAction===""&&r.addEventListener("pointerdown",function($){o.dragHandlerFunc&&o.dragHandlerFunc($,o.dragHandlerArgs),dt=o}),r.addEventListener("touchmove",function($){yt(o,$.targetTouches[0])}),r.addEventListener("touchend",function($){o.dragHandlerFunc&&o.dragHandlerFunc($,o.dragHandlerArgs),dt=null})),o.div=r}function yt(o,r){var c=h(r);o.pitch=c[0],o.yaw=c[1],Tt(o)}function $t(){ze||(e.hotSpots?(e.hotSpots=e.hotSpots.sort(function(o,r){return o.pitch<r.pitch}),e.hotSpots.forEach(Gt)):e.hotSpots=[],ze=!0,Et())}function L(){var o=e.hotSpots;if(ze=!1,delete e.hotSpots,o)for(var r=0;r<o.length;r++){var c=o[r].div;if(c){for(;c.parentNode&&c.parentNode!=nt;)c=c.parentNode;nt.removeChild(c)}delete o[r].div}}function Tt(o){var r=Math.sin(o.pitch*Math.PI/180),c=Math.cos(o.pitch*Math.PI/180),M=Math.sin(e.pitch*Math.PI/180),y=Math.cos(e.pitch*Math.PI/180),E=Math.cos((-o.yaw+e.yaw)*Math.PI/180),j=r*M+c*E*y;if(o.yaw<=90&&o.yaw>-90&&j<=0||(o.yaw>90||o.yaw<=-90)&&j<=0)o.div.style.visibility="hidden";else{var O=Math.sin((-o.yaw+e.yaw)*Math.PI/180),N=Math.tan(e.hfov*Math.PI/360);o.div.style.visibility="visible";var $=lt.getCanvas(),at=$.clientWidth,Bt=$.clientHeight,Rt=[-at/N*O*c/j/2,-at/N*(r*y-c*E*M)/j/2],ne=Math.sin(e.roll*Math.PI/180),qi=Math.cos(e.roll*Math.PI/180);Rt=[Rt[0]*qi-Rt[1]*ne,Rt[0]*ne+Rt[1]*qi],Rt[0]+=(at-o.div.offsetWidth)/2,Rt[1]+=(Bt-o.div.offsetHeight)/2;var Qe="translate("+Rt[0]+"px, "+Rt[1]+"px) translateZ(9999px) rotate("+e.roll+"deg)";o.scale&&(Qe+=" scale("+fe/e.hfov/j+")"),o.div.style.webkitTransform=Qe,o.div.style.MozTransform=Qe,o.div.style.transform=Qe}}function Et(){e.hotSpots.forEach(Tt)}function Y(o){e={};var r,c,M=["haov","vaov","vOffset","northOffset","horizonPitch","horizonRoll"];Pt=[];for(r in ke)ke.hasOwnProperty(r)&&(e[r]=ke[r]);for(r in _.default)if(_.default.hasOwnProperty(r))if(r=="strings")for(c in _.default.strings)_.default.strings.hasOwnProperty(c)&&(e.strings[c]=Se(_.default.strings[c]));else e[r]=_.default[r],M.indexOf(r)>=0&&Pt.push(r);if(o!==null&&o!==""&&_.scenes&&_.scenes[o]){var y=_.scenes[o];for(r in y)if(y.hasOwnProperty(r))if(r=="strings")for(c in y.strings)y.strings.hasOwnProperty(c)&&(e.strings[c]=Se(y.strings[c]));else e[r]=y[r],M.indexOf(r)>=0&&Pt.push(r);e.scene=o}for(r in _)if(_.hasOwnProperty(r))if(r=="strings")for(c in _.strings)_.strings.hasOwnProperty(c)&&(e.strings[c]=Se(_.strings[c]));else e[r]=_[r],M.indexOf(r)>=0&&Pt.push(r)}function z(o){if(o=o||!1,o&&"preview"in e){var r=e.preview;e.basePath&&!Fe(r)&&(r=e.basePath+r),ve=n.createElement("div"),ve.className="pnlm-preview-img",ve.style.backgroundImage="url('"+on(r)+"')",se.appendChild(ve)}var c=e.title,M=e.author;o&&("previewTitle"in e&&(e.title=e.previewTitle),"previewAuthor"in e&&(e.author=e.previewAuthor)),e.hasOwnProperty("title")||(S.title.innerHTML=""),e.hasOwnProperty("author")||(S.author.innerHTML=""),!e.hasOwnProperty("title")&&!e.hasOwnProperty("author")&&(S.container.style.display="none"),e.targetBlank&&(Ve.rel="noopener",Ve.target="_blank"),q.load.innerHTML="<div><p>"+e.strings.loadButtonLabel+"</p></div>",S.load.boxp.innerHTML=e.strings.loadingLabel;for(var y in e)if(e.hasOwnProperty(y))switch(y){case"title":S.title.innerHTML=Se(e[y]),S.container.style.display="inline";break;case"author":var E=Se(e[y]);if(e.authorURL){var j=n.createElement("a");j.href=Ne(e.authorURL,!0),e.targetBlank&&(j.target="_blank",j.rel="noopener"),j.innerHTML=Se(e[y]),E=j.outerHTML}S.author.innerHTML=e.strings.bylineLabel.replace("%s",E),S.container.style.display="inline";break;case"hfov":ie(Number(e[y]));break;case"autoLoad":e[y]===!0&&lt===t&&(S.load.box.style.display="inline",q.load.style.display="none",Xe());break;case"showZoomCtrl":e[y]&&e.showControls!=!1?q.zoom.style.display="block":q.zoom.style.display="none";break;case"showFullscreenCtrl":e[y]&&e.showControls!=!1&&("fullscreen"in n||"mozFullScreen"in n||"webkitIsFullScreen"in n||"msFullscreenElement"in n)?q.fullscreen.style.display="block":q.fullscreen.style.display="none";break;case"hotSpotDebug":e[y]?He.style.display="block":He.style.display="none";break;case"showControls":e[y]||(q.orientation.style.display="none",q.zoom.style.display="none",q.fullscreen.style.display="none");break;case"orientationOnByDefault":e[y]&&Ni();break}o&&(c?e.title=c:delete e.title,M?e.author=M:delete e.author)}function R(){if(pt&&!zt)if(St)n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitCancelFullScreen?n.webkitCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen();else try{s.requestFullscreen?s.requestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen?s.msRequestFullscreen():s.webkitRequestFullScreen()}catch{}}function Lt(o){n.fullscreenElement||n.fullscreen||n.mozFullScreen||n.webkitIsFullScreen||n.msFullscreenElement?(q.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),St=!0):(q.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),St=!1),o!=="resize"&&Jt("fullscreenchange",St),lt.resize(),ie(e.hfov),C()}function Ft(){pt&&(ie(e.hfov-5),C())}function en(){pt&&(ie(e.hfov+5),C())}function Yi(o){var r=e.minHfov;if(e.type=="multires"&&lt&&!e.multiResMinHfov&&(r=Math.min(r,lt.getCanvas().width/(e.multiRes.cubeResolution/90*.9))),r>e.maxHfov)return console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),e.hfov;var c=e.hfov;if(o<r?c=r:o>e.maxHfov?c=e.maxHfov:c=o,e.avoidShowingBackground&&lt&&!isNaN(e.maxPitch-e.minPitch)){var M=lt.getCanvas();c=Math.min(c,Math.atan(Math.tan((e.maxPitch-e.minPitch)/360*Math.PI)/M.height*M.width)*360/Math.PI)}return c}function ie(o){e.hfov=Yi(o),Jt("zoomchange",e.hfov)}function $e(){kt={},te=e.autoRotate?e.autoRotate:te,e.autoRotate=!1}function zi(){Be(),pt=!1,_e(),q.load.style.display="none",S.load.box.style.display="inline",Xe()}function Je(o,r,c,M,y){pt||(y=!0),pt=!1,kt={};var E,j,O,N;if(e.sceneFadeDuration&&!y){var $=lt.render(e.pitch*Math.PI/180,e.yaw*Math.PI/180,e.hfov*Math.PI/180,{returnImage:"ImageBitmap"});if($!==t){$.then?E=n.createElement("canvas"):E=new Image,E.className="pnlm-fade-img",E.style.transition="opacity "+e.sceneFadeDuration/1e3+"s",E.style.width="100%",E.style.height="100%",$.then?$.then(function(at){E.width=at.width,E.height=at.height,E.getContext("2d").drawImage(at,0,0),Je(o,r,c,M,!0)}):(E.onload=function(){Je(o,r,c,M,!0)},E.src=$),se.appendChild(E),lt.fadeImg=E;return}}r==="same"?j=e.pitch:j=r,c==="same"?O=e.yaw:c==="sameAzimuth"?O=e.yaw+(e.northOffset||0)-(_.scenes[o].northOffset||0):O=c,M==="same"?N=e.hfov:N=M,L(),Y(o),W.yaw=W.pitch=W.hfov=0,z(),j!==t&&(e.pitch=j),O!==t&&(e.yaw=O),N!==t&&(e.hfov=N),Jt("scenechange",o),zi()}function Ke(){i.removeEventListener("deviceorientation",ce),q.orientation.classList.remove("pnlm-orientation-button-active"),Ot=!1}function Ni(){be&&(typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(o){o=="granted"&&(Ot=1,i.addEventListener("deviceorientation",ce),q.orientation.classList.add("pnlm-orientation-button-active"))}):(Ot=1,i.addEventListener("deviceorientation",ce),q.orientation.classList.add("pnlm-orientation-button-active")))}function Se(o){return _.escapeHTML?String(o).split(/&/g).join("&amp;").split('"').join("&quot;").split("'").join("&#39;").split("<").join("&lt;").split(">").join("&gt;").split("/").join("&#x2f;").split(`
`).join("<br>"):String(o).split(`
`).join("<br>")}function Ne(o,r){try{var c=decodeURIComponent(nn(o)).replace(/[^\w:]/g,"").toLowerCase()}catch{return"about:blank"}return c.indexOf("javascript:")===0||c.indexOf("vbscript:")===0?(console.log("Script URL removed."),"about:blank"):r&&c.indexOf("data:")===0?(console.log("Data URI removed from link."),"about:blank"):o}function nn(o){return o.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,function(r,c){return c=c.toLowerCase(),c==="colon"?":":c.charAt(0)==="#"?c.charAt(1)==="x"?String.fromCharCode(parseInt(c.substring(2),16)):String.fromCharCode(+c.substring(1)):""})}function on(o){return Ne(o).replace(/"/g,"%22").replace(/'/g,"%27")}this.isLoaded=function(){return!!pt},this.getPitch=function(){return e.pitch},this.setPitch=function(o,r,c,M){return K=Date.now(),Math.abs(o-e.pitch)<=ye?(typeof c=="function"&&c(M),this):(r=r==t?1e3:Number(r),r?(kt.pitch={startTime:Date.now(),startPosition:e.pitch,endPosition:o,duration:r},typeof c=="function"&&setTimeout(function(){c(M)},r)):e.pitch=o,C(),this)},this.getPitchBounds=function(){return[e.minPitch,e.maxPitch]},this.setPitchBounds=function(o){return e.minPitch=Math.max(-90,Math.min(o[0],90)),e.maxPitch=Math.max(-90,Math.min(o[1],90)),this},this.getYaw=function(){return(e.yaw+540)%360-180},this.setYaw=function(o,r,c,M){return K=Date.now(),Math.abs(o-e.yaw)<=ye?(typeof c=="function"&&c(M),this):(r=r==t?1e3:Number(r),o=(o+180)%360-180,r?(e.yaw-o>180?o+=360:o-e.yaw>180&&(o-=360),kt.yaw={startTime:Date.now(),startPosition:e.yaw,endPosition:o,duration:r},typeof c=="function"&&setTimeout(function(){c(M)},r)):e.yaw=o,C(),this)},this.getYawBounds=function(){return[e.minYaw,e.maxYaw]},this.setYawBounds=function(o){return e.minYaw=Math.max(-360,Math.min(o[0],360)),e.maxYaw=Math.max(-360,Math.min(o[1],360)),this},this.getHfov=function(){return e.hfov},this.setHfov=function(o,r,c,M){return K=Date.now(),Math.abs(o-e.hfov)<=ye?(typeof c=="function"&&c(M),this):(r=r==t?1e3:Number(r),r?(kt.hfov={startTime:Date.now(),startPosition:e.hfov,endPosition:Yi(o),duration:r},typeof c=="function"&&setTimeout(function(){c(M)},r)):ie(o),C(),this)},this.getHfovBounds=function(){return[e.minHfov,e.maxHfov]},this.setHfovBounds=function(o){return e.minHfov=Math.max(0,o[0]),e.maxHfov=Math.max(0,o[1]),this},this.lookAt=function(o,r,c,M,y,E){return M=M==t?1e3:Number(M),o!==t&&Math.abs(o-e.pitch)>ye&&(this.setPitch(o,M,y,E),y=t),r!==t&&Math.abs(r-e.yaw)>ye&&(this.setYaw(r,M,y,E),y=t),c!==t&&Math.abs(c-e.hfov)>ye&&(this.setHfov(c,M,y,E),y=t),typeof y=="function"&&y(E),this},this.getNorthOffset=function(){return e.northOffset},this.setNorthOffset=function(o){return e.northOffset=Math.min(360,Math.max(0,o)),C(),this},this.getHorizonRoll=function(){return e.horizonRoll},this.setHorizonRoll=function(o){return e.horizonRoll=Math.min(90,Math.max(-90,o)),lt.setPose(e.horizonPitch*Math.PI/180,e.horizonRoll*Math.PI/180),C(),this},this.getHorizonPitch=function(){return e.horizonPitch},this.setHorizonPitch=function(o){return e.horizonPitch=Math.min(90,Math.max(-90,o)),lt.setPose(e.horizonPitch*Math.PI/180,e.horizonRoll*Math.PI/180),C(),this},this.startAutoRotate=function(o,r,c,M){return o=o||te||1,r=r===t?Ae:r,c=c===t?fe:c,e.autoRotate=o,M!==t&&(e.autoRotateInactivityDelay=M),bt.lookAt(r,t,c,3e3),C(),this},this.stopAutoRotate=function(){return te=e.autoRotate?e.autoRotate:te,e.autoRotate=!1,e.autoRotateInactivityDelay=-1,this},this.stopMovement=function(){$e(),W={yaw:0,pitch:0,hfov:0}},this.getRenderer=function(){return lt},this.setUpdate=function(o){return le=o===!0,le&&(Re=!1,lt===t?he():C()),this},this.updateOnce=function(){return le=Re=!0,lt===t?he():C(),this},this.mouseEventToCoords=function(o){return h(o)},this.loadScene=function(o,r,c,M){return pt!==!1&&Je(o,r,c,M),this},this.getScene=function(){return e.scene},this.addScene=function(o,r){return _.scenes[o]=r,this},this.removeScene=function(o){return e.scene==o||!_.scenes.hasOwnProperty(o)?!1:(delete _.scenes[o],!0)},this.toggleFullscreen=function(){return R(),this},this.getConfig=function(){return e},this.getContainer=function(){return s},this.addHotSpot=function(o,r){if(r===t&&e.scene===t)e.hotSpots.push(o);else{var c=r!==t?r:e.scene;if(_.scenes.hasOwnProperty(c))_.scenes[c].hasOwnProperty("hotSpots")||(_.scenes[c].hotSpots=[],c==e.scene&&(e.hotSpots=_.scenes[c].hotSpots)),_.scenes[c].hotSpots.push(o);else throw"Invalid scene ID!"}return(r===t||e.scene==r)&&(Gt(o),pt&&Tt(o)),this},this.removeHotSpot=function(o,r){if(r===t||e.scene==r){if(!e.hotSpots)return!1;for(var c=0;c<e.hotSpots.length;c++)if(e.hotSpots[c].hasOwnProperty("id")&&e.hotSpots[c].id==o){for(var M=e.hotSpots[c].div;M.parentNode!=nt;)M=M.parentNode;return nt.removeChild(M),delete e.hotSpots[c].div,e.hotSpots.splice(c,1),!0}}else if(_.scenes.hasOwnProperty(r)){if(!_.scenes[r].hasOwnProperty("hotSpots"))return!1;for(var y=0;y<_.scenes[r].hotSpots.length;y++)if(_.scenes[r].hotSpots[y].hasOwnProperty("id")&&_.scenes[r].hotSpots[y].id==o)return _.scenes[r].hotSpots.splice(y,1),!0}else return!1},this.resize=function(){lt&&ot()},this.isOrientationSupported=function(){return be||!1},this.stopOrientation=function(){Ke()},this.startOrientation=function(){Ni()},this.isOrientationActive=function(){return!!Ot},this.on=function(o,r){return qt[o]=qt[o]||[],qt[o].push(r),this},this.off=function(o,r){if(!o)return qt={},this;if(r){var c=qt[o].indexOf(r);c>=0&&qt[o].splice(c,1),qt[o].length==0&&delete qt[o]}else delete qt[o];return this};function Jt(o){if(o in qt)for(var r=qt[o].length;r>0;r--)qt[o][qt[o].length-r].apply(null,[].slice.call(arguments,1))}this.destroy=function(){if(qe=!0,clearTimeout(pe),Xt&&Xt.abort(),Array.isArray(v))for(var o=0;o<6;o++)v[o].src="";lt&&lt.destroy(),re&&(n.removeEventListener("mousemove",b,!1),n.removeEventListener("mouseup",I,!1),s.removeEventListener("mozfullscreenchange",Lt,!1),s.removeEventListener("webkitfullscreenchange",Lt,!1),s.removeEventListener("msfullscreenchange",Lt,!1),s.removeEventListener("fullscreenchange",Lt,!1),Te?Te.disconnect():(i.removeEventListener("resize",ot,!1),i.removeEventListener("orientationchange",ot,!1)),s.removeEventListener("keydown",xe,!1),s.removeEventListener("keyup",ft,!1),s.removeEventListener("blur",Mt,!1),n.removeEventListener("mouseleave",I,!1)),s.innerHTML="",s.classList.remove("pnlm-container")}}return{viewer:function(s,_){return new l(s,_)}}})(window,document);var Mn=["container"];function yn(i,n){if(i&1){let t=Z();u(0,"button",9),tt("click",function(){V(t);let s=f();return H(s.onActionShowView360Add())}),w(1),et(2,"translate"),m()}i&2&&(p(),mt(" ",it(2,1,"ACTION.Add_To_List")," "))}function Tn(i,n){if(i&1){let t=Z();u(0,"mat-icon",49),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.title="")}),w(1,"close"),m()}}function bn(i,n){if(i&1){let t=Z();u(0,"mat-icon",49),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.description="")}),w(1,"close"),m()}}function En(i,n){if(i&1){let t=Z();u(0,"mat-icon",50),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.linkFileId=null)}),w(1,"close"),m()}}function Sn(i,n){if(i&1&&(wt(0,"img",24),et(1,"cmsthumbnail")),i&2){let t=f(2);B("src",Wt(it(1,2,t.dataDetailModel.panorama)),we)}}function In(i,n){if(i&1&&(u(0,"table",25)(1,"tr")(2,"td"),w(3,"viewer Yaw"),m(),u(4,"td"),w(5,"viewer Pitch"),m(),u(6,"td"),w(7,"click Yaw"),m(),u(8,"td"),w(9,"click Pitch"),m()(),u(10,"tr")(11,"td"),w(12),m(),u(13,"td"),w(14),m(),u(15,"td"),w(16),m(),u(17,"td"),w(18),m()()()),i&2){let t=f(2);p(12),ht(t.postionView.viewerGetYaw),p(2),ht(t.postionView.viewerGetPitch),p(2),ht(t.postionView.clickGetYaw),p(2),ht(t.postionView.clickGetPitch)}}function Ln(i,n){if(i&1){let t=Z();u(0,"button",51),tt("click",function(){V(t);let s=f(2);return H(s.onActionShowHotspotAdd())}),w(1),et(2,"translate"),m()}i&2&&(p(),mt(" ",it(2,1,"ACTION.ADD")," "))}function Dn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0634\u0646\u0627\u0633\u0647 \u0635\u062D\u0646\u0647"),m())}function Pn(i,n){if(i&1&&(u(0,"p",52),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.sceneId||"N/A")}}function An(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",53),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.sceneId,s)||(_.sceneId=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.sceneId)}}function Rn(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Pn,2,1,"p",52),P(2,An,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function kn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"pitch"),m())}function Vn(i,n){if(i&1&&(u(0,"p",52),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.pitch||"N/A")}}function Hn(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",54),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.pitch,s)||(_.pitch=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.pitch)}}function Fn(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Vn,2,1,"p",52),P(2,Hn,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Bn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"yaw"),m())}function On(i,n){if(i&1&&(u(0,"p",55),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.yaw||"N/A"," ")}}function Nn(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",56),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.yaw,s)||(_.yaw=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.yaw)}}function Un(i,n){if(i&1&&(u(0,"mat-cell"),P(1,On,2,1,"p",55),P(2,Nn,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Gn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0646\u0648\u0639"),m())}function Wn(i,n){if(i&1&&(u(0,"p",55),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.type)}}function Yn(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"mat-select",57),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.type,s)||(_.type=s),H(s)}),u(2,"mat-option",58),w(3,"\u0627\u0637\u0644\u0627\u0639\u0627\u062A"),m()()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.type),p(),B("value","info")}}function zn(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Wn,2,1,"p",55),P(2,Yn,4,3,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function qn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"targetYaw"),m())}function Xn(i,n){if(i&1&&(u(0,"p",55),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.targetYaw||"N/A"," ")}}function $n(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",59),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.targetYaw,s)||(_.targetYaw=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.targetYaw)}}function Kn(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Xn,2,1,"p",55),P(2,$n,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function jn(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"targetPitch"),m())}function Zn(i,n){if(i&1&&(u(0,"p",55),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.targetPitch||"N/A"," ")}}function Jn(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",60),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.targetPitch,s)||(_.targetPitch=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.targetPitch)}}function Qn(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Zn,2,1,"p",55),P(2,Jn,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function to(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A"),m())}function eo(i,n){if(i&1&&(u(0,"p",52),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.text||"N/A")}}function io(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",61),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.text,s)||(_.text=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.text)}}function no(i,n){if(i&1&&(u(0,"mat-cell"),P(1,eo,2,1,"p",52),P(2,io,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function oo(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0622\u062F\u0631\u0633 \u0648\u0628 \u0633\u0627\u06CC\u062A"),m())}function ao(i,n){if(i&1&&(u(0,"p",62),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.url||"N/A")}}function ro(i,n){if(i&1){let t=Z();u(0,"div",11)(1,"input",63),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.url,s)||(_.url=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.url)}}function lo(i,n){if(i&1&&(u(0,"mat-cell"),P(1,ao,2,1,"p",62),P(2,ro,2,2,"div",11),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function so(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"Action"),m())}function co(i,n){if(i&1){let t=Z();u(0,"mat-icon",65),tt("click",function(){V(t);let s=f().$implicit,_=f(2);return H(_.editROw(s))}),w(1,"edit"),m(),u(2,"mat-icon",65),tt("click",function(){V(t);let s=f().$implicit,_=f(2);return H(_.removeROw(s))}),w(3,"delete"),m()}}function uo(i,n){if(i&1){let t=Z();u(0,"button",69),tt("click",function(){V(t);let s=f(4);return H(s.updateEdit())}),w(1),et(2,"translate"),m()}if(i&2){let t=f(4);B("disabled",t.editdisabled||!t.editHotspot.text||t.editHotspot.text.length===0),p(),mt(" ",it(2,2,"ACTION.Update")," ")}}function mo(i,n){if(i&1){let t=Z();u(0,"button",70),tt("click",function(){V(t);let s=f(4);return H(s.onActionPannellumClickLastPoint())}),w(1," \u0646\u0642\u0637\u0647 "),m()}if(i&2){let t=f(4);B("disabled",t.editdisabled)}}function po(i,n){if(i&1){let t=Z();P(0,uo,3,4,"button",66),u(1,"button",67),tt("click",function(){V(t);let s=f(3);return H(s.cancelEdit())}),w(2),et(3,"translate"),m(),P(4,mo,2,1,"button",68)}if(i&2){let t=f(3);A(t.postionView?0:-1),p(),B("disabled",t.editdisabled),p(),mt(" ",it(3,4,"ACTION.CANCEL")," "),p(2),A(t.editHotspot.pitch!==(t.postionView==null?null:t.postionView.clickGetPitch)&&t.editHotspot.yaw!==(t.postionView==null?null:t.postionView.clickGetYaw)?4:-1)}}function fo(i,n){if(i&1&&(u(0,"mat-cell")(1,"span",64),P(2,co,4,0),P(3,po,5,6),m()()),i&2){let t=n.$implicit,l=f(2);p(2),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?2:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?3:-1)}}function ho(i,n){i&1&&wt(0,"mat-header-row")}function _o(i,n){if(i&1&&wt(0,"mat-row"),i&2){let t=n.dataIndex;Ge("ntk-row-odd",t%2)("ntk-row-even",!(t%2))}}function go(i,n){if(i&1){let t=Z();u(0,"mat-icon",49),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.configDataJson="")}),w(1,"close"),m()}}function Co(i,n){if(i&1){let t=Z();u(0,"div",7)(1,"div",10)(2,"div",11)(3,"label",12),w(4),et(5,"translate"),m(),u(6,"input",13,1),et(8,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.title,s)||(_.dataDetailModel.title=s),H(s)}),m(),P(9,Tn,2,0,"mat-icon",14),u(10,"mat-icon",15),w(11,"mode_edit"),m()(),u(12,"div",11)(13,"label",16),w(14),et(15,"translate"),m(),u(16,"input",17,2),et(18,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.description,s)||(_.dataDetailModel.description=s),H(s)}),m(),P(19,bn,2,0,"mat-icon",14),u(20,"mat-icon",15),w(21,"mode_edit"),m()(),u(22,"div",11)(23,"label",18),w(24),et(25,"translate"),m(),u(26,"input",19,3),et(28,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.linkFileId,s)||(_.dataDetailModel.linkFileId=s),H(s)}),tt("click",function(){V(t);let s=f();return H(s.fileManagerOpenFormReport=!0)}),m(),P(29,En,2,0,"mat-icon",20),u(30,"mat-icon",21),tt("click",function(){V(t);let s=f();return H(s.fileManagerOpenFormReport=!0)}),w(31,"mode_edit"),m()(),u(32,"cms-file-manager",22),tt("itemSelected",function(s){V(t);let _=f();return H(_.onActionFileSelect(s))}),xt("openFormChange",function(s){V(t);let _=f();return Ct(_.fileManagerOpenFormReport,s)||(_.fileManagerOpenFormReport=s),H(s)}),m(),u(33,"a",23),et(34,"cmsthumbnail"),P(35,Sn,2,4,"img",24),m(),wt(36,"hr"),P(37,In,19,4,"table",25),wt(38,"hr"),u(39,"h5"),w(40,"\u062A\u0646\u0638\u06CC\u0645\u0627\u062A"),m(),u(41,"p"),w(42,"\u062F\u0631 \u0648\u0631\u0648\u062F \u0627\u06CC\u0646 \u062A\u0646\u0638\u06CC\u0645\u0627\u062A \u0628\u0627 \u0645\u062F\u06CC\u0631\u06CC\u062A \u0633\u0627\u0645\u0627\u0646\u0647 \u0647\u0645\u0627\u0647\u0646\u06AF \u0628\u0627\u0634\u06CC\u062F"),m(),u(43,"div",26)(44,"div",27),P(45,Ln,3,3,"button",28),m(),u(46,"mat-table",29,4),ct(48,30),st(49,Dn,2,0,"mat-header-cell",31)(50,Rn,3,2,"mat-cell",32),ut(),ct(51,33),st(52,kn,2,0,"mat-header-cell",31)(53,Fn,3,2,"mat-cell",32),ut(),ct(54,34),st(55,Bn,2,0,"mat-header-cell",31)(56,Un,3,2,"mat-cell",32),ut(),ct(57,35),st(58,Gn,2,0,"mat-header-cell",31)(59,zn,3,2,"mat-cell",32),ut(),ct(60,36),st(61,qn,2,0,"mat-header-cell",31)(62,Kn,3,2,"mat-cell",32),ut(),ct(63,37),st(64,jn,2,0,"mat-header-cell",31)(65,Qn,3,2,"mat-cell",32),ut(),ct(66,38),st(67,to,2,0,"mat-header-cell",31)(68,no,3,2,"mat-cell",32),ut(),ct(69,39),st(70,oo,2,0,"mat-header-cell",31)(71,lo,3,2,"mat-cell",32),ut(),ct(72,40),st(73,so,2,0,"mat-header-cell",31)(74,fo,4,2,"mat-cell",32),ut(),st(75,ho,1,0,"mat-header-row",41)(76,_o,1,4,"mat-row",42),m()(),u(77,"div",43)(78,"label",44),w(79),et(80,"translate"),m(),u(81,"input",45,2),et(83,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.configDataJson,s)||(_.dataDetailModel.configDataJson=s),H(s)}),m(),P(84,go,2,0,"mat-icon",14),u(85,"mat-icon",15),w(86,"mode_edit"),m()(),u(87,"div",27)(88,"button",9),tt("click",function(){V(t);let s=f();return H(s.onActionSubmitView360())}),wt(89,"i",46),w(90),et(91,"translate"),m(),u(92,"button",47),tt("click",function(){V(t);let s=f();return H(s.onActionCancellView360())}),wt(93,"i",48),w(94),et(95,"translate"),m()(),wt(96,"br"),m()()}if(i&2){let t=f();p(4),ht(it(5,39,"TITLE.Photography_Place")),p(2),B("placeholder",Wt(it(8,41,"TITLE.Photography_Place"))),gt("ngModel",t.dataDetailModel.title),p(3),A(t.dataDetailModel.title?9:-1),p(5),ht(it(15,43,"TITLE.DESCRIPTION")),p(2),B("placeholder",Wt(it(18,45,"TITLE.DESCRIPTION"))),gt("ngModel",t.dataDetailModel.description),p(3),A(t.dataDetailModel.description?19:-1),p(5),ht(it(25,47,"TITLE.View_360_File_ID")),p(2),B("placeholder",Wt(it(28,49,"TITLE.View_360_File_ID"))),gt("ngModel",t.dataDetailModel.linkFileId),p(3),A(t.dataDetailModel.linkFileId?29:-1),p(3),B("language",t.appLanguage)("isPopup",!0),gt("openForm",t.fileManagerOpenFormReport),B("tree",t.fileManagerTree)("openDirectUploadView",!0)("openFilemanagerButtonLabelKey","select")("selectFileType",t.selectFileTypeReport)("openFilemanagerButtonView",!1),p(),B("href",Wt(it(34,51,t.dataDetailModel.panorama)),we),p(2),A((t.dataDetailModel==null||t.dataDetailModel.panorama==null?null:t.dataDetailModel.panorama.length)>0?35:-1),p(2),A(t.postionView?37:-1),p(8),A(t.postionView?45:-1),p(),B("dataSource",t.tableHotSpotdataSource),p(29),B("matHeaderRowDef",t.tableHotspotDisplayedColumns)("matHeaderRowDefSticky",!0),p(),B("matRowDefColumns",t.tableHotspotDisplayedColumns),p(3),ht(it(80,53,"TITLE.configDataJson")),p(2),B("placeholder",Wt(it(83,55,"TITLE.configDataJson"))),gt("ngModel",t.dataDetailModel.configDataJson),p(3),A(t.dataDetailModel.configDataJson?84:-1),p(6),mt(" ",it(91,57,"ACTION.SUBMIT_BUTTON")," "),p(4),mt(" ",it(95,59,"ACTION.CANCEL")," ")}}function xo(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),m()),i&2&&(p(),mt(" ",it(2,1,"TITLE.PHOTO")," "))}function wo(i,n){if(i&1&&wt(0,"img",24),i&2){let t=f(2).$implicit;B("src",Wt(t.panorama),we)}}function vo(i,n){if(i&1&&(u(0,"a",23),P(1,wo,1,2,"img",24),m()),i&2){let t=f().$implicit;B("href",Wt(t.panorama),we),p(),A((t==null||t.panorama==null?null:t.panorama.length)>0?1:-1)}}function Mo(i,n){if(i&1&&(u(0,"mat-cell"),P(1,vo,2,3,"a",23),m()),i&2){let t=n.$implicit;p(),A(t.panorama?1:-1)}}function yo(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),m()),i&2&&(p(),mt(" ",it(2,1,"TITLE.Photography_Place")," "))}function To(i,n){if(i&1&&w(0),i&2){let t=f().$implicit;mt(" ",t.title," ")}}function bo(i,n){if(i&1&&(u(0,"mat-cell"),P(1,To,1,1),m()),i&2){let t=n.$implicit;p(),A(t.title?1:-1)}}function Eo(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),m()),i&2&&(p(),mt(" ",it(2,1,"TITLE.DESCRIPTION")," "))}function So(i,n){if(i&1&&w(0),i&2){let t=f().$implicit;mt(" ",t.description," ")}}function Io(i,n){if(i&1&&(u(0,"mat-cell"),P(1,So,1,1),m()),i&2){let t=n.$implicit;p(),A(t.description?1:-1)}}function Lo(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),et(3,"translate"),m()),i&2&&(p(),ai(" ",it(2,2,"TITLE.Edit")," | ",it(3,4,"TITLE.Delete")," "))}function Do(i,n){if(i&1){let t=Z();u(0,"mat-cell",78)(1,"small")(2,"mat-icon",79),tt("click",function(){let s=V(t).renderIndex,_=f(2);return H(_.onActionOptionEditView360(s))}),w(3,"edit"),m()(),w(4,"| "),u(5,"small")(6,"mat-icon",80),tt("click",function(){let s=V(t).renderIndex,_=f(2);return H(_.onActionOptionRemoveView360(s))}),w(7,"delete"),m()()()}}function Po(i,n){i&1&&wt(0,"mat-header-row")}function Ao(i,n){if(i&1&&wt(0,"mat-row",81),i&2){let t=n.dataIndex;Ge("ntk-row-odd",t%2)("ntk-row-even",!(t%2))}}function Ro(i,n){if(i&1&&(u(0,"div",7)(1,"mat-table",71),ct(2,72),st(3,xo,3,3,"mat-header-cell",31)(4,Mo,2,1,"mat-cell",32),ut(),ct(5,73),st(6,yo,3,3,"mat-header-cell",31)(7,bo,2,1,"mat-cell",32),ut(),ct(8,74),st(9,Eo,3,3,"mat-header-cell",31)(10,Io,2,1,"mat-cell",32),ut(),ct(11,40),st(12,Lo,4,6,"mat-header-cell",31)(13,Do,8,0,"mat-cell",75),ut(),st(14,Po,1,0,"mat-header-row",76)(15,Ao,1,4,"mat-row",77),m()()),i&2){let t=f();p(),B("dataSource",t.tabledataSource),p(13),B("matHeaderRowDef",t.tabledisplayedColumns),p(),B("matRowDefColumns",t.tabledisplayedColumns)}}var Gi=class{},Le=class Le{constructor(n,t,l){this.cmsToastrService=n;this.publicHelper=t;this.translate=l;this.id=++Le.nextId;this.privateDataModel=[];this.dataDetailModel=new ri;this.dataModelChange=new ti;this.formInfo=new Fi;this.tabledataSource=new We;this.tableHotSpotdataSource=new We;this.tabledisplayedColumns=["panorama","title","Description","Action"];this.tableHotspotDisplayedColumns=["type","text","url","pitch","yaw","Action"];this.selectFileTypeReport=["jpeg","jpg"];this.appLanguage="fa";this.showAddView360=!1;this.fileManagerOpenFormReport=!1;this.inAddhotspotGuid="";this.selectIndex=-1;this.fileManagerTree=this.publicHelper.GetfileManagerTreeConfig()}set dataModel(n){n||(n=[]),this.privateDataModel=n,this.privateDataModel.forEach(t=>{t.hotSpots||(t.hotSpots=[]),t.hotSpots=this.uniqByReduce(t.hotSpots),t.hotSpots.forEach(l=>{l.guid=this.getGuid()})}),this.tabledataSource.data=this.privateDataModel,this.tableHotSpotdataSource.data=[]}get dataModel(){return this.privateDataModel}uniqByReduce(n){let t=[];return n.forEach(l=>{!t.includes(l)&&t.filter(s=>s.pitch==l.pitch&&s.yaw==l.yaw).length==0&&t.push(l)}),t}ngOnInit(){this.translate.get("TITLE.Edit").subscribe(n=>{this.formInfo.formTitle=n})}ngAfterViewInit(){this.container.nativeElement.style.display="none"}getGuid(){return Math.floor(Math.random()*new Date().getTime()).toString()}actionPannellumImageLoad(n,t){let l={type:"equirectangular",panorama:n,autoLoad:!0,autoRotate:1.5,crossOrigin:"anonymous"};t&&t.length>0&&(l.hotSpots=t);let s=Object.assign({},l,this.options);this.viewer&&this.onActionPannellumDestroy(),this.viewer=pannellum.viewer(this.container.nativeElement,s),this.container.nativeElement.style.display="block"}actionPrivateDataModelOptimaze(){let n=[];this.privateDataModel||(this.privateDataModel=[]),this.privateDataModel.forEach(t=>{t.hotSpots||(t.hotSpots=[]),t.hotSpots.forEach(l=>{l.type&&l.type.length>0&&n.push(l)}),t.hotSpots=this.uniqByReduce(n)})}onActionPannellumClick(n){if(!this.viewer)return;this.postionView=new Gi,this.postionView.viewerGetYaw=this.viewer.getYaw(),this.postionView.viewerGetPitch=this.viewer.getPitch();let t=this.viewer.mouseEventToCoords(n);!t||t.length==0||(this.postionView.clickGetYaw=t[1],this.postionView.clickGetPitch=t[0])}onActionPannellumDestroy(){this.container.nativeElement.style.display="none",this.postionView=null,this.viewer&&this.viewer.destroy()}onActionPannellumClickLastPoint(){this.postionView&&(this.postionView.clickGetYaw!=0||this.postionView.clickGetPitch!=0)&&(this.editHotspot.yaw=this.postionView.clickGetYaw,this.editHotspot.pitch=this.postionView.clickGetPitch)}onActionFileSelect(n){if(!(n?.id>0)){this.cmsToastrService.typeErrorSelectedRow();return}this.dataDetailModel.linkFileId=n.id,this.dataDetailModel.panorama=n.downloadLinksrc,this.dataDetailModel.preview=n.downloadLinksrc,this.actionPannellumImageLoad(this.dataDetailModel.panorama,[])}onActionSubmitView360(){(!this.dataDetailModel.linkFileId||this.dataDetailModel.linkFileId<=0)&&this.cmsToastrService.typeErrorMessage("\u0641\u0627\u06CC\u0644 \u0627\u0646\u062A\u062E\u0627\u0628 \u0646\u0634\u062F\u0647"),this.privateDataModel||(this.privateDataModel=[]),this.selectIndex>=0?this.privateDataModel[this.selectIndex]=this.dataDetailModel:this.privateDataModel.push(this.dataDetailModel),this.actionPrivateDataModelOptimaze(),this.dataModel=this.privateDataModel,this.dataModelChange.emit(this.privateDataModel),this.showAddView360=!this.showAddView360,this.selectIndex=-1,this.onActionPannellumDestroy()}onActionCancellView360(){this.showAddView360=!1,this.onActionPannellumDestroy()}onActionShowView360Add(){this.dataDetailModel=new ri,this.showAddView360=!this.showAddView360}onActionShowHotspotAdd(){this.dataDetailModel||(this.dataDetailModel=new ri),this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.editHotspot=new Dt;let n=new Dt;n.type="info",n.guid=this.getGuid(),this.inAddhotspotGuid=n.guid,this.dataDetailModel.hotSpots.push(n),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots),this.newROw(n),this.onActionPannellumClickLastPoint()}onActionOptionRemoveView360(n){n<0||!this.privateDataModel||this.privateDataModel.length===0||(this.privateDataModel.splice(n,1),this.actionPrivateDataModelOptimaze(),this.dataModel=this.privateDataModel,this.dataModelChange.emit(this.privateDataModel),this.onActionPannellumDestroy())}onActionOptionEditView360(n){n<0||!this.privateDataModel||this.privateDataModel.length===0||(this.dataDetailModel=this.privateDataModel[n],this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.actionPannellumImageLoad(this.dataDetailModel.panorama,this.dataDetailModel.hotSpots),this.oldHotspot=new Dt,this.editHotspot=new Dt,this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots),this.selectIndex=n,this.showAddView360=!this.showAddView360)}newROw(n){this.editHotspot=n&&n.guid?n:new Dt,this.oldHotspot=Ue({},this.editHotspot)}editROw(n){this.editHotspot=n&&n.guid?n:new Dt,this.oldHotspot=Ue({},this.editHotspot),this.inAddhotspotGuid=""}removeROw(n){let t=this.dataDetailModel.hotSpots.findIndex(l=>l.guid==n.guid);t>=0&&(this.dataDetailModel.hotSpots.splice(t,1),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots))}updateEdit(){this.inAddhotspotGuid="",this.editdisabled=!0;let n=this.dataDetailModel.hotSpots.findIndex(t=>t.guid==this.oldHotspot.guid);n>=0&&(this.dataDetailModel.hotSpots[n]=this.editHotspot),this.editdisabled=!1,this.oldHotspot=new Dt,this.editHotspot=new Dt}cancelEdit(){this.inAddhotspotGuid?.length>0&&(this.dataDetailModel.hotSpots=this.dataDetailModel.hotSpots.filter(n=>n.guid!=this.inAddhotspotGuid)),this.editHotspot=new Dt,this.oldHotspot&&this.oldHotspot.guid&&(this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots))}};Le.nextId=0,Le.\u0275fac=function(t){return new(t||Le)(Ie(Ri),Ie(ki),Ie(Di))},Le.\u0275cmp=ei({type:Le,selectors:[["app-cms-360-image-list"]],viewQuery:function(t,l){if(t&1&&ii(Mn,5),t&2){let s;ni(s=oi())&&(l.container=s.first)}},inputs:{dataModel:"dataModel"},outputs:{dataModelChange:"dataModelChange"},standalone:!1,decls:6,vars:5,consts:[["container",""],["Title",""],["Description",""],["LinkFileId",""],["table",""],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight"],[1,"container",2,"height","380px","width","100%","direction","ltr",3,"click","id"],[1,"example-container","mat-elevation-z8"],[3,"optionsInfoAreaId"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight",3,"click"],[1,"m-2"],[1,"input-style","has-borders","no-icon","input-style-always-active","validate-field","mb-4"],["for","dataDetailModel.title",1,"color-highlight"],["type","text","name","dataDetailModel.title","id","dataDetailModel.title","minlength","3","maxlength","100","required","",1,"form-control","validate-name",3,"ngModelChange","ngModel","placeholder"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",1,"pointer"],["matSuffix","",1,"pointer"],["for","dataDetailModel.description",1,"color-highlight"],["type","text","name","dataDetailModel.description","id","dataDetailModel.description","minlength","3","maxlength","100",1,"form-control","validate-name",3,"ngModelChange","ngModel","placeholder"],["for","dataDetailModel.linkFileId",1,"color-highlight"],["type","text","name","dataDetailModel.linkFileId","id","dataDetailModel.linkFileId",1,"form-control","validate-name",3,"ngModelChange","click","ngModel","placeholder"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear"],["matSuffix","",3,"click"],[3,"itemSelected","openFormChange","language","isPopup","openForm","tree","openDirectUploadView","openFilemanagerButtonLabelKey","selectFileType","openFilemanagerButtonView"],["target","_blank",3,"href"],["aria-hidden","","height","50","width","50",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[1,"grid-row-ltr-center"],[2,"background-color","bisque","padding","5px"],[1,"form-actions",2,"direction","ltr"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal"],["matSort","",3,"dataSource"],["matColumnDef","sceneId"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","pitch"],["matColumnDef","yaw"],["matColumnDef","type"],["matColumnDef","targetYaw"],["matColumnDef","targetPitch"],["matColumnDef","text"],["matColumnDef","url"],["matColumnDef","Action"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ntk-row-odd","ntk-row-even",4,"matRowDef","matRowDefColumns"],[1,"input-style","has-borders","no-icon","input-style-always-active","validate-field","mb-4",2,"visibility","hidden"],["for","dataDetailModel.configDataJson",1,"color-highlight"],["type","text","name","dataDetailModel.configDataJson","id","dataDetailModel.configDataJson","minlength","0","maxlength","10000","required","",1,"form-control","validate-name",3,"ngModelChange","ngModel","placeholder"],[1,"fa","fa-check-square-o"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray",3,"click"],[1,"ft-x"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",1,"pointer",3,"click"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal",3,"click"],[1,"text-truncate"],["matInput","","placeholder","\u0634\u0646\u0627\u0633\u0647 \u0635\u062D\u0646\u0647","name","sceneId",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["matInput","","type","number","placeholder","pitch","name","pitch",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],[1,"text-truncate","grid-row-ltr-center"],["matInput","","type","number","placeholder","yaw","name","yaw",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["placeholder","Select","name","type",1,"form-control","validate-name",3,"ngModelChange","disabled","ngModel"],[3,"value"],["matInput","","placeholder","targetYaw","name","targetYaw",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["matInput","","placeholder","targetPitch","name","targetPitch",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["matInput","","placeholder","text","name","text",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],[1,"text-truncate","grid-row-ltr"],["matInput","","placeholder","url","name","url",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],[1,"m-1",2,"text-align","center"],[3,"click"],["type","button",1,"mb-2",3,"disabled"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray",3,"click","disabled"],["type","button","matTooltip","\u062B\u0628\u062A \u0622\u062E\u0631\u06CC\u0646 \u0646\u0642\u0637\u0647 \u06A9\u0644\u06CC\u06A9 \u0634\u062F\u0647",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-green",3,"disabled"],["type","button",1,"mb-2",3,"click","disabled"],["type","button","matTooltip","\u062B\u0628\u062A \u0622\u062E\u0631\u06CC\u0646 \u0646\u0642\u0637\u0647 \u06A9\u0644\u06CC\u06A9 \u0634\u062F\u0647",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-green",3,"click","disabled"],["multiTemplateDataRows","",3,"dataSource"],["matColumnDef","panorama"],["matColumnDef","title"],["matColumnDef","Description"],["class","Action",4,"matCellDef"],[4,"matHeaderRowDef"],["class","ntk-row-mainfild",3,"ntk-row-odd","ntk-row-even",4,"matRowDef","matRowDefColumns"],[1,"Action"],["matTooltipPosition","before","aria-hidden","false",2,"color","blue","cursor","pointer",3,"click"],["matTooltipPosition","before","aria-hidden","false",2,"color","red","cursor","pointer",3,"click"],[1,"ntk-row-mainfild"]],template:function(t,l){if(t&1){let s=Z();P(0,yn,3,3,"button",5),u(1,"div",6,0),tt("click",function(bt){return V(s),H(l.onActionPannellumClick(bt))}),m(),P(3,Co,97,61,"div",7),wt(4,"app-progress-spinner",8),P(5,Ro,16,3,"div",7)}t&2&&(A(l.showAddView360?-1:0),p(),B("id",l.id),p(2),A(l.showAddView360?3:-1),p(),B("optionsInfoAreaId",l.constructor.name),p(),A(l.showAddView360?-1:5))},dependencies:[li,ci,si,ui,mi,pi,di,fi,hi,gi,Ji,Ci,xi,wi,Mi,Ei,yi,vi,Si,Ti,bi,Ii,Li,_i,Ai,Vi,Bi,Pi,Hi],encapsulation:2});var Qi=Le;var ko=["container"];function Vo(i,n){if(i&1){let t=Z();u(0,"button",9),tt("click",function(){V(t);let s=f();return H(s.onActionShowView360Add())}),w(1),et(2,"translate"),m()}i&2&&(p(),mt(" ",it(2,1,"ACTION.Add_To_List")," "))}function Ho(i,n){if(i&1){let t=Z();u(0,"button",10),tt("click",function(){V(t);let s=f();return H(s.onActionImportFile360View())}),w(1," \u0648\u0631\u0648\u062F \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0639\u06A9\u0633 \u0647\u0627\u06CC 360 "),m()}}function Fo(i,n){if(i&1){let t=Z();u(0,"button",10),tt("click",function(){V(t);let s=f();return H(s.actionPannellumTourLoad())}),w(1," \u0646\u0645\u0627\u06CC\u0634 \u062A\u0648\u0631 "),m()}}function Bo(i,n){if(i&1){let t=Z();u(0,"mat-icon",45),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.title="")}),w(1,"close"),m()}}function Oo(i,n){if(i&1){let t=Z();u(0,"mat-icon",46),tt("click",function(){V(t);let s=f(2);return H(s.dataDetailModel.linkFileId=null)}),w(1,"close"),m()}}function No(i,n){if(i&1&&(wt(0,"img",22),et(1,"cmsthumbnail")),i&2){let t=f(2);B("src",Wt(it(1,2,t.dataDetailModel.panorama)),we)}}function Uo(i,n){if(i&1&&(u(0,"table",23)(1,"tr")(2,"td"),w(3,"viewer Yaw"),m(),u(4,"td"),w(5,"viewer Pitch"),m(),u(6,"td"),w(7,"click Yaw"),m(),u(8,"td"),w(9,"click Pitch"),m()(),u(10,"tr")(11,"td"),w(12),m(),u(13,"td"),w(14),m(),u(15,"td"),w(16),m(),u(17,"td"),w(18),m()()()),i&2){let t=f(2);p(12),ht(t.postionView.viewerGetYaw),p(2),ht(t.postionView.viewerGetPitch),p(2),ht(t.postionView.clickGetYaw),p(2),ht(t.postionView.clickGetPitch)}}function Go(i,n){if(i&1){let t=Z();u(0,"button",47),tt("click",function(){V(t);let s=f(2);return H(s.onActionShowHotspotAdd())}),w(1),et(2,"translate"),m()}i&2&&(p(),mt(" ",it(2,1,"ACTION.ADD")," "))}function Wo(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0646\u0648\u0639"),m())}function Yo(i,n){if(i&1&&(u(0,"p",48),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.type)}}function zo(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"mat-select",49),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.type,s)||(_.type=s),H(s)}),u(2,"mat-option",50),w(3,"\u0635\u062D\u0646\u0647"),m(),u(4,"mat-option",50),w(5,"\u0627\u0637\u0644\u0627\u0639\u0627\u062A"),m()()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.type),p(),B("value","scene"),p(2),B("value","info")}}function qo(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Yo,2,1,"p",48),P(2,zo,6,4,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Xo(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0634\u0646\u0627\u0633\u0647 \u0635\u062D\u0646\u0647"),m())}function $o(i,n){if(i&1&&(u(0,"p",51),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.sceneId||"N/A")}}function Ko(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",52),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.sceneId,s)||(_.sceneId=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.sceneId)}}function jo(i,n){if(i&1&&(u(0,"mat-cell"),P(1,$o,2,1,"p",51),P(2,Ko,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid&&t.type==="scene"?2:-1)}}function Zo(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0634\u0646\u0627\u0633\u0647 \u0635\u062D\u0646\u0647"),m())}function Jo(i,n){if(i&1&&(u(0,"p",48),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.sceneId)}}function Qo(i,n){if(i&1&&(u(0,"mat-option",50),w(1),m()),i&2){let t=n.$implicit;B("value",t.linkFileId),p(),ht(t.title)}}function ta(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"mat-select",53),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.sceneId,s)||(_.sceneId=s),H(s)}),$i(2,Qo,2,2,"mat-option",50,Xi),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.sceneId),p(),Ki(l.scenesList)}}function ea(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Jo,2,1,"p",48),P(2,ta,4,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid&&t.type==="scene"?2:-1)}}function ia(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"pitch"),m())}function na(i,n){if(i&1&&(u(0,"p",51),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.pitch||"N/A")}}function oa(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",54),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.pitch,s)||(_.pitch=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.pitch)}}function aa(i,n){if(i&1&&(u(0,"mat-cell"),P(1,na,2,1,"p",51),P(2,oa,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function ra(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"yaw"),m())}function la(i,n){if(i&1&&(u(0,"p",48),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.yaw||"N/A"," ")}}function sa(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",55),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.yaw,s)||(_.yaw=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.yaw)}}function da(i,n){if(i&1&&(u(0,"mat-cell"),P(1,la,2,1,"p",48),P(2,sa,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function ca(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"targetYaw"),m())}function ua(i,n){if(i&1&&(u(0,"p",48),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.targetYaw||"N/A"," ")}}function ma(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",56),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.targetYaw,s)||(_.targetYaw=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.targetYaw)}}function pa(i,n){if(i&1&&(u(0,"mat-cell"),P(1,ua,2,1,"p",48),P(2,ma,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function fa(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"targetPitch"),m())}function ha(i,n){if(i&1&&(u(0,"p",48),w(1),m()),i&2){let t=f().$implicit;p(),mt(" ",t.targetPitch||"N/A"," ")}}function _a(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",57),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.targetPitch,s)||(_.targetPitch=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.targetPitch)}}function ga(i,n){if(i&1&&(u(0,"mat-cell"),P(1,ha,2,1,"p",48),P(2,_a,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Ca(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A"),m())}function xa(i,n){if(i&1&&(u(0,"p",51),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.text||"N/A")}}function wa(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",58),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.text,s)||(_.text=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.text)}}function va(i,n){if(i&1&&(u(0,"mat-cell"),P(1,xa,2,1,"p",51),P(2,wa,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Ma(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"\u0622\u062F\u0631\u0633 \u0648\u0628 \u0633\u0627\u06CC\u062A"),m())}function ya(i,n){if(i&1&&(u(0,"p",59),w(1),m()),i&2){let t=f().$implicit;p(),ht(t.url||"N/A")}}function Ta(i,n){if(i&1){let t=Z();u(0,"div",12)(1,"input",60),xt("ngModelChange",function(s){V(t);let _=f().$implicit;return Ct(_.url,s)||(_.url=s),H(s)}),m()()}if(i&2){let t=f().$implicit,l=f(2);p(),B("disabled",l.editdisabled),gt("ngModel",t.url)}}function ba(i,n){if(i&1&&(u(0,"mat-cell"),P(1,ya,2,1,"p",59),P(2,Ta,2,2,"div",12),m()),i&2){let t=n.$implicit,l=f(2);p(),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?1:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?2:-1)}}function Ea(i,n){i&1&&(u(0,"mat-header-cell"),w(1,"Action"),m())}function Sa(i,n){if(i&1){let t=Z();u(0,"mat-icon",62),tt("click",function(){V(t);let s=f().$implicit,_=f(2);return H(_.editROw(s))}),w(1,"edit"),m(),u(2,"mat-icon",62),tt("click",function(){V(t);let s=f().$implicit,_=f(2);return H(_.removeROw(s))}),w(3,"delete"),m()}}function Ia(i,n){if(i&1){let t=Z();u(0,"button",66),tt("click",function(){V(t);let s=f(4);return H(s.updateEdit())}),w(1),et(2,"translate"),m()}if(i&2){let t=f(4);B("disabled",t.editdisabled||!t.editHotspot.text||t.editHotspot.text.length===0),p(),mt(" ",it(2,2,"ACTION.Update")," ")}}function La(i,n){if(i&1){let t=Z();u(0,"button",67),tt("click",function(){V(t);let s=f(4);return H(s.onActionPannellumClickLastPoint())}),w(1," \u0646\u0642\u0637\u0647 "),m()}if(i&2){let t=f(4);B("disabled",t.editdisabled)}}function Da(i,n){if(i&1){let t=Z();P(0,Ia,3,4,"button",63),u(1,"button",64),tt("click",function(){V(t);let s=f(3);return H(s.cancelEdit())}),w(2),et(3,"translate"),m(),P(4,La,2,1,"button",65)}if(i&2){let t=f(3);A(t.postionView?0:-1),p(),B("disabled",t.editdisabled),p(),mt(" ",it(3,4,"ACTION.CANCEL")," "),p(2),A(t.editHotspot.pitch!==(t.postionView==null?null:t.postionView.clickGetPitch)&&t.editHotspot.yaw!==(t.postionView==null?null:t.postionView.clickGetYaw)?4:-1)}}function Pa(i,n){if(i&1&&(u(0,"mat-cell")(1,"span",61),P(2,Sa,4,0),P(3,Da,5,6),m()()),i&2){let t=n.$implicit,l=f(2);p(2),A(!l.editHotspot.guid||!t.guid||t.guid!==l.editHotspot.guid?2:-1),p(),A(l.editHotspot.guid&&t.guid&&t.guid===l.editHotspot.guid?3:-1)}}function Aa(i,n){i&1&&wt(0,"mat-header-row")}function Ra(i,n){if(i&1&&wt(0,"mat-row"),i&2){let t=n.dataIndex;Ge("ntk-row-odd",t%2)("ntk-row-even",!(t%2))}}function ka(i,n){if(i&1){let t=Z();u(0,"div",7)(1,"div",11)(2,"div",12)(3,"mat-label"),w(4),et(5,"translate"),m(),u(6,"label",13),w(7),et(8,"translate"),m(),u(9,"input",14,1),et(11,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.title,s)||(_.dataDetailModel.title=s),H(s)}),m(),P(12,Bo,2,0,"mat-icon",15),u(13,"mat-icon",16),w(14,"mode_edit"),m()(),u(15,"div",12)(16,"input",17,2),et(18,"translate"),xt("ngModelChange",function(s){V(t);let _=f();return Ct(_.dataDetailModel.linkFileId,s)||(_.dataDetailModel.linkFileId=s),H(s)}),tt("click",function(){V(t);let s=f();return H(s.fileManagerOpenFormReport=!0)}),m(),P(19,Oo,2,0,"mat-icon",18),u(20,"mat-icon",19),tt("click",function(){V(t);let s=f();return H(s.fileManagerOpenFormReport=!0)}),w(21,"mode_edit"),m()(),u(22,"cms-file-manager",20),tt("itemSelected",function(s){V(t);let _=f();return H(_.onActionFileSelect(s))}),xt("openFormChange",function(s){V(t);let _=f();return Ct(_.fileManagerOpenFormReport,s)||(_.fileManagerOpenFormReport=s),H(s)}),m(),u(23,"a",21),et(24,"cmsthumbnail"),P(25,No,2,4,"img",22),m(),wt(26,"hr"),P(27,Uo,19,4,"table",23),wt(28,"hr"),u(29,"h5"),w(30,"\u062A\u0646\u0638\u06CC\u0645\u0627\u062A \u062A\u0648\u0631"),m(),u(31,"p"),w(32,"\u062F\u0631 \u0648\u0631\u0648\u062F \u0627\u06CC\u0646 \u062A\u0646\u0638\u06CC\u0645\u0627\u062A \u0628\u0627 \u0645\u062F\u06CC\u0631\u06CC\u062A \u0633\u0627\u0645\u0627\u0646\u0647 \u0647\u0645\u0627\u0647\u0646\u06AF \u0628\u0627\u0634\u06CC\u062F"),m(),u(33,"div",24)(34,"div",25),P(35,Go,3,3,"button",26),m(),u(36,"mat-table",27,3),ct(38,28),st(39,Wo,2,0,"mat-header-cell",29)(40,qo,3,2,"mat-cell",30),ut(),ct(41,31),st(42,Xo,2,0,"mat-header-cell",29)(43,jo,3,2,"mat-cell",30),ut(),ct(44,32),st(45,Zo,2,0,"mat-header-cell",29)(46,ea,3,2,"mat-cell",30),ut(),ct(47,33),st(48,ia,2,0,"mat-header-cell",29)(49,aa,3,2,"mat-cell",30),ut(),ct(50,34),st(51,ra,2,0,"mat-header-cell",29)(52,da,3,2,"mat-cell",30),ut(),ct(53,35),st(54,ca,2,0,"mat-header-cell",29)(55,pa,3,2,"mat-cell",30),ut(),ct(56,36),st(57,fa,2,0,"mat-header-cell",29)(58,ga,3,2,"mat-cell",30),ut(),ct(59,37),st(60,Ca,2,0,"mat-header-cell",29)(61,va,3,2,"mat-cell",30),ut(),ct(62,38),st(63,Ma,2,0,"mat-header-cell",29)(64,ba,3,2,"mat-cell",30),ut(),ct(65,39),st(66,Ea,2,0,"mat-header-cell",29)(67,Pa,4,2,"mat-cell",30),ut(),st(68,Aa,1,0,"mat-header-row",40)(69,Ra,1,4,"mat-row",41),m()(),u(70,"div",25)(71,"button",9),tt("click",function(){V(t);let s=f();return H(s.onActionSubmitView360())}),wt(72,"i",42),w(73),et(74,"translate"),m(),u(75,"button",43),tt("click",function(){V(t);let s=f();return H(s.onActionCancellView360())}),wt(76,"i",44),w(77),et(78,"translate"),m()(),wt(79,"br"),m()()}if(i&2){let t=f();p(4),ht(it(5,29,"TITLE.Photography_Place")),p(3),ht(it(8,31,"TITLE.title")),p(2),B("placeholder",Wt(it(11,33,"TITLE.Photography_Place"))),gt("ngModel",t.dataDetailModel.title),p(3),A(t.dataDetailModel.title?12:-1),p(4),B("placeholder",Wt(it(18,35,"TITLE.View_360_File_ID"))),gt("ngModel",t.dataDetailModel.linkFileId),p(3),A(t.dataDetailModel.linkFileId?19:-1),p(3),B("language",t.appLanguage)("isPopup",!0),gt("openForm",t.fileManagerOpenFormReport),B("tree",t.fileManagerTree)("openDirectUploadView",!0)("openFilemanagerButtonLabelKey","select")("selectFileType",t.selectFileTypeReport)("openFilemanagerButtonView",!1),p(),B("href",Wt(it(24,37,t.dataDetailModel.panorama)),we),p(2),A((t.dataDetailModel==null||t.dataDetailModel.panorama==null?null:t.dataDetailModel.panorama.length)>0?25:-1),p(2),A(t.postionView?27:-1),p(8),A(t.postionView?35:-1),p(),B("dataSource",t.tableHotSpotdataSource),p(32),B("matHeaderRowDef",t.tableHotspotDisplayedColumns)("matHeaderRowDefSticky",!0),p(),B("matRowDefColumns",t.tableHotspotDisplayedColumns),p(4),mt(" ",it(74,39,"ACTION.SUBMIT_BUTTON")," "),p(4),mt(" ",it(78,41,"ACTION.CANCEL")," ")}}function Va(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),m()),i&2&&(p(),mt(" ",it(2,1,"TITLE.PHOTO")," "))}function Ha(i,n){if(i&1&&wt(0,"img",22),i&2){let t=f(2).$implicit;B("src",Wt(t.panorama),we)}}function Fa(i,n){if(i&1&&(u(0,"a",21),P(1,Ha,1,2,"img",22),m()),i&2){let t=f().$implicit;B("href",Wt(t.panorama),we),p(),A((t==null||t.panorama==null?null:t.panorama.length)>0?1:-1)}}function Ba(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Fa,2,3,"a",21),m()),i&2){let t=n.$implicit;p(),A(t.panorama?1:-1)}}function Oa(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),m()),i&2&&(p(),mt(" ",it(2,1,"TITLE.Photography_Place")," "))}function Na(i,n){if(i&1&&w(0),i&2){let t=f().$implicit;mt(" ",t.title," ")}}function Ua(i,n){if(i&1&&(u(0,"mat-cell"),P(1,Na,1,1),m()),i&2){let t=n.$implicit;p(),A(t.title?1:-1)}}function Ga(i,n){i&1&&(u(0,"mat-header-cell"),w(1," \u0634\u0646\u0627\u0633\u0647 \u0635\u062D\u0646\u0647 "),m())}function Wa(i,n){if(i&1&&(u(0,"mat-cell"),ct(1),w(2),ut(),m()),i&2){let t=n.$implicit;p(2),mt(" ",t.linkFileId," ")}}function Ya(i,n){i&1&&(u(0,"mat-header-cell"),w(1),et(2,"translate"),et(3,"translate"),m()),i&2&&(p(),ai(" ",it(2,2,"TITLE.Edit")," | ",it(3,4,"TITLE.Delete")," "))}function za(i,n){if(i&1){let t=Z();u(0,"mat-cell",75)(1,"small")(2,"mat-icon",76),tt("click",function(){let s=V(t).renderIndex,_=f(2);return H(_.onActionOptionEditView360(s))}),w(3,"edit"),m()(),w(4,"| "),u(5,"small")(6,"mat-icon",77),tt("click",function(){let s=V(t).renderIndex,_=f(2);return H(_.onActionOptionRemoveView360(s))}),w(7,"delete"),m()()()}}function qa(i,n){i&1&&wt(0,"mat-header-row")}function Xa(i,n){if(i&1&&wt(0,"mat-row",78),i&2){let t=n.dataIndex;Ge("ntk-row-odd",t%2)("ntk-row-even",!(t%2))}}function $a(i,n){if(i&1&&(u(0,"div",7)(1,"mat-table",68),ct(2,69),st(3,Va,3,3,"mat-header-cell",29)(4,Ba,2,1,"mat-cell",30),ut(),ct(5,70),st(6,Oa,3,3,"mat-header-cell",29)(7,Ua,2,1,"mat-cell",30),ut(),ct(8,71),st(9,Ga,2,0,"mat-header-cell",29)(10,Wa,3,1,"mat-cell",30),ut(),ct(11,39),st(12,Ya,4,6,"mat-header-cell",29)(13,za,8,0,"mat-cell",72),ut(),st(14,qa,1,0,"mat-header-row",73)(15,Xa,1,4,"mat-row",74),m()()),i&2){let t=f();p(),B("dataSource",t.tabledataSource),p(13),B("matHeaderRowDef",t.tabledisplayedColumns),p(),B("matRowDefColumns",t.tabledisplayedColumns)}}var Wi=class{},De=class De{constructor(n,t,l){this.cmsToastrService=n;this.publicHelper=t;this.translate=l;this.id=++De.nextId;this.scenesList=[];this.dataDetailModel=new je;this.dataModelChange=new ti;this.formInfo=new Fi;this.tabledataSource=new We;this.tableHotSpotdataSource=new We;this.tabledisplayedColumns=["linkFileId","panorama","title","Action"];this.tableHotspotDisplayedColumns=["type","sceneIdSelector","text","url","pitch","yaw","Action"];this.selectFileTypeReport=["jpeg","jpg"];this.appLanguage="fa";this.showAddView360=!1;this.fileManagerOpenFormReport=!1;this.actionPannellumTourLoadClick=!1;this.inAddhotspotGuid="";this.selectIndex=-1;this.fileManagerTree=this.publicHelper.GetfileManagerTreeConfig()}getGuid(){return Math.floor(Math.random()*1e3)+""}set dataModel(n){n||(n=new ji),n.defaultValue||(n.defaultValue=new Ui),n.scenes||(n.scenes=new Map),this.scenesList=[],Object.keys(n.scenes).map(t=>{n.scenes[t].guid=this.getGuid(),this.scenesList.push(n.scenes[t])}),this.scenesList.forEach(t=>{t.hotSpots||(t.hotSpots=[]),t.hotSpots.forEach(l=>{l.guid=this.getGuid()})}),this.privateDataModel=n,this.tabledataSource.data=this.scenesList,this.tableHotSpotdataSource.data=[]}get dataModel(){return this.privateDataModel}set dataImageModel(n){n||(n=[]),this.privateDataImageModel=n}ngOnInit(){this.translate.get("TITLE.Edit").subscribe(n=>{this.formInfo.formTitle=n})}ngAfterViewInit(){this.container.nativeElement.style.display="none"}uniqByReduce(n){let t=[];return n.forEach(l=>{!t.includes(l)&&t.filter(s=>s.pitch==l.pitch&&s.yaw==l.yaw).length==0&&t.push(l)}),t}actionPannellumImageLoad(n,t){let l={type:"equirectangular",panorama:n,autoLoad:!0,autoRotate:1.5,crossOrigin:"anonymous"};t&&t.length>0&&(l.hotSpots=this.uniqByReduce(t));let s=Object.assign({},l,this.options);this.viewer&&this.onActionPannellumDestroy(),this.viewer=pannellum.viewer(this.container.nativeElement,s),this.container.nativeElement.style.display="block"}actionPannellumTourLoad(){this.actionPannellumTourLoadClick=!0,this.actionPrivateDataModelOptimaze();let n={};n.default=this.privateDataModel.defaultValue,this.privateDataModel&&this.privateDataModel.scenes&&(n.scenes=this.privateDataModel.scenes);let t=Object.assign({},n,this.options);this.viewer&&this.onActionPannellumDestroy(),this.viewer=pannellum.viewer(this.container.nativeElement,t),this.container.nativeElement.style.display="block"}onActionPannellumClick(n){if(!this.viewer)return;if(this.actionPannellumTourLoadClick){this.actionPannellumTourLoadClick=!1;return}this.postionView=new Wi,this.postionView.viewerGetYaw=this.viewer.getYaw(),this.postionView.viewerGetPitch=this.viewer.getPitch();let t=this.viewer.mouseEventToCoords(n);!t||t.length==0||(this.postionView.clickGetYaw=t[1],this.postionView.clickGetPitch=t[0])}onActionPannellumDestroy(){this.container.nativeElement.style.display="none",this.postionView=null,this.viewer&&this.viewer.destroy()}onActionPannellumClickLastPoint(){this.postionView&&(this.postionView.clickGetYaw!=0||this.postionView.clickGetPitch!=0)&&(this.editHotspot.yaw=this.postionView.clickGetYaw,this.editHotspot.pitch=this.postionView.clickGetPitch)}onActionFileSelect(n){if(!(n?.id>0)){this.cmsToastrService.typeErrorSelectedRow();return}this.dataDetailModel.linkFileId=n.id,this.dataDetailModel.panorama=n.downloadLinksrc,this.dataDetailModel.preview=n.downloadLinksrc,this.actionPannellumImageLoad(this.dataDetailModel.panorama,[])}onActionSubmitView360(){(!this.dataDetailModel.linkFileId||this.dataDetailModel.linkFileId<=0)&&this.cmsToastrService.typeErrorMessage("\u0641\u0627\u06CC\u0644 \u0627\u0646\u062A\u062E\u0627\u0628 \u0646\u0634\u062F\u0647"),this.scenesList||(this.scenesList=[]),this.selectIndex>=0?this.scenesList[this.selectIndex]=this.dataDetailModel:this.scenesList.push(this.dataDetailModel),this.actionPrivateDataModelOptimaze(),this.dataModelChange.emit(this.privateDataModel),this.showAddView360=!this.showAddView360,this.selectIndex=-1,this.onActionPannellumDestroy()}actionPrivateDataModelOptimaze(){this.privateDataModel.defaultValue||(this.privateDataModel.defaultValue=new Ui),this.privateDataModel.scenes=new Map,this.scenesList||(this.scenesList=[]),this.scenesList.forEach(n=>{if(n.title&&n.title.length>0){let t=[];n.hotSpots||(n.hotSpots=[]),n.hotSpots.forEach(l=>{l.type&&l.type.length>0&&t.push(l)}),n.hotSpots=this.uniqByReduce(t),this.privateDataModel.scenes[n.linkFileId]=n,this.privateDataModel.scenes[n.linkFileId].hfov=110}}),(!this.privateDataModel.defaultValue.firstScene||this.privateDataModel.defaultValue.firstScene.length==0)&&(this.privateDataModel.scenes&&this.scenesList&&this.scenesList.length>0&&(this.privateDataModel.defaultValue.firstScene=this.scenesList[0].linkFileId+""),this.privateDataModel.defaultValue.sceneFadeDuration=1e3)}onActionCancellView360(){this.showAddView360=!1,this.onActionPannellumDestroy()}onActionShowView360Add(){this.dataDetailModel=new je,this.showAddView360=!this.showAddView360,this.tableHotSpotdataSource.data=[]}onActionShowHotspotAdd(){this.dataDetailModel||(this.dataDetailModel=new je),this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.editHotspot=new Dt;let n=new Dt;n.guid=this.getGuid(),this.inAddhotspotGuid=n.guid,this.dataDetailModel.hotSpots.push(n),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots),this.newROw(n),this.onActionPannellumClickLastPoint()}onActionOptionRemoveView360(n){n<0||!this.scenesList||this.scenesList.length===0||(this.scenesList.splice(n,1),this.actionPrivateDataModelOptimaze(),this.dataModel=this.privateDataModel,this.dataModelChange.emit(this.privateDataModel),this.onActionPannellumDestroy())}onActionOptionEditView360(n){n<0||!this.scenesList||this.scenesList.length===0||(this.dataDetailModel=this.scenesList[n],this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.actionPannellumImageLoad(this.dataDetailModel.panorama,this.dataDetailModel.hotSpots),this.oldHotspot=new Dt,this.editHotspot=new Dt,this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots),this.selectIndex=n,this.showAddView360=!this.showAddView360)}newROw(n){this.editHotspot=n&&n.guid?n:new Dt,this.oldHotspot=Ue({},this.editHotspot)}editROw(n){this.editHotspot=n&&n.guid?n:new Dt,this.oldHotspot=Ue({},this.editHotspot),this.inAddhotspotGuid=""}removeROw(n){let t=this.dataDetailModel.hotSpots.findIndex(l=>l.guid==n.guid);t>=0&&(this.dataDetailModel.hotSpots.splice(t,1),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots))}updateEdit(){this.inAddhotspotGuid="",this.editdisabled=!0;let n=this.dataDetailModel.hotSpots.findIndex(t=>t.guid==this.oldHotspot.guid);n>=0&&(this.dataDetailModel.hotSpots[n]=this.editHotspot),this.editdisabled=!1,this.oldHotspot=new Dt,this.editHotspot=new Dt}cancelEdit(){this.inAddhotspotGuid?.length>0&&(this.dataDetailModel.hotSpots=this.dataDetailModel.hotSpots.filter(n=>n.guid!=this.inAddhotspotGuid)),this.editHotspot=new Dt,this.oldHotspot&&this.oldHotspot.guid&&(this.dataDetailModel.hotSpots||(this.dataDetailModel.hotSpots=[]),this.tableHotSpotdataSource.data=this.uniqByReduce(this.dataDetailModel.hotSpots))}onActionImportFile360View(){this.privateDataImageModel&&this.privateDataImageModel.length>0&&(this.actionPrivateDataModelOptimaze(),this.privateDataImageModel.forEach(n=>{if(!this.privateDataModel.scenes[n.linkFileId]&&n.linkFileId>0){let t=new je;t.guid=this.getGuid(),t.linkFileId=n.linkFileId,t.title=n.title,t.hotSpots=this.uniqByReduce(n.hotSpots),t.panorama=n.panorama,t.preview=n.preview,t.hfov=110,this.privateDataModel.scenes[n.linkFileId]=t}}),this.dataModel=this.privateDataModel)}};De.nextId=0,De.\u0275fac=function(t){return new(t||De)(Ie(Ri),Ie(ki),Ie(Di))},De.\u0275cmp=ei({type:De,selectors:[["app-cms-360-tour-list"]],viewQuery:function(t,l){if(t&1&&ii(ko,5),t&2){let s;ni(s=oi())&&(l.container=s.first)}},inputs:{dataModel:"dataModel",dataImageModel:"dataImageModel"},outputs:{dataModelChange:"dataModelChange"},standalone:!1,decls:8,vars:7,consts:[["container",""],["Title",""],["LinkFileId",""],["table",""],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight",2,"margin","10px"],[1,"container",2,"height","380px","width","100%","direction","ltr",3,"click","id"],[1,"example-container","mat-elevation-z8"],[3,"optionsInfoAreaId"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-highlight",2,"margin","10px",3,"click"],[1,"m-2"],[1,"input-style","has-borders","no-icon","input-style-always-active","validate-field","mb-4"],["for","dataDetailModel.title",1,"color-highlight"],["type","text","name","dataDetailModel.title","id","dataDetailModel.title","minlength","3","maxlength","100","required","",1,"form-control","validate-name",3,"ngModelChange","ngModel","placeholder"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",1,"pointer"],["matSuffix","",1,"pointer"],["type","text","name","dataDetailModel.linkFileId",1,"form-control","validate-name",3,"ngModelChange","click","ngModel","placeholder"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear"],["matSuffix","",3,"click"],[3,"itemSelected","openFormChange","language","isPopup","openForm","tree","openDirectUploadView","openFilemanagerButtonLabelKey","selectFileType","openFilemanagerButtonView"],["target","_blank",3,"href"],["aria-hidden","","height","50","width","50",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[1,"grid-row-ltr-center"],[2,"background-color","bisque","padding","5px"],[1,"form-actions",2,"direction","ltr"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal"],["matSort","",3,"dataSource"],["matColumnDef","type"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","sceneId"],["matColumnDef","sceneIdSelector"],["matColumnDef","pitch"],["matColumnDef","yaw"],["matColumnDef","targetYaw"],["matColumnDef","targetPitch"],["matColumnDef","text"],["matColumnDef","url"],["matColumnDef","Action"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ntk-row-odd","ntk-row-even",4,"matRowDef","matRowDefColumns"],[1,"fa","fa-check-square-o"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray",3,"click"],[1,"ft-x"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",1,"pointer",3,"click"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-teal",3,"click"],[1,"text-truncate","grid-row-ltr-center"],["placeholder","Select","name","type",1,"form-control","validate-name",3,"ngModelChange","disabled","ngModel"],[3,"value"],[1,"text-truncate"],["type","text","placeholder","sceneId","name","sceneId",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["placeholder","Select","name","sceneId",1,"form-control","validate-name",3,"ngModelChange","disabled","ngModel"],["type","number","placeholder","pitch","name","pitch",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["type","number","placeholder","yaw","name","yaw",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["type","text","placeholder","targetYaw","name","targetYaw",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["type","text","placeholder","targetPitch","name","targetPitch",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],["type","text","placeholder","text","name","text",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],[1,"text-truncate","grid-row-ltr"],["type","text","placeholder","url","name","url",1,"form-control","validate-name",2,"direction","ltr","text-align","left",3,"ngModelChange","disabled","ngModel"],[1,"m-1",2,"text-align","center"],[3,"click"],["type","button",1,"mb-2",3,"disabled"],["type","button",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray",3,"click","disabled"],["type","button","matTooltip","\u062B\u0628\u062A \u0622\u062E\u0631\u06CC\u0646 \u0646\u0642\u0637\u0647 \u06A9\u0644\u06CC\u06A9 \u0634\u062F\u0647",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-green",3,"disabled"],["type","button",1,"mb-2",3,"click","disabled"],["type","button","matTooltip","\u062B\u0628\u062A \u0622\u062E\u0631\u06CC\u0646 \u0646\u0642\u0637\u0647 \u06A9\u0644\u06CC\u06A9 \u0634\u062F\u0647",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-green",3,"click","disabled"],["multiTemplateDataRows","",3,"dataSource"],["matColumnDef","panorama"],["matColumnDef","title"],["matColumnDef","linkFileId"],["class","Action",4,"matCellDef"],[4,"matHeaderRowDef"],["class","ntk-row-mainfild",3,"ntk-row-odd","ntk-row-even",4,"matRowDef","matRowDefColumns"],[1,"Action"],["matTooltipPosition","before","aria-hidden","false",2,"color","blue","cursor","pointer",3,"click"],["matTooltipPosition","before","aria-hidden","false",2,"color","red","cursor","pointer",3,"click"],[1,"ntk-row-mainfild"]],template:function(t,l){if(t&1){let s=Z();P(0,Vo,3,3,"button",4),P(1,Ho,2,0,"button",5),P(2,Fo,2,0,"button",5),u(3,"div",6,0),tt("click",function(bt){return V(s),H(l.onActionPannellumClick(bt))}),m(),P(5,ka,80,43,"div",7),wt(6,"app-progress-spinner",8),P(7,$a,16,3,"div",7)}t&2&&(A(l.showAddView360?-1:0),p(),A(l.privateDataImageModel&&l.privateDataImageModel.length>0?1:-1),p(),A(l.privateDataModel&&l.privateDataModel&&l.privateDataModel.scenes&&l.scenesList&&l.scenesList.length>0?2:-1),p(),B("id",l.id),p(2),A(l.showAddView360?5:-1),p(),B("optionsInfoAreaId",l.constructor.name),p(),A(l.showAddView360?-1:7))},dependencies:[li,ci,si,ui,mi,pi,di,fi,Zi,hi,gi,Ci,xi,wi,Mi,Ei,yi,vi,Si,Ti,bi,Ii,Li,_i,Ai,Vi,Bi,Pi,Hi],encapsulation:2});var tn=De;export{Qi as a,tn as b};
