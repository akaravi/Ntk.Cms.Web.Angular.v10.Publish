import{a as ue}from"./chunk-SGMBTPCU.js";import{a as me}from"./chunk-S37YDRYV.js";import{f as de}from"./chunk-N3PU7IZM.js";import{$ as re,$a as se,A as ie,J as oe,Q as ne,Qb as pe,Rb as ce,Y as le,aa as ae,n as Z,q as ee,u as te}from"./chunk-Z6VRH72F.js";import{Ab as H,Ad as S,Bb as j,Ca as T,F as D,Fa as r,Fd as C,Ha as q,I as P,Jb as G,Kc as W,Lb as x,Lc as $,Oa as u,Ob as g,P as V,Pb as O,Q as N,Qb as z,Rc as J,Sa as B,Td as K,Xb as v,Xd as m,Ya as c,Yb as R,Yd as Q,da as y,db as L,dc as h,de as X,ea as b,ec as M,he as Y,kb as l,lb as a,mb as s,mf as I,nb as d,p as F,q as k,ub as A,wc as U,xb as _,zb as f}from"./chunk-OZYBSVFX.js";import{i as E}from"./chunk-SEDBTTTN.js";var Me=["*"];function Se(n,e){if(n&1&&(a(0,"label",14),g(1),s()),n&2){let t=f();l("for",R("app-cms-site-selector-",t.id)),r(),O(t.optionLabel)}}function Ce(n,e){if(n&1&&(d(0,"img",15),h(1,"cmsthumbnail")),n&2){let t=f();l("src",v(M(1,2,t.dataModelSelect==null?null:t.dataModelSelect.linkMainImageIdSrc)),T)}}function ge(n,e){if(n&1&&(d(0,"img",15),h(1,"cmsthumbnail")),n&2){let t=f().$implicit;l("src",v(M(1,2,t.linkMainImageIdSrc)),T)}}function ve(n,e){if(n&1&&(a(0,"mat-option",16),c(1,ge,2,4,"img",5),a(2,"span"),g(3),s()()),n&2){let t=e.$implicit,o=f();l("value",t)("disabled",o.optionDisabled),r(),l("ngIf",t.linkMainImageIdSrc),r(2),O(o.displayOption(t))}}function Ie(n,e){n&1&&d(0,"i",17)}function ye(n,e){n&1&&d(0,"i",18)}function be(n,e){if(n&1){let t=A();a(0,"i",19),_("click",function(){y(t);let i=f();return b(i.onActionSelectClear())}),s()}}function _e(n,e){n&1&&(a(0,"em"),g(1),h(2,"translate"),s()),n&2&&(r(),z("(",M(2,1,"TITLE.Necessary"),")"))}var p=class p{constructor(e,t,o,i,w){this.coreEnumService=e;this.translate=t;this.cdr=o;this.publicHelper=i;this.categoryService=w;this.id=++p.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new K;this.dataModelSelect=new I;this.formControl=new te;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new q;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(V(""),D(1500),P(),N(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){return e?e.title+" # "+e.className:void 0}displayOption(e){return e?e.title+" # "+e.className:void 0}DataGetAll(e){return E(this,null,function*(){let t=new Q;if(t.rowPerPage=20,t.accessLoad=!0,e&&e.length>0){let i=new m;i=new m,i.propertyName="classname",i.value=e,i.searchType=C.Contains,i.clauseType=S.Or,t.filters.push(i),i=new m,i.propertyName="name",i.value=e,i.searchType=C.Contains,i.clauseType=S.Or,t.filters.push(i),i=new m,i.propertyName="email",i.value=e,i.searchType=C.Contains,i.clauseType=S.Or,t.filters.push(i),i=new m,i.propertyName="lastname",i.value=e,i.searchType=C.Contains,i.clauseType=S.Or,t.filters.push(i),e&&typeof+e=="number"&&+e>0&&(i=new m,i.propertyName="id",i.value=e,i.searchType=C.Equal,i.clauseType=S.Or,t.filters.push(i))}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield F(this.categoryService.ServiceGetAll(t)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(new I))}push(e){return this.filteredOptions.pipe(k(t=>(t.find(o=>o.id===e.id)||t.push(e),t)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(t=>t.id===e)){let t=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=t,this.formControl.setValue(t);return}this.categoryService.ServiceGetOneById(e).subscribe({next:t=>{t.isSuccess&&(this.filteredOptions=this.push(t.item),this.dataModelSelect=t.item,this.formControl.setValue(t.item),this.optionChange.emit(t.item))}});return}if(typeof e==typeof I){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new I,this.loadOptions()}};p.nextId=0,p.\u0275fac=function(t){return new(t||p)(u(X),u(pe),u(U),u(de),u(Y))},p.\u0275cmp=B({type:p,selectors:[["app-cms-module-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:Me,decls:18,vars:25,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["matPrefix",""],["style","vertical-align: middle","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(t,o){if(t&1){let i=A();H(),a(0,"div",1),d(1,"app-progress-spinner",2),c(2,Se,2,3,"label",3),a(3,"span",4),c(4,Ce,2,4,"img",5),g(5," \xA0"),s(),d(6,"input",6),a(7,"mat-autocomplete",7,0),_("optionSelected",function(he){return y(i),b(o.onActionSelect(he.option.value))}),c(9,ve,4,4,"mat-option",8),h(10,"async"),s(),c(11,Ie,1,0,"i",9)(12,ye,1,0,"i",10)(13,be,1,0,"i",11),a(14,"i",12),h(15,"translate"),_("click",function(){return y(i),b(o.onActionButtonReload())}),s(),c(16,_e,3,3,"em",13),j(17),s()}if(t&2){let i=G(8);r(),l("optionsInfoAreaId",o.constructorInfoAreaId),r(),l("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),r(2),l("ngIf",o.dataModelSelect&&(o.dataModelSelect==null?null:o.dataModelSelect.linkMainImageIdSrc)),r(2),l("placeholder",v(o.optionPlaceholder))("id",R("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),L("disabled",o.optionDisabled?!0:null),r(),l("displayWith",o.displayFn),r(2),l("ngForOf",M(10,21,o.filteredOptions)),r(2),l("ngIf",!o.formControl.valid),r(),l("ngIf",o.optionRequired&&o.formControl.valid),r(),l("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),r(),x("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),l("title",v(M(15,23,"ACTION.RELOAD"))),r(2),l("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[W,$,Z,ee,oe,ie,re,ne,ae,le,se,me,J,ce,ue],encapsulation:2});var fe=p;export{fe as a};
