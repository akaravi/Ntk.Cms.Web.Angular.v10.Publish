import{$ as z,A as j,Kc as te,Q as q,V as H,Za as ee,_ as W,aa as J,n as K,q as Q,u as $,ua as U,va as X,xa as Y,ya as Z}from"./chunk-UMYVJKQA.js";import{Ad as f,Db as L,Eb as V,F as E,Fa as n,Fb as P,Fd as S,Ha as w,Jb as I,Kc as R,Oa as C,Ob as m,P as A,Pb as x,Q as F,Qb as y,Rc as B,Sa as D,Xd as g,Ya as M,Yd as T,da as u,dc as k,ea as d,ec as N,kb as p,lb as r,mb as s,q as _,qg as G,ub as b,xb as h,zb as O}from"./chunk-LOPO7SVR.js";var oe=["tagInput"];function ae(c,i){if(c&1){let t=b();r(0,"mat-chip",9),h("removed",function(){let o=u(t).$implicit,a=O();return d(a.remove(o))}),m(1),r(2,"button",10)(3,"mat-icon"),m(4,"cancel"),s()()()}if(c&2){let t=i.$implicit;n(),y(" ",t.display," ")}}function ne(c,i){if(c&1&&(r(0,"mat-option",11),m(1),s()),c&2){let t=i.$implicit;p("value",t),n(),y(" ",t.display," ")}}var l=class l{constructor(i,t){this.service=i;this.cmsToastrService=t;this.id=++l.nextId;this.optionDisabled=!1;this.optionPlaceholder="+ Tag";this.optionLabel="";this.optionChange=new w;this.tagDataModel=[];this.tagLastDataModel=[];this.selectForceStatus=!0;this.separatorKeysCodes=[13];this.tagCtrl=new $("");this.addOnBlur=!0;this.filteredOptions=this.tagCtrl.valueChanges.pipe(A(null),E(400),F(e=>this.filter(e||"")))}set optionSelectForce(i){this.onActionSelectForce(i)}ngOnInit(){(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}filter(i){let t=new T;t.rowPerPage=20,t.accessLoad=!0;let e=new g;return e.propertyName="title",e.value=i,e.searchType=S.Contains,e.clauseType=f.Or,t.filters.push(e),i&&typeof+i=="number"&&+i>0&&(e=new g,e.propertyName="id",e.value=i,e.searchType=S.Equal,e.clauseType=f.Or,t.filters.push(e)),this.service.ServiceGetAll(t).pipe(_(o=>(this.tagLastDataModel=o.listItems.map(a=>({display:a.title,value:a.id})),this.tagLastDataModel)))}checkIndex(i){let t=0,e=-1;return this.tagDataModel.forEach(o=>{o.value==i&&(e=t),t++}),e}add(i){let t;i.value&&this.tagLastDataModel.forEach(e=>{(e.display==i.value||e.value+""==i.value)&&(t=e)}),t&&this.checkIndex(t.value)<0&&(this.tagDataModel.push(t),this.onActionChange()),i.chipInput.clear(),this.tagCtrl.setValue(null)}remove(i){let t=this.checkIndex(i.value);t>=0&&(this.tagDataModel.splice(t,1),this.onActionChange())}selected(i){let t=i.option.value;this.checkIndex(t.value)<0&&this.tagDataModel.push(t),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){let i=[];this.tagDataModel.forEach(t=>{i.findIndex(e=>e==t.value)<0&&i.push(t.value)}),this.selectForceStatus=!1,this.optionChange.emit(i)}onActionSelectForce(i){if(!this.selectForceStatus||!i||i.length===0)return;let t=new T;i.forEach(e=>{if(e>0){let o=new g;o.propertyName="id",o.value=e,o.clauseType=f.Or,t.filters.push(o)}}),this.service.ServiceGetAll(t).subscribe({next:e=>{e.isSuccess?e.listItems.forEach(o=>{this.tagDataModel.findIndex(a=>a.value==o.id)<0&&this.tagDataModel.push({value:o.id,display:o.title})}):this.cmsToastrService.typeErrorGetAll(e.errorMessage)},error:e=>{this.cmsToastrService.typeErrorGetAll(e)}})}};l.nextId=0,l.\u0275fac=function(t){return new(t||l)(C(G),C(te))},l.\u0275cmp=D({type:l,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(t,e){if(t&1&&L(oe,5),t&2){let o;V(o=P())&&(e.tagInput=o.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,decls:12,vars:12,consts:[["chipList",""],["tagInput",""],["auto","matAutocomplete"],["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],[3,"removed",4,"ngFor","ngForOf"],[3,"matChipInputTokenEnd","placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["type","button","matChipRemove","",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray"],[3,"value"]],template:function(t,e){if(t&1){let o=b();r(0,"mat-form-field",3)(1,"mat-label"),m(2),s(),r(3,"mat-chip-grid",4,0),M(5,ae,5,1,"mat-chip",5),r(6,"input",6,1),h("matChipInputTokenEnd",function(v){return u(o),d(e.add(v))}),s()(),r(8,"mat-autocomplete",7,2),h("optionSelected",function(v){return u(o),d(e.selected(v))}),M(10,ne,2,2,"mat-option",8),k(11,"async"),s()()}if(t&2){let o=I(4),a=I(9);n(2),x(e.optionLabel),n(),p("disabled",e.optionDisabled),n(2),p("ngForOf",e.tagDataModel),n(),p("placeholder"," + "+e.optionPlaceholder)("matChipInputAddOnBlur",e.addOnBlur)("formControl",e.tagCtrl)("matAutocomplete",a)("matChipInputFor",o)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes),n(4),p("ngForOf",N(11,10,e.filteredOptions))}},dependencies:[R,K,Q,j,z,q,J,X,Y,Z,U,W,H,ee,B],encapsulation:2});var ie=l;export{ie as a};
