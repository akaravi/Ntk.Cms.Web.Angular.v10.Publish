import{Kc as y,Ob as v,Pb as M}from"./chunk-SZJKWUJC.js";import{Bq as h,Ha as s,Oa as m,Sa as l,kb as c,lb as d,mb as f,xb as u}from"./chunk-OZYBSVFX.js";import{f as p}from"./chunk-SEDBTTTN.js";var i=p(v()),C=p(v());var n=class n{constructor(t){this.cmsToastrService=t;this.id=++n.nextId;this.map$=new s;this.zoom$=new s;this.options={layers:[(0,C.tileLayer)(h.leafletUrl,{opacity:.7,maxZoom:19,detectRetina:!0})],zoom:16,center:[32.684985,51.6359425]};this.destroy=!1}set optonCenter(t){this.map&&t&&t.lat&&t.lon&&t.lat!==0&&t.lon!==0&&this.map.setView(new i.LatLng(t.lat,t.lon),this.zoom)}set optionCurrentPoint(t){this.onActionCurrentPoint(t)}ngOnInit(){let a=i.icon({iconRetinaUrl:"assets/leaflet/marker-icon-2x.png",iconUrl:"assets/leaflet/marker-icon.png",shadowUrl:"assets/leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});i.Marker.prototype.options.icon=a}ngOnDestroy(){this.map&&(this.map.clearAllEventListeners(),this.destroy=!0)}onMapReady(t){setTimeout(()=>{this.map&&!this.destroy&&t.invalidateSize()},500),this.map=t,this.map$.emit(t),this.zoom=t.getZoom(),this.zoom$.emit(this.zoom)}onMapZoomEnd(t){this.zoom=t.target.getZoom(),this.zoom$.emit(this.zoom)}onActionCurrentPoint(t=!0){this.getPosition().then(e=>{this.map.setView(new i.LatLng(e.lat,e.lon),this.zoom)})}getPosition(){return new Promise((t,e)=>{navigator.geolocation.getCurrentPosition(o=>{t({lon:o.coords.longitude,lat:o.coords.latitude})},o=>{this.cmsToastrService.typeErrorGetPosition()})})}};n.nextId=0,n.\u0275fac=function(e){return new(e||n)(m(y))},n.\u0275cmp=l({type:n,selectors:[["app-cms-map"]],inputs:{options:"options",optonCenter:"optonCenter",optionCurrentPoint:"optionCurrentPoint"},outputs:{map$:"map$",zoom$:"zoom$"},standalone:!1,decls:1,vars:1,consts:[["leaflet","",1,"map-container",3,"leafletMapReady","leafletMapZoomEnd","leafletOptions"]],template:function(e,o){e&1&&(d(0,"div",0),u("leafletMapReady",function(r){return o.onMapReady(r)})("leafletMapZoomEnd",function(r){return o.onMapZoomEnd(r)}),f()),e&2&&c("leafletOptions",o.options)},dependencies:[M],styles:[".map-container[_ngcontent-%COMP%]{width:100%;height:300px}"]});var g=n;export{g as a};
