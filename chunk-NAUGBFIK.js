import{a as pe}from"./chunk-QJ4SB3EG.js";import{B as X,Dc as ce,K as Y,Wa as ne,Xa as re,Ya as le,fc as ae,gc as se,ma as Z,o as J,r as K,v as Q,vc as de}from"./chunk-MZT2GAV3.js";import{$d as ie,Bd as C,E as D,Fa as n,H as N,Hb as B,Ic as U,Jc as $,Ka as s,Mb as M,Nb as I,O as L,Ob as G,Od as ee,P,Pa as V,Pc as z,Sd as S,Td as te,Va as f,Vb as x,Wb as _,Xa as k,bc as T,ca as v,cb as q,cc as A,da as g,ee as oe,ib as r,jb as d,jf as m,kb as c,lb as u,p as F,q as w,sb as b,uc as W,vb as E,wd as y,xb as h,yb as j,zb as H}from"./chunk-Y22UWZ2R.js";import{i as O}from"./chunk-SEDBTTTN.js";var me=["*"];function fe(o,e){if(o&1&&(d(0,"label",11),M(1),c()),o&2){let i=h();r("for",_("app-cms-site-selector-",i.id)),n(),I(i.optionLabel)}}function he(o,e){if(o&1&&(d(0,"mat-option",12)(1,"span"),M(2),c()()),o&2){let i=e.$implicit,t=h();r("value",i)("disabled",t.optionDisabled),n(2),I(t.displayOption(i))}}function Me(o,e){o&1&&u(0,"i",13)}function ye(o,e){o&1&&u(0,"i",14)}function Ce(o,e){if(o&1){let i=b();d(0,"i",15),E("click",function(){v(i);let l=h();return g(l.onActionSelectClear())}),c()}}function Se(o,e){o&1&&(d(0,"em"),M(1),T(2,"translate"),c()),o&2&&(n(),G("(",A(2,1,"TITLE.Necessary"),")"))}var a=class a{constructor(e,i,t,l,p,R){this.coreEnumService=e;this.cmsToastrService=i;this.cdr=t;this.publicHelper=l;this.translate=p;this.categoryService=R;this.id=++a.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new ee;this.dataModelSelect=new m;this.formControl=new Q;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionDisabled=!1;this.optionRequired=!1;this.optionLabel="";this.optionChange=new k;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(L(""),D(1500),N(),P(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e||""):[]))}displayFn(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}displayOption(e){return e?e.moduleNameML+"("+e.moduleName+") # "+e.moduleEntityNameML+"("+e.moduleEntityNameML+")":void 0}DataGetAll(e){return O(this,null,function*(){let i=new te;i.rowPerPage=50,i.accessLoad=!0;let t=new S;t.propertyName="moduleName",t.value=e,t.searchType=C.Contains,t.clauseType=y.Or,i.filters.push(t),t=new S,t.propertyName="moduleEntityName",t.value=e,t.searchType=C.Contains,t.clauseType=y.Or,i.filters.push(t),e&&typeof+e=="number"&&+e>0&&(t=new S,t.propertyName="Id",t.value=e,t.searchType=C.Equal,t.clauseType=y.Or,i.filters.push(t));let l=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(p=>{this.publicHelper.processService.processStart(l,p,this.constructorInfoAreaId)}),yield F(this.categoryService.ServiceGetAll(i)).then(p=>(this.dataModelResult=p,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(l),p.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}onActionEmpty(){this.formControl.setValue(0),this.dataModelSelect=new m,this.optionChange.emit(this.dataModelSelect)}push(e){return this.filteredOptions.pipe(w(i=>(i.find(t=>t.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){let i=this.dataModelResult.listItems.find(t=>t.id===e);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(e).subscribe({next:i=>{i.isSuccess?(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item)):this.cmsToastrService.typeErrorMessage(i.errorMessage)}});return}if(typeof e==typeof m){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new m,this.loadOptions()}};a.nextId=0,a.\u0275fac=function(i){return new(i||a)(s(ie),s(de),s(W),s(ce),s(ae),s(oe))},a.\u0275cmp=V({type:a,selectors:[["app-core-module-entity-selector"]],inputs:{optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:me,decls:13,vars:18,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info  invalid color-red-dark",4,"ngIf"],["class","fa fa-check  valid color-green-dark",4,"ngIf"],["class","fa fa-times  action color-red-dark",3,"click",4,"ngIf"],[4,"ngIf"],[1,"color-highlight",3,"for"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,t){if(i&1){let l=b();j(),d(0,"div",1),u(1,"app-progress-spinner",2),f(2,fe,2,3,"label",3),u(3,"input",4),d(4,"mat-autocomplete",5,0),E("optionSelected",function(R){return v(l),g(t.onActionSelect(R.option.value))}),f(6,he,3,3,"mat-option",6),T(7,"async"),c(),f(8,Me,1,0,"i",7)(9,ye,1,0,"i",8)(10,Ce,1,0,"i",9)(11,Se,3,3,"em",10),H(12),c()}if(i&2){let l=B(5);n(),r("optionsInfoAreaId",t.constructorInfoAreaId),n(),r("ngIf",(t.optionLabel==null?null:t.optionLabel.length)>0),n(),r("placeholder",x(t.optionPlaceholder))("id",_("app-cms-site-selector-",t.id))("formControl",t.formControl)("matAutocomplete",l)("required",t.optionRequired),q("disabled",t.optionDisabled?!0:null),n(),r("displayWith",t.displayFn),n(2),r("ngForOf",A(7,16,t.filteredOptions)),n(2),r("ngIf",!t.formControl.valid),n(),r("ngIf",t.optionRequired&&t.formControl.valid),n(),r("ngIf",(t.dataModelSelect==null?null:t.dataModelSelect.id)>0),n(),r("ngIf",t.optionRequired&&(!t.dataModelSelect||!t.dataModelSelect.id||t.dataModelSelect.id<=0))}},dependencies:[U,$,J,K,Y,X,re,ne,le,Z,pe,z,se],encapsulation:2});var ue=a;export{ue as a};
