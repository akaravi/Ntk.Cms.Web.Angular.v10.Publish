import{a as me}from"./chunk-ZKUYTZZF.js";import{a as de}from"./chunk-MA5PBYEU.js";import{f as ce}from"./chunk-SAE3A2A6.js";import{I as oe,Qb as se,Rb as pe,U as re,ab as le,da as ne,ea as ae,m as Z,p as ee,t as te,z as ie}from"./chunk-ITIAGMDL.js";import{Ca as T,Ed as K,F as N,Fa as a,Hb as j,I as k,Ic as x,Id as s,Jb as G,Jc as $,Jd as Q,Ka as h,Mb as v,Nb as U,Ob as z,P as D,Pa as V,Pc as J,Q as P,Sd as X,Va as u,Vb as y,Wb as A,Xa as L,bc as S,cb as q,cc as g,da as I,de as _,ea as M,ee as Y,ib as n,jb as l,kb as p,lb as f,md as c,p as E,q as F,rd as d,sb as O,uc as W,vb as b,xb as C,yb as B,zb as H}from"./chunk-TLQAT62P.js";import{i as w}from"./chunk-SEDBTTTN.js";var he=["*"];function Ce(r,e){if(r&1&&(l(0,"label",13),v(1),p()),r&2){let t=C();n("for",A("app-cms-site-selector-",t.id)),a(),U(t.optionLabel)}}function Se(r,e){if(r&1&&(f(0,"img",14),S(1,"cmsthumbnail")),r&2){let t=C();n("src",y(g(1,2,t.dataModelSelect==null?null:t.dataModelSelect.linkMainImageIdSrc)),T)}}function ge(r,e){if(r&1&&(f(0,"img",14),S(1,"cmsthumbnail")),r&2){let t=C().$implicit;n("src",y(g(1,2,t.linkMainImageIdSrc)),T)}}function ve(r,e){if(r&1&&(l(0,"mat-option",15),u(1,ge,2,4,"img",4),l(2,"span"),v(3),p()()),r&2){let t=e.$implicit,o=C();n("value",t)("disabled",o.optionDisabled),a(),n("ngIf",t.linkMainImageIdSrc),a(2),U(o.displayOption(t))}}function ye(r,e){r&1&&f(0,"i",16)}function Ie(r,e){r&1&&f(0,"i",17)}function Me(r,e){if(r&1){let t=O();l(0,"i",18),b("click",function(){I(t);let i=C();return M(i.onActionSelectClear())}),p()}}function be(r,e){r&1&&(l(0,"em"),v(1),S(2,"translate"),p()),r&2&&(a(),z("(",g(2,1,"TITLE.Necessary"),")"))}var m=class m{constructor(e,t,o,i,R){this.coreEnumService=e;this.cdr=t;this.publicHelper=o;this.translate=i;this.categoryService=R;this.id=++m.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new K;this.dataModelSelect=new _;this.formControl=new te;this.optionDisabled=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionRequired=!1;this.optionChange=new L;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(e){this.onActionSelectForce(e)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(D(""),N(1500),k(),P(e=>typeof e=="string"||typeof e=="number"?this.DataGetAll(e):this.DataGetAll("")))}displayFn(e){let t="";return e&&(e.username&&e.username.length>0&&(t=t+" "+e.username),e.name&&e.name.length>0&&(t=t+" "+e.name),e.lastName&&e.lastName.length>0&&(t=t+" "+e.lastName),t=t+"#:"+e.id),t}displayOption(e){let t="";return e&&(e.username&&e.username.length>0&&(t=t+" "+e.username),e.name&&e.name.length>0&&(t=t+" "+e.name),e.lastName&&e.lastName.length>0&&(t=t+" "+e.lastName),t=t+"#:"+e.id),t}DataGetAll(e){return w(this,null,function*(){let t=new Q;if(t.rowPerPage=20,t.accessLoad=!0,e&&e.length>0){let i=new s;i=new s,i.propertyName="username",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="name",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="email",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="lastname",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="Id",i.value=e,i.searchType=d.Equal,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="mobile",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="tell",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i),i=new s,i.propertyName="companyName",i.value=e,i.searchType=d.Contains,i.clauseType=c.Or,t.filters.push(i)}let o=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(i=>{this.publicHelper.processService.processStart(o,i,this.constructorInfoAreaId)}),yield E(this.categoryService.ServiceGetAll(t)).then(i=>(this.dataModelResult=i,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(o),i.listItems))})}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe(F(t=>(t.find(o=>o.id===e.id)||t.push(e),t)))}onActionSelectForce(e){if(typeof e=="number"&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(t=>t.id===e)){let t=this.dataModelResult.listItems.find(o=>o.id===e);this.dataModelSelect=t,this.formControl.setValue(t);return}this.categoryService.ServiceGetOneById(e).subscribe({next:t=>{t.isSuccess&&(this.filteredOptions=this.push(t.item),this.dataModelSelect=t.item,this.formControl.setValue(t.item),this.optionChange.emit(t.item))}});return}if(typeof e==typeof _){this.filteredOptions=this.push(e),this.dataModelSelect=e,this.formControl.setValue(e);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new _,this.loadOptions()}};m.nextId=0,m.\u0275fac=function(t){return new(t||m)(h(X),h(W),h(ce),h(se),h(Y))},m.\u0275cmp=V({type:m,selectors:[["app-cms-user-selector"]],inputs:{optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionRequired:"optionRequired",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:he,decls:18,vars:25,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],["class","color-highlight",3,"for",4,"ngIf"],["style","vertical-align: middle","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled",4,"ngFor","ngForOf"],["class","fa fa-info invalid color-red-dark",4,"ngIf"],["class","fa fa-check valid color-green-dark",4,"ngIf"],["class","fa fa-times action color-red-dark",3,"click",4,"ngIf"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[4,"ngIf"],[1,"color-highlight",3,"for"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(t,o){if(t&1){let i=O();B(),l(0,"div",1),f(1,"app-progress-spinner",2),u(2,Ce,2,3,"label",3),l(3,"span"),u(4,Se,2,4,"img",4),v(5," \xA0"),p(),f(6,"input",5),l(7,"mat-autocomplete",6,0),b("optionSelected",function(fe){return I(i),M(o.onActionSelect(fe.option.value))}),u(9,ve,4,4,"mat-option",7),S(10,"async"),p(),u(11,ye,1,0,"i",8)(12,Ie,1,0,"i",9)(13,Me,1,0,"i",10),l(14,"i",11),S(15,"translate"),b("click",function(){return I(i),M(o.onActionButtonReload())}),p(),u(16,be,3,3,"em",12),H(17),p()}if(t&2){let i=j(8);a(),n("optionsInfoAreaId",o.constructor.name),a(),n("ngIf",(o.optionLabel==null?null:o.optionLabel.length)>0),a(2),n("ngIf",o.dataModelSelect&&(o.dataModelSelect==null?null:o.dataModelSelect.linkMainImageIdSrc)),a(2),n("placeholder",y(o.optionPlaceholder))("id",A("app-cms-site-selector-",o.id))("formControl",o.formControl)("matAutocomplete",i)("required",o.optionRequired),q("disabled",o.optionDisabled?!0:null),a(),n("displayWith",o.displayFn),a(2),n("ngForOf",g(10,21,o.filteredOptions)),a(2),n("ngIf",!o.formControl.valid),a(),n("ngIf",o.optionRequired&&o.formControl.valid),a(),n("ngIf",(o.dataModelSelect==null?null:o.dataModelSelect.id)>0),a(),G("rotation360",o.publicHelper.processService.process.inRunArea[o.constructorInfoAreaId]),n("title",y(g(15,23,"ACTION.RELOAD"))),a(2),n("ngIf",o.optionRequired&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0))}},dependencies:[x,$,Z,ee,oe,ie,ne,re,ae,le,de,J,pe,me],encapsulation:2});var ue=m;export{ue as a};
