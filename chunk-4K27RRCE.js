import{a as Se}from"./chunk-CE7RX42R.js";import{a as Ce}from"./chunk-HDZWEA4D.js";import{f as he}from"./chunk-2DNDKBAW.js";import{Ab as me,Bb as ue,Da as pe,m as ae,u as se,uc as fe,x as de,y as ce}from"./chunk-XVK3P2WQ.js";import{A as re,c as ie,h as oe,l as ne,r as le}from"./chunk-QRBNL5ZA.js";import{$ as ee,D as w,da as te,q as Y,qb as v,u as E,v as Z,y as O}from"./chunk-VXWYWSUO.js";import{Ab as c,Cb as N,Db as G,Dc as C,Eb as z,Ec as S,Fb as a,Gb as r,Hb as s,Ib as f,K as V,O as L,Pb as T,Ra as y,Sb as I,Ub as h,Va as n,Vb as U,Wb as W,Xa as x,Xc as Q,Z as q,_ as B,cb as u,cc as $,ec as J,hc as _,ib as j,ic as A,jc as K,pa as b,qa as g,s as P,t as k,tc as M,td as X,uc as R,xb as H,zb as d}from"./chunk-2AL2II5Z.js";import{i as F}from"./chunk-SEDBTTTN.js";var ve=["*"];function be(o,t){if(o&1&&(r(0,"label",3),_(1),s()),o&2){let i=h();a("for",R("app-cms-site-selector-",i.id)),n(),A(i.optionLabel)}}function ge(o,t){if(o&1&&(f(0,"img",5),C(1,"cmsthumbnail")),o&2){let i=h();a("src",M(S(1,2,i.dataModelSelect==null?null:i.dataModelSelect.linkMainImageIdSrc)),y)}}function Ie(o,t){if(o&1&&(f(0,"img",5),C(1,"cmsthumbnail")),o&2){let i=h().$implicit;a("src",M(S(1,2,i.linkMainImageIdSrc)),y)}}function _e(o,t){if(o&1&&(r(0,"mat-option",8),d(1,Ie,2,4,"img",5),r(2,"span"),_(3),s()()),o&2){let i=t.$implicit,e=h();a("value",i)("disabled",e.optionDisabled),n(),c(i.linkMainImageIdSrc?1:-1),n(2),A(e.displayOption(i))}}function ye(o,t){o&1&&f(0,"i",9)}function Te(o,t){o&1&&f(0,"i",10)}function Ae(o,t){if(o&1){let i=T();r(0,"i",13),I("click",function(){b(i);let l=h();return g(l.onActionSelectClear())}),s()}}function Re(o,t){o&1&&(r(0,"em"),_(1),C(2,"translate"),s()),o&2&&(n(),K("(",S(2,1,"TITLE.Necessary"),")"))}var p=class p{constructor(t,i,e,l,m,D){this.coreEnumService=t;this.cmsToastrService=i;this.cdr=e;this.publicHelper=l;this.translate=m;this.categoryService=D;this.id=++p.nextId;this.constructorInfoAreaId=this.constructor.name;this.dataModelResult=new Y;this.dataModelSelect=new v;this.formControl=new ne;this.optionDisabled=!1;this.optionRequired=!1;this.optionSelectFirstItem=!1;this.optionPlaceholder="";this.optionLabel="";this.optionChange=new x;this.optionReload=()=>this.onActionButtonReload();this.publicHelper.processService.cdr=this.cdr}set optionSelectForce(t){this.onActionSelectForce(t)}ngOnInit(){this.loadOptions(),(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe(q(""),V(1500),L(),B(t=>typeof t=="string"||typeof t=="number"?this.DataGetAll(t||""):[]))}displayFn(t){return t?t.title:void 0}displayOption(t){return t?t.title:void 0}DataGetAll(t){return F(this,null,function*(){let i=new Z;i.rowPerPage=20,i.accessLoad=!0;let e=new E;e.propertyName="title",e.value=t,e.searchType=w.Contains,e.clauseType=O.Or,i.filters.push(e),t&&typeof+t=="number"&&+t>0&&(e=new E,e.propertyName="id",e.value=t,e.searchType=w.Equal,e.clauseType=O.Or,i.filters.push(e));let l=this.constructor.name+"main";return this.translate.get("MESSAGE.Receiving_information").subscribe(m=>{this.publicHelper.processService.processStart(l,m,this.constructorInfoAreaId)}),yield P(this.categoryService.ServiceGetAll(i)).then(m=>(this.dataModelResult=m,this.optionSelectFirstItem&&(!this.dataModelSelect||!this.dataModelSelect.id||this.dataModelSelect.id<=0)&&this.dataModelResult.listItems.length>0&&(this.optionSelectFirstItem=!1,setTimeout(()=>{this.formControl.setValue(this.dataModelResult.listItems[0])},1e3),this.onActionSelect(this.dataModelResult.listItems[0])),this.publicHelper.processService.processStop(l),m.listItems))})}onActionSelect(t){this.optionDisabled||(this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}onActionEmpty(){this.formControl.setValue(0),this.dataModelSelect=new v,this.optionChange.emit(this.dataModelSelect)}push(t){return this.filteredOptions.pipe(k(i=>(i.find(e=>e.id===t.id)||i.push(t),i)))}onActionSelectForce(t){if(typeof t=="number"&&t>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===t)){let i=this.dataModelResult.listItems.find(e=>e.id===t);this.dataModelSelect=i,this.formControl.setValue(i);return}this.categoryService.ServiceGetOneById(t).subscribe({next:i=>{i.isSuccess?(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item)):this.cmsToastrService.typeErrorMessage(i.errorMessage)}});return}if(typeof t==typeof v){this.filteredOptions=this.push(t),this.dataModelSelect=t,this.formControl.setValue(t);return}this.formControl.setValue(null)}onActionButtonReload(){this.dataModelSelect=new v,this.loadOptions()}};p.nextId=0,p.\u0275fac=function(i){return new(i||p)(u(ee),u(fe),u(Q),u(he),u(me),u(te))},p.\u0275cmp=j({type:p,selectors:[["app-core-module-selector"]],inputs:{optionDisabled:"optionDisabled",optionRequired:"optionRequired",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,ngContentSelectors:ve,decls:18,vars:24,consts:[["matauto","matAutocomplete"],[1,"input-style","has-borders","has-icon","input-style-always-active","validate-field","mb-4","loader-container"],[3,"optionsInfoAreaId"],[1,"color-highlight",3,"for"],["matPrefix",""],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete","required","id"],[3,"optionSelected","displayWith"],[3,"value","disabled"],[1,"fa","fa-info","invalid","color-red-dark"],[1,"fa","fa-check","valid","color-green-dark"],[1,"fa","fa-times","action","color-red-dark"],[1,"fa","fa-rotate-right","action","color-green-dark",2,"margin-left","20px",3,"click","title"],[1,"fa","fa-times","action","color-red-dark",3,"click"]],template:function(i,e){if(i&1){let l=T();U(),r(0,"div",1),f(1,"app-progress-spinner",2),d(2,be,2,3,"label",3),r(3,"span",4),d(4,ge,2,4,"img",5),s(),f(5,"input",6),r(6,"mat-autocomplete",7,0),I("optionSelected",function(D){return b(l),g(e.onActionSelect(D.option.value))}),G(8,_e,4,4,"mat-option",8,N),C(10,"async"),s(),d(11,ye,1,0,"i",9),d(12,Te,1,0,"i",10),d(13,Ae,1,0,"i",11),r(14,"i",12),C(15,"translate"),I("click",function(){return b(l),g(e.onActionButtonReload())}),s(),d(16,Re,3,3,"em"),W(17),s()}if(i&2){let l=$(7);n(),a("optionsInfoAreaId",e.constructorInfoAreaId),n(),c((e.optionLabel==null?null:e.optionLabel.length)>0?2:-1),n(2),c(e.dataModelSelect&&(e.dataModelSelect!=null&&e.dataModelSelect.linkMainImageIdSrc)?4:-1),n(),a("placeholder",M(e.optionPlaceholder))("id",R("app-cms-site-selector-",e.id))("formControl",e.formControl)("matAutocomplete",l)("required",e.optionRequired),H("disabled",e.optionDisabled?!0:null),n(),a("displayWith",e.displayFn),n(2),z(S(10,20,e.filteredOptions)),n(3),c(e.formControl.valid?-1:11),n(),c(e.optionRequired&&e.formControl.valid?12:-1),n(),c((e.dataModelSelect==null?null:e.dataModelSelect.id)>0?13:-1),n(),J("rotation360",e.publicHelper.processService.process.inRunArea[e.constructorInfoAreaId]),a("title",M(S(15,22,"ACTION.RELOAD"))),n(2),c(e.optionRequired&&!((e.dataModelSelect==null?null:e.dataModelSelect.id)>0)?16:-1)}},dependencies:[ie,oe,re,le,de,ae,ce,se,pe,Ce,X,ue,Se],encapsulation:2});var Me=p;export{Me as a};
