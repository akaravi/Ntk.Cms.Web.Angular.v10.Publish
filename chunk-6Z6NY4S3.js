import{Ba as te,U as X,V as Y,X as Z,Y as ee,m as H,r as W,uc as ie,w as z,x as J,y as U}from"./chunk-XVK3P2WQ.js";import{c as Q,h as $,l as j,r as q}from"./chunk-QRBNL5ZA.js";import{D as E,u as f,v as _,y as v,zc as K}from"./chunk-VXWYWSUO.js";import{Cb as M,Db as I,Dc as N,Eb as y,Ec as R,Fb as d,Gb as n,Hb as p,K as w,Pb as b,Sb as h,Ub as V,Va as r,Xa as O,Yb as k,Z as D,Zb as P,_ as F,_b as x,cb as g,cc as T,hc as c,ib as L,ic as B,jc as S,pa as m,qa as u,t as A,td as G}from"./chunk-2AL2II5Z.js";var ae=["tagInput"];function re(s,i){if(s&1){let t=b();n(0,"mat-chip",8),h("removed",function(){let o=m(t).$implicit,a=V();return u(a.remove(o))}),c(1),n(2,"button",9)(3,"mat-icon"),c(4,"cancel"),p()()()}if(s&2){let t=i.$implicit;r(),S(" ",t.display," ")}}function ne(s,i){if(s&1&&(n(0,"mat-option",7),c(1),p()),s&2){let t=i.$implicit;d("value",t),r(),S(" ",t.display," ")}}var l=class l{constructor(i,t){this.service=i;this.cmsToastrService=t;this.id=++l.nextId;this.optionDisabled=!1;this.optionPlaceholder="+ Tag";this.optionLabel="";this.optionChange=new O;this.tagDataModel=[];this.tagLastDataModel=[];this.selectForceStatus=!0;this.separatorKeysCodes=[13];this.tagCtrl=new j("");this.addOnBlur=!0;this.filteredOptions=this.tagCtrl.valueChanges.pipe(D(null),w(400),F(e=>this.filter(e||"")))}set optionSelectForce(i){this.onActionSelectForce(i)}ngOnInit(){(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}filter(i){let t=new _;t.rowPerPage=20,t.accessLoad=!0;let e=new f;return e.propertyName="title",e.value=i,e.searchType=E.Contains,e.clauseType=v.Or,t.filters.push(e),i&&typeof+i=="number"&&+i>0&&(e=new f,e.propertyName="id",e.value=i,e.searchType=E.Equal,e.clauseType=v.Or,t.filters.push(e)),this.service.ServiceGetAll(t).pipe(A(o=>(this.tagLastDataModel=o.listItems.map(a=>({display:a.title,value:a.id})),this.tagLastDataModel)))}checkIndex(i){let t=0,e=-1;return this.tagDataModel.forEach(o=>{o.value==i&&(e=t),t++}),e}add(i){let t;i.value&&this.tagLastDataModel.forEach(e=>{(e.display==i.value||e.value+""==i.value)&&(t=e)}),t&&this.checkIndex(t.value)<0&&(this.tagDataModel.push(t),this.onActionChange()),i.chipInput.clear(),this.tagCtrl.setValue(null)}remove(i){let t=this.checkIndex(i.value);t>=0&&(this.tagDataModel.splice(t,1),this.onActionChange())}selected(i){let t=i.option.value;this.checkIndex(t.value)<0&&this.tagDataModel.push(t),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){let i=[];this.tagDataModel.forEach(t=>{i.findIndex(e=>e==t.value)<0&&i.push(t.value)}),this.selectForceStatus=!1,this.optionChange.emit(i)}onActionSelectForce(i){if(!this.selectForceStatus||!i||i.length===0)return;let t=new _;i.forEach(e=>{if(e>0){let o=new f;o.propertyName="id",o.value=e,o.clauseType=v.Or,t.filters.push(o)}}),this.service.ServiceGetAll(t).subscribe({next:e=>{e.isSuccess?e.listItems.forEach(o=>{this.tagDataModel.findIndex(a=>a.value==o.id)<0&&this.tagDataModel.push({value:o.id,display:o.title})}):this.cmsToastrService.typeErrorGetAll(e.errorMessage)},error:e=>{this.cmsToastrService.typeErrorGetAll(e)}})}};l.nextId=0,l.\u0275fac=function(t){return new(t||l)(g(K),g(ie))},l.\u0275cmp=L({type:l,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(t,e){if(t&1&&k(ae,5),t&2){let o;P(o=x())&&(e.tagInput=o.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,decls:14,vars:10,consts:[["chipList",""],["tagInput",""],["auto","matAutocomplete"],["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],[3,"matChipInputTokenEnd","placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"optionSelected"],[3,"value"],[3,"removed"],["type","button","matChipRemove","",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray"]],template:function(t,e){if(t&1){let o=b();n(0,"mat-form-field",3)(1,"mat-label"),c(2),p(),n(3,"mat-chip-grid",4,0),I(5,re,5,1,"mat-chip",null,M),n(7,"input",5,1),h("matChipInputTokenEnd",function(C){return m(o),u(e.add(C))}),p()(),n(9,"mat-autocomplete",6,2),h("optionSelected",function(C){return m(o),u(e.selected(C))}),I(11,ne,2,2,"mat-option",7,M),N(13,"async"),p()()}if(t&2){let o=T(4),a=T(10);r(2),B(e.optionLabel),r(),d("disabled",e.optionDisabled),r(2),y(e.tagDataModel),r(2),d("placeholder"," + "+e.optionPlaceholder)("matChipInputAddOnBlur",e.addOnBlur)("formControl",e.tagCtrl)("matAutocomplete",a)("matChipInputFor",o)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes),r(4),y(R(13,8,e.filteredOptions))}},dependencies:[Q,$,q,J,H,U,Y,Z,ee,X,z,W,te,G],encapsulation:2});var oe=l;export{oe as a};
