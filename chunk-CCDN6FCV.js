import{B as $,Pa as U,Q as j,V as q,Wa as Y,X as H,Xa as Z,Y as W,Ya as ee,Z as z,_ as J,o as G,r as K,v as Q,vc as te}from"./chunk-HFFK4MNG.js";import{Bb as L,Bd as T,Cb as V,Db as P,E,Fa as n,Hb as b,Ic as R,Ka as C,Mb as m,Nb as x,O as A,Ob as y,P as F,Pa as w,Pc as B,Sd as g,Td as S,Va as M,Xa as D,bc as k,ca as u,cc as N,da as d,ib as p,jb as r,kb as s,mg as X,q as _,sb as I,vb as h,wd as f,xb as O}from"./chunk-MDNBQXON.js";var oe=["tagInput"];function ae(c,i){if(c&1){let t=I();r(0,"mat-chip",9),h("removed",function(){let o=u(t).$implicit,a=O();return d(a.remove(o))}),m(1),r(2,"button",10)(3,"mat-icon"),m(4,"cancel"),s()()()}if(c&2){let t=i.$implicit;n(),y(" ",t.display," ")}}function ne(c,i){if(c&1&&(r(0,"mat-option",11),m(1),s()),c&2){let t=i.$implicit;p("value",t),n(),y(" ",t.display," ")}}var l=class l{constructor(i,t){this.service=i;this.cmsToastrService=t;this.id=++l.nextId;this.optionDisabled=!1;this.optionPlaceholder="+ Tag";this.optionLabel="";this.optionChange=new D;this.tagDataModel=[];this.tagLastDataModel=[];this.selectForceStatus=!0;this.separatorKeysCodes=[13];this.tagCtrl=new Q("");this.addOnBlur=!0;this.filteredOptions=this.tagCtrl.valueChanges.pipe(A(null),E(400),F(e=>this.filter(e||"")))}set optionSelectForce(i){this.onActionSelectForce(i)}ngOnInit(){(!this.optionLabel||this.optionLabel.length==0&&this.optionPlaceholder?.length>0)&&(this.optionLabel=this.optionPlaceholder)}filter(i){let t=new S;t.rowPerPage=20,t.accessLoad=!0;let e=new g;return e.propertyName="Title",e.value=i,e.searchType=T.Contains,e.clauseType=f.Or,t.filters.push(e),i&&typeof+i=="number"&&+i>0&&(e=new g,e.propertyName="Id",e.value=i,e.searchType=T.Equal,e.clauseType=f.Or,t.filters.push(e)),this.service.ServiceGetAll(t).pipe(_(o=>(this.tagLastDataModel=o.listItems.map(a=>({display:a.title,value:a.id})),this.tagLastDataModel)))}checkIndex(i){let t=0,e=-1;return this.tagDataModel.forEach(o=>{o.value==i&&(e=t),t++}),e}add(i){let t;i.value&&this.tagLastDataModel.forEach(e=>{(e.display==i.value||e.value+""==i.value)&&(t=e)}),t&&this.checkIndex(t.value)<0&&(this.tagDataModel.push(t),this.onActionChange()),i.chipInput.clear(),this.tagCtrl.setValue(null)}remove(i){let t=this.checkIndex(i.value);t>=0&&(this.tagDataModel.splice(t,1),this.onActionChange())}selected(i){let t=i.option.value;this.checkIndex(t.value)<0&&this.tagDataModel.push(t),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){let i=[];this.tagDataModel.forEach(t=>{i.findIndex(e=>e==t.value)<0&&i.push(t.value)}),this.selectForceStatus=!1,this.optionChange.emit(i)}onActionSelectForce(i){if(!this.selectForceStatus||!i||i.length===0)return;let t=new S;i.forEach(e=>{if(e>0){let o=new g;o.propertyName="Id",o.value=e,o.clauseType=f.Or,t.filters.push(o)}}),this.service.ServiceGetAll(t).subscribe({next:e=>{e.isSuccess?e.listItems.forEach(o=>{this.tagDataModel.findIndex(a=>a.value==o.id)<0&&this.tagDataModel.push({value:o.id,display:o.title})}):this.cmsToastrService.typeErrorGetAll(e.errorMessage)},error:e=>{this.cmsToastrService.typeErrorGetAll(e)}})}};l.nextId=0,l.\u0275fac=function(t){return new(t||l)(C(X),C(te))},l.\u0275cmp=w({type:l,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(t,e){if(t&1&&L(oe,5),t&2){let o;V(o=P())&&(e.tagInput=o.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},standalone:!1,decls:12,vars:12,consts:[["chipList",""],["tagInput",""],["auto","matAutocomplete"],["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],[3,"removed",4,"ngFor","ngForOf"],[3,"matChipInputTokenEnd","placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["type","button","matChipRemove","",1,"btn","font-13","font-600","btn-s","m-1","rounded-s","shadow-xl","border-0","gradient-gray"],[3,"value"]],template:function(t,e){if(t&1){let o=I();r(0,"mat-form-field",3)(1,"mat-label"),m(2),s(),r(3,"mat-chip-grid",4,0),M(5,ae,5,1,"mat-chip",5),r(6,"input",6,1),h("matChipInputTokenEnd",function(v){return u(o),d(e.add(v))}),s()(),r(8,"mat-autocomplete",7,2),h("optionSelected",function(v){return u(o),d(e.selected(v))}),M(10,ne,2,2,"mat-option",8),k(11,"async"),s()()}if(t&2){let o=b(4),a=b(9);n(2),x(e.optionLabel),n(),p("disabled",e.optionDisabled),n(2),p("ngForOf",e.tagDataModel),n(),p("placeholder"," + "+e.optionPlaceholder)("matChipInputAddOnBlur",e.addOnBlur)("formControl",e.tagCtrl)("matAutocomplete",a)("matChipInputFor",o)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes),n(4),p("ngForOf",N(11,10,e.filteredOptions))}},dependencies:[R,G,K,$,Z,Y,ee,W,z,J,H,q,j,U,B],encapsulation:2});var ie=l;export{ie as a};
